function ascending(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function bisector(e){return 1===e.length&&(e=ascendingComparator(e)),{left:function(t,r,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var o=n+i>>>1;e(t[o],r)<0?n=o+1:i=o}return n},right:function(t,r,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var o=n+i>>>1;e(t[o],r)>0?i=o:n=o+1}return n}}}function ascendingComparator(e){return function(t,r){return ascending(e(t),r)}}var ascendingBisect=bisector(ascending),noop={value:function(){}};function dispatch(){for(var e,t=0,r=arguments.length,n={};t<r;++t){if(!(e=arguments[t]+"")||e in n)throw new Error("illegal type: "+e);n[e]=[]}return new Dispatch(n)}function Dispatch(e){this._=e}function parseTypenames(e,t){return e.trim().split(/^|\s+/).map(function(e){var r="",n=e.indexOf(".");if(n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}})}function get(e,t){for(var r,n=0,i=e.length;n<i;++n)if((r=e[n]).name===t)return r.value}function set(e,t,r){for(var n=0,i=e.length;n<i;++n)if(e[n].name===t){e[n]=noop,e=e.slice(0,n).concat(e.slice(n+1));break}return null!=r&&e.push({name:t,value:r}),e}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(e,t){var r,n=this._,i=parseTypenames(e+"",n),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<a;)if(r=(e=i[o]).type)n[r]=set(n[r],e.name,t);else if(null==t)for(r in n)n[r]=set(n[r],e.name,null);return this}for(;++o<a;)if((r=(e=i[o]).type)&&(r=get(n[r],e.name)))return r},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new Dispatch(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var r,n,i=new Array(r),o=0;o<r;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,r=(n=this._[e]).length;o<r;++o)n[o].value.apply(t,i)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],i=0,o=n.length;i<o;++i)n[i].value.apply(t,r)}};var xhtml="http://www.w3.org/1999/xhtml",namespaces={svg:"http://www.w3.org/2000/svg",xhtml:xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(e){var t=e+="",r=t.indexOf(":");return r>=0&&"xmlns"!==(t=e.slice(0,r))&&(e=e.slice(r+1)),namespaces.hasOwnProperty(t)?{space:namespaces[t],local:e}:e}function creatorInherit(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===xhtml&&t.documentElement.namespaceURI===xhtml?t.createElement(e):t.createElementNS(r,e)}}function creatorFixed(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function creator(e){var t=namespace(e);return(t.local?creatorFixed:creatorInherit)(t)}var matcher=function(e){return function(){return this.matches(e)}};if("undefined"!=typeof document){var element=document.documentElement;if(!element.matches){var vendorMatches=element.webkitMatchesSelector||element.msMatchesSelector||element.mozMatchesSelector||element.oMatchesSelector;matcher=function(e){return function(){return vendorMatches.call(this,e)}}}}var matcher$1=matcher,filterEvents={};if("undefined"!=typeof document){var element$1=document.documentElement;"onmouseenter"in element$1||(filterEvents={mouseenter:"mouseover",mouseleave:"mouseout"})}function filterContextListener(e,t,r){return e=contextListener(e,t,r),function(t){var r=t.relatedTarget;r&&(r===this||8&r.compareDocumentPosition(this))||e.call(this,t)}}function contextListener(e,t,r){return function(n){try{e.call(this,this.__data__,t,r)}finally{}}}function parseTypenames$1(e){return e.trim().split(/^|\s+/).map(function(e){var t="",r=e.indexOf(".");return r>=0&&(t=e.slice(r+1),e=e.slice(0,r)),{type:e,name:t}})}function onRemove(e){return function(){var t=this.__on;if(t){for(var r,n=0,i=-1,o=t.length;n<o;++n)r=t[n],e.type&&r.type!==e.type||r.name!==e.name?t[++i]=r:this.removeEventListener(r.type,r.listener,r.capture);++i?t.length=i:delete this.__on}}}function onAdd(e,t,r){var n=filterEvents.hasOwnProperty(e.type)?filterContextListener:contextListener;return function(i,o,a){var s,u=this.__on,c=n(t,o,a);if(u)for(var l=0,f=u.length;l<f;++l)if((s=u[l]).type===e.type&&s.name===e.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=c,s.capture=r),void(s.value=t);this.addEventListener(e.type,c,r),s={type:e.type,name:e.name,value:t,listener:c,capture:r},u?u.push(s):this.__on=[s]}}function selection_on(e,t,r){var n,i,o=parseTypenames$1(e+""),a=o.length;if(!(arguments.length<2)){for(s=t?onAdd:onRemove,null==r&&(r=!1),n=0;n<a;++n)this.each(s(o[n],t,r));return this}var s=this.node().__on;if(s)for(var u,c=0,l=s.length;c<l;++c)for(n=0,u=s[c];n<a;++n)if((i=o[n]).type===u.type&&i.name===u.name)return u.value}function none(){}function selector(e){return null==e?none:function(){return this.querySelector(e)}}function selection_select(e){"function"!=typeof e&&(e=selector(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o,a,s=t[i],u=s.length,c=n[i]=new Array(u),l=0;l<u;++l)(o=s[l])&&(a=e.call(o,o.__data__,l,s))&&("__data__"in o&&(a.__data__=o.__data__),c[l]=a);return new Selection(n,this._parents)}function empty$1(){return[]}function selectorAll(e){return null==e?empty$1:function(){return this.querySelectorAll(e)}}function selection_selectAll(e){"function"!=typeof e&&(e=selectorAll(e));for(var t=this._groups,r=t.length,n=[],i=[],o=0;o<r;++o)for(var a,s=t[o],u=s.length,c=0;c<u;++c)(a=s[c])&&(n.push(e.call(a,a.__data__,c,s)),i.push(a));return new Selection(n,i)}function selection_filter(e){"function"!=typeof e&&(e=matcher$1(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o,a=t[i],s=a.length,u=n[i]=[],c=0;c<s;++c)(o=a[c])&&e.call(o,o.__data__,c,a)&&u.push(o);return new Selection(n,this._parents)}function sparse(e){return new Array(e.length)}function selection_enter(){return new Selection(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function constant$1(e){return function(){return e}}EnterNode.prototype={constructor:EnterNode,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var keyPrefix="$";function bindIndex(e,t,r,n,i,o){for(var a,s=0,u=t.length,c=o.length;s<c;++s)(a=t[s])?(a.__data__=o[s],n[s]=a):r[s]=new EnterNode(e,o[s]);for(;s<u;++s)(a=t[s])&&(i[s]=a)}function bindKey(e,t,r,n,i,o,a){var s,u,c,l={},f=t.length,d=o.length,h=new Array(f);for(s=0;s<f;++s)(u=t[s])&&(h[s]=c=keyPrefix+a.call(u,u.__data__,s,t),c in l?i[s]=u:l[c]=u);for(s=0;s<d;++s)(u=l[c=keyPrefix+a.call(e,o[s],s,o)])?(n[s]=u,u.__data__=o[s],l[c]=null):r[s]=new EnterNode(e,o[s]);for(s=0;s<f;++s)(u=t[s])&&l[h[s]]===u&&(i[s]=u)}function selection_data(e,t){if(!e)return h=new Array(this.size()),c=-1,this.each(function(e){h[++c]=e}),h;var r=t?bindKey:bindIndex,n=this._parents,i=this._groups;"function"!=typeof e&&(e=constant$1(e));for(var o=i.length,a=new Array(o),s=new Array(o),u=new Array(o),c=0;c<o;++c){var l=n[c],f=i[c],d=f.length,h=e.call(l,l&&l.__data__,c,n),p=h.length,m=s[c]=new Array(p),g=a[c]=new Array(p);r(l,f,m,g,u[c]=new Array(d),h,t);for(var y,b,v=0,_=0;v<p;++v)if(y=m[v]){for(v>=_&&(_=v+1);!(b=g[_])&&++_<p;);y._next=b||null}}return(a=new Selection(a,n))._enter=s,a._exit=u,a}function selection_exit(){return new Selection(this._exit||this._groups.map(sparse),this._parents)}function selection_merge(e){for(var t=this._groups,r=e._groups,n=t.length,i=r.length,o=Math.min(n,i),a=new Array(n),s=0;s<o;++s)for(var u,c=t[s],l=r[s],f=c.length,d=a[s]=new Array(f),h=0;h<f;++h)(u=c[h]||l[h])&&(d[h]=u);for(;s<n;++s)a[s]=t[s];return new Selection(a,this._parents)}function selection_order(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n,i=e[t],o=i.length-1,a=i[o];--o>=0;)(n=i[o])&&(a&&a!==n.nextSibling&&a.parentNode.insertBefore(n,a),a=n);return this}function selection_sort(e){function t(t,r){return t&&r?e(t.__data__,r.__data__):!t-!r}e||(e=ascending$1);for(var r=this._groups,n=r.length,i=new Array(n),o=0;o<n;++o){for(var a,s=r[o],u=s.length,c=i[o]=new Array(u),l=0;l<u;++l)(a=s[l])&&(c[l]=a);c.sort(t)}return new Selection(i,this._parents).order()}function ascending$1(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function selection_call(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function selection_nodes(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e}function selection_node(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,o=n.length;i<o;++i){var a=n[i];if(a)return a}return null}function selection_size(){var e=0;return this.each(function(){++e}),e}function selection_empty(){return!this.node()}function selection_each(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var i,o=t[r],a=0,s=o.length;a<s;++a)(i=o[a])&&e.call(i,i.__data__,a,o);return this}function attrRemove(e){return function(){this.removeAttribute(e)}}function attrRemoveNS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant(e,t){return function(){this.setAttribute(e,t)}}function attrConstantNS(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function attrFunction(e,t){return function(){var r=t.apply(this,arguments);null==r?this.removeAttribute(e):this.setAttribute(e,r)}}function attrFunctionNS(e,t){return function(){var r=t.apply(this,arguments);null==r?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function selection_attr(e,t){var r=namespace(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((null==t?r.local?attrRemoveNS:attrRemove:"function"==typeof t?r.local?attrFunctionNS:attrFunction:r.local?attrConstantNS:attrConstant)(r,t))}function defaultView(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function styleRemove(e){return function(){this.style.removeProperty(e)}}function styleConstant(e,t,r){return function(){this.style.setProperty(e,t,r)}}function styleFunction(e,t,r){return function(){var n=t.apply(this,arguments);null==n?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function selection_style(e,t,r){return arguments.length>1?this.each((null==t?styleRemove:"function"==typeof t?styleFunction:styleConstant)(e,t,null==r?"":r)):styleValue(this.node(),e)}function styleValue(e,t){return e.style.getPropertyValue(t)||defaultView(e).getComputedStyle(e,null).getPropertyValue(t)}function propertyRemove(e){return function(){delete this[e]}}function propertyConstant(e,t){return function(){this[e]=t}}function propertyFunction(e,t){return function(){var r=t.apply(this,arguments);null==r?delete this[e]:this[e]=r}}function selection_property(e,t){return arguments.length>1?this.each((null==t?propertyRemove:"function"==typeof t?propertyFunction:propertyConstant)(e,t)):this.node()[e]}function classArray(e){return e.trim().split(/^|\s+/)}function classList(e){return e.classList||new ClassList(e)}function ClassList(e){this._node=e,this._names=classArray(e.getAttribute("class")||"")}function classedAdd(e,t){for(var r=classList(e),n=-1,i=t.length;++n<i;)r.add(t[n])}function classedRemove(e,t){for(var r=classList(e),n=-1,i=t.length;++n<i;)r.remove(t[n])}function classedTrue(e){return function(){classedAdd(this,e)}}function classedFalse(e){return function(){classedRemove(this,e)}}function classedFunction(e,t){return function(){(t.apply(this,arguments)?classedAdd:classedRemove)(this,e)}}function selection_classed(e,t){var r=classArray(e+"");if(arguments.length<2){for(var n=classList(this.node()),i=-1,o=r.length;++i<o;)if(!n.contains(r[i]))return!1;return!0}return this.each(("function"==typeof t?classedFunction:t?classedTrue:classedFalse)(r,t))}function textRemove(){this.textContent=""}function textConstant(e){return function(){this.textContent=e}}function textFunction(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function selection_text(e){return arguments.length?this.each(null==e?textRemove:("function"==typeof e?textFunction:textConstant)(e)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(e){return function(){this.innerHTML=e}}function htmlFunction(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function selection_html(e){return arguments.length?this.each(null==e?htmlRemove:("function"==typeof e?htmlFunction:htmlConstant)(e)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(e){var t="function"==typeof e?e:creator(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function constantNull(){return null}function selection_insert(e,t){var r="function"==typeof e?e:creator(e),n=null==t?constantNull:"function"==typeof t?t:selector(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function remove(){var e=this.parentNode;e&&e.removeChild(this)}function selection_remove(){return this.each(remove)}function selection_datum(e){return arguments.length?this.property("__data__",e):this.node().__data__}function dispatchEvent(e,t,r){var n=defaultView(e),i=n.CustomEvent;"function"==typeof i?i=new i(t,r):(i=n.document.createEvent("Event"),r?(i.initEvent(t,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function dispatchConstant(e,t){return function(){return dispatchEvent(this,e,t)}}function dispatchFunction(e,t){return function(){return dispatchEvent(this,e,t.apply(this,arguments))}}function selection_dispatch(e,t){return this.each(("function"==typeof t?dispatchFunction:dispatchConstant)(e,t))}ClassList.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var root=[null];function Selection(e,t){this._groups=e,this._parents=t}function selection(){return new Selection([[document.documentElement]],root)}function define(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function extend(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Color(){}Selection.prototype=selection.prototype={constructor:Selection,select:selection_select,selectAll:selection_selectAll,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,merge:selection_merge,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,datum:selection_datum,on:selection_on,dispatch:selection_dispatch};var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex3=/^#([0-9a-f]{3})$/,reHex6=/^#([0-9a-f]{6})$/,reRgbInteger=new RegExp("^rgb\\("+[reI,reI,reI]+"\\)$"),reRgbPercent=new RegExp("^rgb\\("+[reP,reP,reP]+"\\)$"),reRgbaInteger=new RegExp("^rgba\\("+[reI,reI,reI,reN]+"\\)$"),reRgbaPercent=new RegExp("^rgba\\("+[reP,reP,reP,reN]+"\\)$"),reHslPercent=new RegExp("^hsl\\("+[reN,reP,reP]+"\\)$"),reHslaPercent=new RegExp("^hsla\\("+[reN,reP,reP,reN]+"\\)$"),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function color(e){var t;return e=(e+"").trim().toLowerCase(),(t=reHex3.exec(e))?new Rgb((t=parseInt(t[1],16))>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):(t=reHex6.exec(e))?rgbn(parseInt(t[1],16)):(t=reRgbInteger.exec(e))?new Rgb(t[1],t[2],t[3],1):(t=reRgbPercent.exec(e))?new Rgb(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=reRgbaInteger.exec(e))?rgba(t[1],t[2],t[3],t[4]):(t=reRgbaPercent.exec(e))?rgba(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=reHslPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,1):(t=reHslaPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,t[4]):named.hasOwnProperty(e)?rgbn(named[e]):"transparent"===e?new Rgb(NaN,NaN,NaN,0):null}function rgbn(e){return new Rgb(e>>16&255,e>>8&255,255&e,1)}function rgba(e,t,r,n){return n<=0&&(e=t=r=NaN),new Rgb(e,t,r,n)}function rgbConvert(e){return e instanceof Color||(e=color(e)),e?new Rgb((e=e.rgb()).r,e.g,e.b,e.opacity):new Rgb}function rgb(e,t,r,n){return 1===arguments.length?rgbConvert(e):new Rgb(e,t,r,null==n?1:n)}function Rgb(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function hsla(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Hsl(e,t,r,n)}function hslConvert(e){if(e instanceof Hsl)return new Hsl(e.h,e.s,e.l,e.opacity);if(e instanceof Color||(e=color(e)),!e)return new Hsl;if(e instanceof Hsl)return e;var t=(e=e.rgb()).r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),o=Math.max(t,r,n),a=NaN,s=o-i,u=(o+i)/2;return s?(a=t===o?(r-n)/s+6*(r<n):r===o?(n-t)/s+2:(t-r)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Hsl(a,s,u,e.opacity)}function hsl(e,t,r,n){return 1===arguments.length?hslConvert(e):new Hsl(e,t,r,null==n?1:n)}function Hsl(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function hsl2rgb(e,t,r){return 255*(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)}define(Color,color,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),define(Rgb,rgb,extend(Color,{brighter:function(e){return e=null==e?brighter:Math.pow(brighter,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?darker:Math.pow(darker,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}})),define(Hsl,hsl,extend(Color,{brighter:function(e){return e=null==e?brighter:Math.pow(brighter,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?darker:Math.pow(darker,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Rgb(hsl2rgb(e>=240?e-240:e+120,i,n),hsl2rgb(e,i,n),hsl2rgb(e<120?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var deg2rad=Math.PI/180,rad2deg=180/Math.PI,Kn=18,Xn=.95047,Yn=1,Zn=1.08883,t0=4/29,t1=6/29,t2=3*t1*t1,t3=t1*t1*t1;function labConvert(e){if(e instanceof Lab)return new Lab(e.l,e.a,e.b,e.opacity);if(e instanceof Hcl){var t=e.h*deg2rad;return new Lab(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}e instanceof Rgb||(e=rgbConvert(e));var r=rgb2xyz(e.r),n=rgb2xyz(e.g),i=rgb2xyz(e.b),o=xyz2lab((.4124564*r+.3575761*n+.1804375*i)/Xn),a=xyz2lab((.2126729*r+.7151522*n+.072175*i)/Yn);return new Lab(116*a-16,500*(o-a),200*(a-xyz2lab((.0193339*r+.119192*n+.9503041*i)/Zn)),e.opacity)}function lab(e,t,r,n){return 1===arguments.length?labConvert(e):new Lab(e,t,r,null==n?1:n)}function Lab(e,t,r,n){this.l=+e,this.a=+t,this.b=+r,this.opacity=+n}function xyz2lab(e){return e>t3?Math.pow(e,1/3):e/t2+t0}function lab2xyz(e){return e>t1?e*e*e:t2*(e-t0)}function xyz2rgb(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function rgb2xyz(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function hclConvert(e){if(e instanceof Hcl)return new Hcl(e.h,e.c,e.l,e.opacity);e instanceof Lab||(e=labConvert(e));var t=Math.atan2(e.b,e.a)*rad2deg;return new Hcl(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function hcl(e,t,r,n){return 1===arguments.length?hclConvert(e):new Hcl(e,t,r,null==n?1:n)}function Hcl(e,t,r,n){this.h=+e,this.c=+t,this.l=+r,this.opacity=+n}define(Lab,lab,extend(Color,{brighter:function(e){return new Lab(this.l+Kn*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Lab(this.l-Kn*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;return e=Yn*lab2xyz(e),new Rgb(xyz2rgb(3.2404542*(t=Xn*lab2xyz(t))-1.5371385*e-.4985314*(r=Zn*lab2xyz(r))),xyz2rgb(-.969266*t+1.8760108*e+.041556*r),xyz2rgb(.0556434*t-.2040259*e+1.0572252*r),this.opacity)}})),define(Hcl,hcl,extend(Color,{brighter:function(e){return new Hcl(this.h,this.c,this.l+Kn*(null==e?1:e),this.opacity)},darker:function(e){return new Hcl(this.h,this.c,this.l-Kn*(null==e?1:e),this.opacity)},rgb:function(){return labConvert(this).rgb()}}));var A=-.14861,B=1.78277,C=-.29227,D=-.90649,E=1.97294,ED=E*D,EB=E*B,BC_DA=B*C-D*A;function cubehelixConvert(e){if(e instanceof Cubehelix)return new Cubehelix(e.h,e.s,e.l,e.opacity);e instanceof Rgb||(e=rgbConvert(e));var t=e.r/255,r=e.g/255,n=e.b/255,i=(BC_DA*n+ED*t-EB*r)/(BC_DA+ED-EB),o=n-i,a=(E*(r-i)-C*o)/D,s=Math.sqrt(a*a+o*o)/(E*i*(1-i)),u=s?Math.atan2(a,o)*rad2deg-120:NaN;return new Cubehelix(u<0?u+360:u,s,i,e.opacity)}function cubehelix(e,t,r,n){return 1===arguments.length?cubehelixConvert(e):new Cubehelix(e,t,r,null==n?1:n)}function Cubehelix(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function constant$3(e){return function(){return e}}function linear(e,t){return function(r){return e+r*t}}function exponential(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function hue(e,t){var r=t-e;return r?linear(e,r>180||r<-180?r-360*Math.round(r/360):r):constant$3(isNaN(e)?t:e)}function gamma(e){return 1==(e=+e)?nogamma:function(t,r){return r-t?exponential(t,r,e):constant$3(isNaN(t)?r:t)}}function nogamma(e,t){var r=t-e;return r?linear(e,r):constant$3(isNaN(e)?t:e)}define(Cubehelix,cubehelix,extend(Color,{brighter:function(e){return e=null==e?brighter:Math.pow(brighter,e),new Cubehelix(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?darker:Math.pow(darker,e),new Cubehelix(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*deg2rad,t=+this.l,r=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),i=Math.sin(e);return new Rgb(255*(t+r*(A*n+B*i)),255*(t+r*(C*n+D*i)),255*(t+r*(E*n)),this.opacity)}}));var interpolateRgb=function e(t){var r=gamma(t);function n(e,t){var n=r((e=rgb(e)).r,(t=rgb(t)).r),i=r(e.g,t.g),o=r(e.b,t.b),a=nogamma(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return n.gamma=e,n}(1);function reinterpolate(e,t){return t-=e=+e,function(r){return e+t*r}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(e){return function(){return e}}function one(e){return function(t){return e(t)+""}}function interpolateString(e,t){var r,n,i,o=reA.lastIndex=reB.lastIndex=0,a=-1,s=[],u=[];for(e+="",t+="";(r=reA.exec(e))&&(n=reB.exec(t));)(i=n.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(r=r[0])===(n=n[0])?s[a]?s[a]+=n:s[++a]=n:(s[++a]=null,u.push({i:a,x:reinterpolate(r,n)})),o=reB.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?one(u[0].x):zero(t):(t=u.length,function(e){for(var r,n=0;n<t;++n)s[(r=u[n]).i]=r.x(e);return s.join("")})}var degrees=180/Math.PI,identity$2={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},cssNode,cssRoot,cssView,svgNode;function decompose(e,t,r,n,i,o){var a,s,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*r+t*n)&&(r-=e*u,n-=t*u),(s=Math.sqrt(r*r+n*n))&&(r/=s,n/=s,u/=s),e*n<t*r&&(e=-e,t=-t,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*degrees,skewX:Math.atan(u)*degrees,scaleX:a,scaleY:s}}function parseCss(e){return"none"===e?identity$2:(cssNode||(cssNode=document.createElement("DIV"),cssRoot=document.documentElement,cssView=document.defaultView),cssNode.style.transform=e,e=cssView.getComputedStyle(cssRoot.appendChild(cssNode),null).getPropertyValue("transform"),cssRoot.removeChild(cssNode),decompose(+(e=e.slice(7,-1).split(","))[0],+e[1],+e[2],+e[3],+e[4],+e[5]))}function parseSvg(e){return null==e?identity$2:(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",e),(e=svgNode.transform.baseVal.consolidate())?decompose((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):identity$2)}function interpolateTransform(e,t,r,n){function i(e){return e.length?e.pop()+" ":""}return function(o,a){var s,u,c,l,f,d,h=[],p=[];return o=e(o),a=e(a),function(e,n,i,o,a,s){if(e!==i||n!==o){var u=a.push("translate(",null,t,null,r);s.push({i:u-4,x:reinterpolate(e,i)},{i:u-2,x:reinterpolate(n,o)})}else(i||o)&&a.push("translate("+i+t+o+r)}(o.translateX,o.translateY,a.translateX,a.translateY,h,p),s=o.rotate,u=a.rotate,c=h,s!==u?(s-u>180?u+=360:u-s>180&&(s+=360),p.push({i:c.push(i(c)+"rotate(",null,n)-2,x:reinterpolate(s,u)})):u&&c.push(i(c)+"rotate("+u+n),l=o.skewX,f=a.skewX,d=h,l!==f?p.push({i:d.push(i(d)+"skewX(",null,n)-2,x:reinterpolate(l,f)}):f&&d.push(i(d)+"skewX("+f+n),function(e,t,r,n,o,a){if(e!==r||t!==n){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:reinterpolate(e,r)},{i:s-2,x:reinterpolate(t,n)})}else 1===r&&1===n||o.push(i(o)+"scale("+r+","+n+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,h,p),o=a=null,function(e){for(var t,r=-1,n=p.length;++r<n;)h[(t=p[r]).i]=t.x(e);return h.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),rho=Math.SQRT2;function cubehelix$1(e){return function t(r){function n(t,n){var i=e((t=cubehelix(t)).h,(n=cubehelix(n)).h),o=nogamma(t.s,n.s),a=nogamma(t.l,n.l),s=nogamma(t.opacity,n.opacity);return function(e){return t.h=i(e),t.s=o(e),t.l=a(Math.pow(e,r)),t.opacity=s(e),t+""}}return r=+r,n.gamma=t,n}(1)}cubehelix$1(hue);var cubehelixLong=cubehelix$1(nogamma),frame=0,timeout=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock="object"==typeof performance&&performance.now?performance:Date,setFrame="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}function timer(e,t,r){var n=new Timer;return n.restart(e,t,r),n}function timerFlush(){now(),++frame;for(var e,t=taskHead;t;)(e=clockNow-t._time)>=0&&t._call.call(null,e),t=t._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var e=clock.now(),t=e-clockLast;t>pokeDelay&&(clockSkew-=t,clockLast=e)}function nap(){for(var e,t,r=taskHead,n=1/0;r;)r._call?(n>r._time&&(n=r._time),e=r,r=r._next):(t=r._next,r._next=null,r=e?e._next=t:taskHead=t);taskTail=e,sleep(n)}function sleep(e){frame||(timeout&&(timeout=clearTimeout(timeout)),e-clockNow>24?(e<1/0&&(timeout=setTimeout(wake,e-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake)))}function timeout$1(e,t,r){var n=new Timer;return t=null==t?0:+t,n.restart(function(r){n.stop(),e(r+t)},t,r),n}Timer.prototype=timer.prototype={constructor:Timer,restart:function(e,t,r){if("function"!=typeof e)throw new TypeError("callback is not a function");r=(null==r?now():+r)+(null==t?0:+t),this._next||taskTail===this||(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=e,this._time=r,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};var emptyOn=dispatch("start","end","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(e,t,r,n,i,o){var a=e.__transition;if(a){if(r in a)return}else e.__transition={};create(e,r,{name:t,index:n,group:i,on:emptyOn,tween:emptyTween,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:CREATED})}function init(e,t){var r=get$1(e,t);if(r.state>CREATED)throw new Error("too late; already scheduled");return r}function set$1(e,t){var r=get$1(e,t);if(r.state>STARTING)throw new Error("too late; already started");return r}function get$1(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function create(e,t,r){var n,i=e.__transition;function o(u){var c,l,f,d;if(r.state!==SCHEDULED)return s();for(c in i)if((d=i[c]).name===r.name){if(d.state===STARTED)return timeout$1(o);d.state===RUNNING?(d.state=ENDED,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete i[c]):+c<t&&(d.state=ENDED,d.timer.stop(),delete i[c])}if(timeout$1(function(){r.state===STARTED&&(r.state=RUNNING,r.timer.restart(a,r.delay,r.time),a(u))}),r.state=STARTING,r.on.call("start",e,e.__data__,r.index,r.group),r.state===STARTING){for(r.state=STARTED,n=new Array(f=r.tween.length),c=0,l=-1;c<f;++c)(d=r.tween[c].value.call(e,e.__data__,r.index,r.group))&&(n[++l]=d);n.length=l+1}}function a(t){for(var i=t<r.duration?r.ease.call(null,t/r.duration):(r.timer.restart(s),r.state=ENDING,1),o=-1,a=n.length;++o<a;)n[o].call(null,i);r.state===ENDING&&(r.on.call("end",e,e.__data__,r.index,r.group),s())}function s(){r.state=ENDED,r.timer.stop(),delete i[t];for(var n in i)return;delete e.__transition}i[t]=r,r.timer=timer(function(e){r.state=SCHEDULED,r.timer.restart(o,r.delay,r.time),r.delay<=e&&o(e-r.delay)},0,r.time)}function interrupt(e,t){var r,n,i,o=e.__transition,a=!0;if(o){t=null==t?null:t+"";for(i in o)(r=o[i]).name===t?(n=r.state>STARTING&&r.state<ENDING,r.state=ENDED,r.timer.stop(),n&&r.on.call("interrupt",e,e.__data__,r.index,r.group),delete o[i]):a=!1;a&&delete e.__transition}}function selection_interrupt(e){return this.each(function(){interrupt(this,e)})}function tweenRemove(e,t){var r,n;return function(){var i=set$1(this,e),o=i.tween;if(o!==r)for(var a=0,s=(n=r=o).length;a<s;++a)if(n[a].name===t){(n=n.slice()).splice(a,1);break}i.tween=n}}function tweenFunction(e,t,r){var n,i;if("function"!=typeof r)throw new Error;return function(){var o=set$1(this,e),a=o.tween;if(a!==n){i=(n=a).slice();for(var s={name:t,value:r},u=0,c=i.length;u<c;++u)if(i[u].name===t){i[u]=s;break}u===c&&i.push(s)}o.tween=i}}function transition_tween(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n,i=get$1(this.node(),r).tween,o=0,a=i.length;o<a;++o)if((n=i[o]).name===e)return n.value;return null}return this.each((null==t?tweenRemove:tweenFunction)(r,e,t))}function tweenValue(e,t,r){var n=e._id;return e.each(function(){var e=set$1(this,n);(e.value||(e.value={}))[t]=r.apply(this,arguments)}),function(e){return get$1(e,n).value[t]}}function interpolate(e,t){var r;return("number"==typeof t?reinterpolate:t instanceof color?interpolateRgb:(r=color(t))?(t=r,interpolateRgb):interpolateString)(e,t)}function attrRemove$1(e){return function(){this.removeAttribute(e)}}function attrRemoveNS$1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant$1(e,t,r){var n,i;return function(){var o=this.getAttribute(e);return o===r?null:o===n?i:i=t(n=o,r)}}function attrConstantNS$1(e,t,r){var n,i;return function(){var o=this.getAttributeNS(e.space,e.local);return o===r?null:o===n?i:i=t(n=o,r)}}function attrFunction$1(e,t,r){var n,i,o;return function(){var a,s=r(this);if(null!=s)return(a=this.getAttribute(e))===s?null:a===n&&s===i?o:o=t(n=a,i=s);this.removeAttribute(e)}}function attrFunctionNS$1(e,t,r){var n,i,o;return function(){var a,s=r(this);if(null!=s)return(a=this.getAttributeNS(e.space,e.local))===s?null:a===n&&s===i?o:o=t(n=a,i=s);this.removeAttributeNS(e.space,e.local)}}function transition_attr(e,t){var r=namespace(e),n="transform"===r?interpolateTransformSvg:interpolate;return this.attrTween(e,"function"==typeof t?(r.local?attrFunctionNS$1:attrFunction$1)(r,n,tweenValue(this,"attr."+e,t)):null==t?(r.local?attrRemoveNS$1:attrRemove$1)(r):(r.local?attrConstantNS$1:attrConstant$1)(r,n,t+""))}function attrTweenNS(e,t){function r(){var r=this,n=t.apply(r,arguments);return n&&function(t){r.setAttributeNS(e.space,e.local,n(t))}}return r._value=t,r}function attrTween(e,t){function r(){var r=this,n=t.apply(r,arguments);return n&&function(t){r.setAttribute(e,n(t))}}return r._value=t,r}function transition_attrTween(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;var n=namespace(e);return this.tween(r,(n.local?attrTweenNS:attrTween)(n,t))}function delayFunction(e,t){return function(){init(this,e).delay=+t.apply(this,arguments)}}function delayConstant(e,t){return t=+t,function(){init(this,e).delay=t}}function transition_delay(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?delayFunction:delayConstant)(t,e)):get$1(this.node(),t).delay}function durationFunction(e,t){return function(){set$1(this,e).duration=+t.apply(this,arguments)}}function durationConstant(e,t){return t=+t,function(){set$1(this,e).duration=t}}function transition_duration(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?durationFunction:durationConstant)(t,e)):get$1(this.node(),t).duration}function easeConstant(e,t){if("function"!=typeof t)throw new Error;return function(){set$1(this,e).ease=t}}function transition_ease(e){var t=this._id;return arguments.length?this.each(easeConstant(t,e)):get$1(this.node(),t).ease}function transition_filter(e){"function"!=typeof e&&(e=matcher$1(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var o,a=t[i],s=a.length,u=n[i]=[],c=0;c<s;++c)(o=a[c])&&e.call(o,o.__data__,c,a)&&u.push(o);return new Transition(n,this._parents,this._name,this._id)}function transition_merge(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,i=r.length,o=Math.min(n,i),a=new Array(n),s=0;s<o;++s)for(var u,c=t[s],l=r[s],f=c.length,d=a[s]=new Array(f),h=0;h<f;++h)(u=c[h]||l[h])&&(d[h]=u);for(;s<n;++s)a[s]=t[s];return new Transition(a,this._parents,this._name,this._id)}function start(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}function onFunction(e,t,r){var n,i,o=start(t)?init:set$1;return function(){var a=o(this,e),s=a.on;s!==n&&(i=(n=s).copy()).on(t,r),a.on=i}}function transition_on(e,t){var r=this._id;return arguments.length<2?get$1(this.node(),r).on.on(e):this.each(onFunction(r,e,t))}function removeFunction(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function transition_remove(){return this.on("end.remove",removeFunction(this._id))}function transition_select(e){var t=this._name,r=this._id;"function"!=typeof e&&(e=selector(e));for(var n=this._groups,i=n.length,o=new Array(i),a=0;a<i;++a)for(var s,u,c=n[a],l=c.length,f=o[a]=new Array(l),d=0;d<l;++d)(s=c[d])&&(u=e.call(s,s.__data__,d,c))&&("__data__"in s&&(u.__data__=s.__data__),f[d]=u,schedule(f[d],t,r,d,f,get$1(s,r)));return new Transition(o,this._parents,t,r)}function transition_selectAll(e){var t=this._name,r=this._id;"function"!=typeof e&&(e=selectorAll(e));for(var n=this._groups,i=n.length,o=[],a=[],s=0;s<i;++s)for(var u,c=n[s],l=c.length,f=0;f<l;++f)if(u=c[f]){for(var d,h=e.call(u,u.__data__,f,c),p=get$1(u,r),m=0,g=h.length;m<g;++m)(d=h[m])&&schedule(d,t,r,m,h,p);o.push(h),a.push(u)}return new Transition(o,a,t,r)}var Selection$1=selection.prototype.constructor;function transition_selection(){return new Selection$1(this._groups,this._parents)}function styleRemove$1(e,t){var r,n,i;return function(){var o=styleValue(this,e),a=(this.style.removeProperty(e),styleValue(this,e));return o===a?null:o===r&&a===n?i:i=t(r=o,n=a)}}function styleRemoveEnd(e){return function(){this.style.removeProperty(e)}}function styleConstant$1(e,t,r){var n,i;return function(){var o=styleValue(this,e);return o===r?null:o===n?i:i=t(n=o,r)}}function styleFunction$1(e,t,r){var n,i,o;return function(){var a=styleValue(this,e),s=r(this);return null==s&&(this.style.removeProperty(e),s=styleValue(this,e)),a===s?null:a===n&&s===i?o:o=t(n=a,i=s)}}function transition_style(e,t,r){var n="transform"==(e+="")?interpolateTransformCss:interpolate;return null==t?this.styleTween(e,styleRemove$1(e,n)).on("end.style."+e,styleRemoveEnd(e)):this.styleTween(e,"function"==typeof t?styleFunction$1(e,n,tweenValue(this,"style."+e,t)):styleConstant$1(e,n,t+""),r)}function styleTween(e,t,r){function n(){var n=this,i=t.apply(n,arguments);return i&&function(t){n.style.setProperty(e,i(t),r)}}return n._value=t,n}function transition_styleTween(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;return this.tween(n,styleTween(e,t,null==r?"":r))}function textConstant$1(e){return function(){this.textContent=e}}function textFunction$1(e){return function(){var t=e(this);this.textContent=null==t?"":t}}function transition_text(e){return this.tween("text","function"==typeof e?textFunction$1(tweenValue(this,"text",e)):textConstant$1(null==e?"":e+""))}function transition_transition(){for(var e=this._name,t=this._id,r=newId(),n=this._groups,i=n.length,o=0;o<i;++o)for(var a,s=n[o],u=s.length,c=0;c<u;++c)if(a=s[c]){var l=get$1(a,t);schedule(a,e,r,c,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new Transition(n,this._parents,e,r)}var id=0;function Transition(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function transition(e){return selection().transition(e)}function newId(){return++id}var selection_prototype=selection.prototype;function cubicInOut(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}Transition.prototype=transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease};var pi=Math.PI,tau=2*Math.PI,defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))return defaultTiming.time=now(),defaultTiming;return r}function selection_transition(e){var t,r;e instanceof Transition?(t=e._id,e=e._name):(t=newId(),(r=defaultTiming).time=now(),e=null==e?null:e+"");for(var n=this._groups,i=n.length,o=0;o<i;++o)for(var a,s=n[o],u=s.length,c=0;c<u;++c)(a=s[c])&&schedule(a,e,t,c,s,r||inherit(a,t));return new Transition(n,this._parents,e,t)}selection.prototype.interrupt=selection_interrupt,selection.prototype.transition=selection_transition;var X={name:"x",handles:["e","w"].map(type),input:function(e,t){return e&&[[e[0],t[0][1]],[e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},Y={name:"y",handles:["n","s"].map(type),input:function(e,t){return e&&[[t[0][0],e[0]],[t[1][0],e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},XY={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(type),input:function(e){return e},output:function(e){return e}};function type(e){return{type:e}}var pi$1=Math.PI,pi$2=Math.PI,prefix="$";function Map$1(){}function map$1(e,t){var r=new Map$1;if(e instanceof Map$1)e.each(function(e,t){r.set(t,e)});else if(Array.isArray(e)){var n,i=-1,o=e.length;if(null==t)for(;++i<o;)r.set(i,e[i]);else for(;++i<o;)r.set(t(n=e[i],i,e),n)}else if(e)for(var a in e)r.set(a,e[a]);return r}function Set$1(){}Map$1.prototype=map$1.prototype={constructor:Map$1,has:function(e){return prefix+e in this},get:function(e){return this[prefix+e]},set:function(e,t){return this[prefix+e]=t,this},remove:function(e){var t=prefix+e;return t in this&&delete this[t]},clear:function(){for(var e in this)e[0]===prefix&&delete this[e]},keys:function(){var e=[];for(var t in this)t[0]===prefix&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)t[0]===prefix&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)t[0]===prefix&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)t[0]===prefix&&++e;return e},empty:function(){for(var e in this)if(e[0]===prefix)return!1;return!0},each:function(e){for(var t in this)t[0]===prefix&&e(this[t],t.slice(1),this)}};var proto=map$1.prototype;function set$2(e,t){var r=new Set$1;if(e instanceof Set$1)e.each(function(e){r.add(e)});else if(e){var n=-1,i=e.length;if(null==t)for(;++n<i;)r.add(e[n]);else for(;++n<i;)r.add(t(e[n],n,e))}return r}Set$1.prototype=set$2.prototype={constructor:Set$1,has:proto.has,add:function(e){return this[prefix+(e+="")]=e,this},remove:proto.remove,clear:proto.clear,values:proto.keys,size:proto.size,empty:proto.empty,each:proto.each};var EOL={},EOF={},QUOTE=34,NEWLINE=10,RETURN=13;function objectConverter(e){return new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}")}function customConverter(e,t){var r=objectConverter(e);return function(n,i){return t(r(n),i,e)}}function inferColumns(e){var t=Object.create(null),r=[];return e.forEach(function(e){for(var n in e)n in t||r.push(t[n]=n)}),r}function dsv(e){var t=new RegExp('["'+e+"\n\r]"),r=e.charCodeAt(0);function n(e,t){var n,i=[],o=e.length,a=0,s=0,u=o<=0,c=!1;function l(){if(u)return EOF;if(c)return c=!1,EOL;var t,n,i=a;if(e.charCodeAt(i)===QUOTE){for(;a++<o&&e.charCodeAt(a)!==QUOTE||e.charCodeAt(++a)===QUOTE;);return(t=a)>=o?u=!0:(n=e.charCodeAt(a++))===NEWLINE?c=!0:n===RETURN&&(c=!0,e.charCodeAt(a)===NEWLINE&&++a),e.slice(i+1,t-1).replace(/""/g,'"')}for(;a<o;){if((n=e.charCodeAt(t=a++))===NEWLINE)c=!0;else if(n===RETURN)c=!0,e.charCodeAt(a)===NEWLINE&&++a;else if(n!==r)continue;return e.slice(i,t)}return u=!0,e.slice(i,o)}for(e.charCodeAt(o-1)===NEWLINE&&--o,e.charCodeAt(o-1)===RETURN&&--o;(n=l())!==EOF;){for(var f=[];n!==EOL&&n!==EOF;)f.push(n),n=l();t&&null==(f=t(f,s++))||i.push(f)}return i}function i(t){return t.map(o).join(e)}function o(e){return null==e?"":t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var r,i,o=n(e,function(e,n){if(r)return r(e,n-1);i=e,r=t?customConverter(e,t):objectConverter(e)});return o.columns=i||[],o},parseRows:n,format:function(t,r){return null==r&&(r=inferColumns(t)),[r.map(o).join(e)].concat(t.map(function(t){return r.map(function(e){return o(t[e])}).join(e)})).join("\n")},formatRows:function(e){return e.map(i).join("\n")}}}var csv=dsv(","),tsv=dsv("\t");function tree_add(e){var t=+this._x.call(null,e),r=+this._y.call(null,e);return add(this.cover(t,r),t,r,e)}function add(e,t,r,n){if(isNaN(t)||isNaN(r))return e;var i,o,a,s,u,c,l,f,d,h=e._root,p={data:n},m=e._x0,g=e._y0,y=e._x1,b=e._y1;if(!h)return e._root=p,e;for(;h.length;)if((c=t>=(o=(m+y)/2))?m=o:y=o,(l=r>=(a=(g+b)/2))?g=a:b=a,i=h,!(h=h[f=l<<1|c]))return i[f]=p,e;if(s=+e._x.call(null,h.data),u=+e._y.call(null,h.data),t===s&&r===u)return p.next=h,i?i[f]=p:e._root=p,e;do{i=i?i[f]=new Array(4):e._root=new Array(4),(c=t>=(o=(m+y)/2))?m=o:y=o,(l=r>=(a=(g+b)/2))?g=a:b=a}while((f=l<<1|c)==(d=(u>=a)<<1|s>=o));return i[d]=h,i[f]=p,e}function addAll(e){var t,r,n,i,o=e.length,a=new Array(o),s=new Array(o),u=1/0,c=1/0,l=-1/0,f=-1/0;for(r=0;r<o;++r)isNaN(n=+this._x.call(null,t=e[r]))||isNaN(i=+this._y.call(null,t))||(a[r]=n,s[r]=i,n<u&&(u=n),n>l&&(l=n),i<c&&(c=i),i>f&&(f=i));for(l<u&&(u=this._x0,l=this._x1),f<c&&(c=this._y0,f=this._y1),this.cover(u,c).cover(l,f),r=0;r<o;++r)add(this,a[r],s[r],e[r]);return this}function tree_cover(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var r=this._x0,n=this._y0,i=this._x1,o=this._y1;if(isNaN(r))i=(r=Math.floor(e))+1,o=(n=Math.floor(t))+1;else{if(!(r>e||e>i||n>t||t>o))return this;var a,s,u=i-r,c=this._root;switch(s=(t<(n+o)/2)<<1|e<(r+i)/2){case 0:do{a=new Array(4),a[s]=c,c=a}while(o=n+(u*=2),e>(i=r+u)||t>o);break;case 1:do{a=new Array(4),a[s]=c,c=a}while(o=n+(u*=2),(r=i-u)>e||t>o);break;case 2:do{a=new Array(4),a[s]=c,c=a}while(n=o-(u*=2),e>(i=r+u)||n>t);break;case 3:do{a=new Array(4),a[s]=c,c=a}while(n=o-(u*=2),(r=i-u)>e||n>t)}this._root&&this._root.length&&(this._root=c)}return this._x0=r,this._y0=n,this._x1=i,this._y1=o,this}function tree_data(){var e=[];return this.visit(function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)}),e}function tree_extent(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Quad(e,t,r,n,i){this.node=e,this.x0=t,this.y0=r,this.x1=n,this.y1=i}function tree_find(e,t,r){var n,i,o,a,s,u,c,l=this._x0,f=this._y0,d=this._x1,h=this._y1,p=[],m=this._root;for(m&&p.push(new Quad(m,l,f,d,h)),null==r?r=1/0:(l=e-r,f=t-r,d=e+r,h=t+r,r*=r);u=p.pop();)if(!(!(m=u.node)||(i=u.x0)>d||(o=u.y0)>h||(a=u.x1)<l||(s=u.y1)<f))if(m.length){var g=(i+a)/2,y=(o+s)/2;p.push(new Quad(m[3],g,y,a,s),new Quad(m[2],i,y,g,s),new Quad(m[1],g,o,a,y),new Quad(m[0],i,o,g,y)),(c=(t>=y)<<1|e>=g)&&(u=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=u)}else{var b=e-+this._x.call(null,m.data),v=t-+this._y.call(null,m.data),_=b*b+v*v;if(_<r){var w=Math.sqrt(r=_);l=e-w,f=t-w,d=e+w,h=t+w,n=m.data}}return n}function tree_remove(e){if(isNaN(o=+this._x.call(null,e))||isNaN(a=+this._y.call(null,e)))return this;var t,r,n,i,o,a,s,u,c,l,f,d,h=this._root,p=this._x0,m=this._y0,g=this._x1,y=this._y1;if(!h)return this;if(h.length)for(;;){if((c=o>=(s=(p+g)/2))?p=s:g=s,(l=a>=(u=(m+y)/2))?m=u:y=u,t=h,!(h=h[f=l<<1|c]))return this;if(!h.length)break;(t[f+1&3]||t[f+2&3]||t[f+3&3])&&(r=t,d=f)}for(;h.data!==e;)if(n=h,!(h=h.next))return this;return(i=h.next)&&delete h.next,n?(i?n.next=i:delete n.next,this):t?(i?t[f]=i:delete t[f],(h=t[0]||t[1]||t[2]||t[3])&&h===(t[3]||t[2]||t[1]||t[0])&&!h.length&&(r?r[d]=h:this._root=h),this):(this._root=i,this)}function removeAll(e){for(var t=0,r=e.length;t<r;++t)this.remove(e[t]);return this}function tree_root(){return this._root}function tree_size(){var e=0;return this.visit(function(t){if(!t.length)do{++e}while(t=t.next)}),e}function tree_visit(e){var t,r,n,i,o,a,s=[],u=this._root;for(u&&s.push(new Quad(u,this._x0,this._y0,this._x1,this._y1));t=s.pop();)if(!e(u=t.node,n=t.x0,i=t.y0,o=t.x1,a=t.y1)&&u.length){var c=(n+o)/2,l=(i+a)/2;(r=u[3])&&s.push(new Quad(r,c,l,o,a)),(r=u[2])&&s.push(new Quad(r,n,l,c,a)),(r=u[1])&&s.push(new Quad(r,c,i,o,l)),(r=u[0])&&s.push(new Quad(r,n,i,c,l))}return this}function tree_visitAfter(e){var t,r=[],n=[];for(this._root&&r.push(new Quad(this._root,this._x0,this._y0,this._x1,this._y1));t=r.pop();){var i=t.node;if(i.length){var o,a=t.x0,s=t.y0,u=t.x1,c=t.y1,l=(a+u)/2,f=(s+c)/2;(o=i[0])&&r.push(new Quad(o,a,s,l,f)),(o=i[1])&&r.push(new Quad(o,l,s,u,f)),(o=i[2])&&r.push(new Quad(o,a,f,l,c)),(o=i[3])&&r.push(new Quad(o,l,f,u,c))}n.push(t)}for(;t=n.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this}function defaultX(e){return e[0]}function tree_x(e){return arguments.length?(this._x=e,this):this._x}function defaultY(e){return e[1]}function tree_y(e){return arguments.length?(this._y=e,this):this._y}function quadtree(e,t,r){var n=new Quadtree(null==t?defaultX:t,null==r?defaultY:r,NaN,NaN,NaN,NaN);return null==e?n:n.addAll(e)}function Quadtree(e,t,r,n,i,o){this._x=e,this._y=t,this._x0=r,this._y0=n,this._x1=i,this._y1=o,this._root=void 0}function leaf_copy(e){for(var t={data:e.data},r=t;e=e.next;)r=r.next={data:e.data};return t}var treeProto=quadtree.prototype=Quadtree.prototype;treeProto.copy=function(){var e,t,r=new Quadtree(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=leaf_copy(n),r;for(e=[{source:n,target:r._root=new Array(4)}];n=e.pop();)for(var i=0;i<4;++i)(t=n.source[i])&&(t.length?e.push({source:t,target:n.target[i]=new Array(4)}):n.target[i]=leaf_copy(t));return r},treeProto.add=tree_add,treeProto.addAll=addAll,treeProto.cover=tree_cover,treeProto.data=tree_data,treeProto.extent=tree_extent,treeProto.find=tree_find,treeProto.remove=tree_remove,treeProto.removeAll=removeAll,treeProto.root=tree_root,treeProto.size=tree_size,treeProto.visit=tree_visit,treeProto.visitAfter=tree_visitAfter,treeProto.x=tree_x,treeProto.y=tree_y;var initialAngle=Math.PI*(3-Math.sqrt(5)),prefixExponent;function formatDecimal(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function exponent$1(e){return(e=formatDecimal(Math.abs(e)))?e[1]:NaN}function formatGroup(e,t){return function(r,n){for(var i=r.length,o=[],a=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>n&&(s=Math.max(1,n-u)),o.push(r.substring(i-=s,i+s)),!((u+=s+1)>n));)s=e[a=(a+1)%e.length];return o.reverse().join(t)}}function formatNumerals(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}function formatDefault(e,t){e=e.toPrecision(t);e:for(var r,n=e.length,i=1,o=-1;i<n;++i)switch(e[i]){case".":o=r=i;break;case"0":0===o&&(o=i),r=i;break;case"e":break e;default:o>0&&(o=0)}return o>0?e.slice(0,o)+e.slice(r+1):e}function formatPrefixAuto(e,t){var r=formatDecimal(e,t);if(!r)return e+"";var n=r[0],i=r[1],o=i-(prefixExponent=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=n.length;return o===a?n:o>a?n+new Array(o-a+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+formatDecimal(e,Math.max(0,t+o-1))[0]}function formatRounded(e,t){var r=formatDecimal(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}var formatTypes={"":formatDefault,"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return formatRounded(100*e,t)},r:formatRounded,s:formatPrefixAuto,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}},re=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;function formatSpecifier(e){return new FormatSpecifier(e)}function FormatSpecifier(e){if(!(t=re.exec(e)))throw new Error("invalid format: "+e);var t,r=t[1]||" ",n=t[2]||">",i=t[3]||"-",o=t[4]||"",a=!!t[5],s=t[6]&&+t[6],u=!!t[7],c=t[8]&&+t[8].slice(1),l=t[9]||"";"n"===l?(u=!0,l="g"):formatTypes[l]||(l=""),(a||"0"===r&&"="===n)&&(a=!0,r="0",n="="),this.fill=r,this.align=n,this.sign=i,this.symbol=o,this.zero=a,this.width=s,this.comma=u,this.precision=c,this.type=l}function identity$3(e){return e}formatSpecifier.prototype=FormatSpecifier.prototype,FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var prefixes=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],locale,format,formatPrefix;function formatLocale(e){var t=e.grouping&&e.thousands?formatGroup(e.grouping,e.thousands):identity$3,r=e.currency,n=e.decimal,i=e.numerals?formatNumerals(e.numerals):identity$3,o=e.percent||"%";function a(e){var a=(e=formatSpecifier(e)).fill,s=e.align,u=e.sign,c=e.symbol,l=e.zero,f=e.width,d=e.comma,h=e.precision,p=e.type,m="$"===c?r[0]:"#"===c&&/[boxX]/.test(p)?"0"+p.toLowerCase():"",g="$"===c?r[1]:/[%p]/.test(p)?o:"",y=formatTypes[p],b=!p||/[defgprs%]/.test(p);function v(e){var r,o,c,v=m,_=g;if("c"===p)_=y(e)+_,e="";else{var w=(e=+e)<0;if(e=y(Math.abs(e),h),w&&0==+e&&(w=!1),v=(w?"("===u?u:"-":"-"===u||"("===u?"":u)+v,_=_+("s"===p?prefixes[8+prefixExponent/3]:"")+(w&&"("===u?")":""),b)for(r=-1,o=e.length;++r<o;)if(48>(c=e.charCodeAt(r))||c>57){_=(46===c?n+e.slice(r+1):e.slice(r))+_,e=e.slice(0,r);break}}d&&!l&&(e=t(e,1/0));var E=v.length+e.length+_.length,$=E<f?new Array(f-E+1).join(a):"";switch(d&&l&&(e=t($+e,$.length?f-_.length:1/0),$=""),s){case"<":e=v+e+_+$;break;case"=":e=v+$+e+_;break;case"^":e=$.slice(0,E=$.length>>1)+v+e+_+$.slice(E);break;default:e=$+v+e+_}return i(e)}return h=null==h?p?6:12:/[gprs]/.test(p)?Math.max(1,Math.min(21,h)):Math.max(0,Math.min(20,h)),v.toString=function(){return e+""},v}return{format:a,formatPrefix:function(e,t){var r=a(((e=formatSpecifier(e)).type="f",e)),n=3*Math.max(-8,Math.min(8,Math.floor(exponent$1(t)/3))),i=Math.pow(10,-n),o=prefixes[8+n/3];return function(e){return r(i*e)+o}}}}function defaultLocale(e){return locale=formatLocale(e),format=locale.format,formatPrefix=locale.formatPrefix,locale}function adder(){return new Adder}function Adder(){this.reset()}defaultLocale({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),Adder.prototype={constructor:Adder,reset:function(){this.s=this.t=0},add:function(e){add$1(temp,e,this.t),add$1(this,temp.s,this.s),this.s?this.t+=temp.t:this.s=temp.t},valueOf:function(){return this.s}};var temp=new Adder;function add$1(e,t,r){var n=e.s=t+r,i=n-t,o=n-i;e.t=t-o+(r-i)}var pi$3=Math.PI,areaRingSum=adder(),areaSum=adder(),deltaSum=adder(),sum$1=adder(),lengthSum=adder(),areaSum$1=adder(),areaRingSum$1=adder(),lengthSum$1=adder(),t0$1=new Date,t1$1=new Date;function newInterval(e,t,r,n){function i(t){return e(t=new Date(+t)),t}return i.floor=i,i.ceil=function(r){return e(r=new Date(r-1)),t(r,1),e(r),r},i.round=function(e){var t=i(e),r=i.ceil(e);return e-t<r-e?t:r},i.offset=function(e,r){return t(e=new Date(+e),null==r?1:Math.floor(r)),e},i.range=function(r,n,o){var a,s=[];if(r=i.ceil(r),o=null==o?1:Math.floor(o),!(r<n&&o>0))return s;do{s.push(a=new Date(+r)),t(r,o),e(r)}while(a<r&&r<n);return s},i.filter=function(r){return newInterval(function(t){if(t>=t)for(;e(t),!r(t);)t.setTime(t-1)},function(e,n){if(e>=e)if(n<0)for(;++n<=0;)for(;t(e,-1),!r(e););else for(;--n>=0;)for(;t(e,1),!r(e););})},r&&(i.count=function(t,n){return t0$1.setTime(+t),t1$1.setTime(+n),e(t0$1),e(t1$1),Math.floor(r(t0$1,t1$1))},i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(n?function(t){return n(t)%e==0}:function(t){return i.count(0,t)%e==0}):i:null}),i}var millisecond=newInterval(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});millisecond.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?newInterval(function(t){t.setTime(Math.floor(t/e)*e)},function(t,r){t.setTime(+t+r*e)},function(t,r){return(r-t)/e}):millisecond:null};var durationSecond$1=1e3,durationMinute$1=6e4,durationHour$1=36e5,durationDay$1=864e5,durationWeek$1=6048e5,second=newInterval(function(e){e.setTime(Math.floor(e/durationSecond$1)*durationSecond$1)},function(e,t){e.setTime(+e+t*durationSecond$1)},function(e,t){return(t-e)/durationSecond$1},function(e){return e.getUTCSeconds()}),minute=newInterval(function(e){e.setTime(Math.floor(e/durationMinute$1)*durationMinute$1)},function(e,t){e.setTime(+e+t*durationMinute$1)},function(e,t){return(t-e)/durationMinute$1},function(e){return e.getMinutes()}),hour=newInterval(function(e){var t=e.getTimezoneOffset()*durationMinute$1%durationHour$1;t<0&&(t+=durationHour$1),e.setTime(Math.floor((+e-t)/durationHour$1)*durationHour$1+t)},function(e,t){e.setTime(+e+t*durationHour$1)},function(e,t){return(t-e)/durationHour$1},function(e){return e.getHours()}),day=newInterval(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*durationMinute$1)/durationDay$1},function(e){return e.getDate()-1});function weekday(e){return newInterval(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*durationMinute$1)/durationWeek$1})}var sunday=weekday(0),monday=weekday(1),tuesday=weekday(2),wednesday=weekday(3),thursday=weekday(4),friday=weekday(5),saturday=weekday(6),month=newInterval(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),year=newInterval(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});year.every=function(e){return isFinite(e=Math.floor(e))&&e>0?newInterval(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,r){t.setFullYear(t.getFullYear()+r*e)}):null};var utcMinute=newInterval(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*durationMinute$1)},function(e,t){return(t-e)/durationMinute$1},function(e){return e.getUTCMinutes()}),utcHour=newInterval(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*durationHour$1)},function(e,t){return(t-e)/durationHour$1},function(e){return e.getUTCHours()}),utcDay=newInterval(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/durationDay$1},function(e){return e.getUTCDate()-1});function utcWeekday(e){return newInterval(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/durationWeek$1})}var utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6),utcMonth=newInterval(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),utcYear=newInterval(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});function localDate(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function utcDate(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function newYear(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}function formatLocale$1(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,c=formatRe(i),l=formatLookup(i),f=formatRe(o),d=formatLookup(o),h=formatRe(a),p=formatLookup(a),m=formatRe(s),g=formatLookup(s),y=formatRe(u),b=formatLookup(u),v={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:function(e){return i[+(e.getHours()>=12)]},Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},_={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return u[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:function(e){return i[+(e.getUTCHours()>=12)]},Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},w={a:function(e,t,r){var n=h.exec(t.slice(r));return n?(e.w=p[n[0].toLowerCase()],r+n[0].length):-1},A:function(e,t,r){var n=f.exec(t.slice(r));return n?(e.w=d[n[0].toLowerCase()],r+n[0].length):-1},b:function(e,t,r){var n=y.exec(t.slice(r));return n?(e.m=b[n[0].toLowerCase()],r+n[0].length):-1},B:function(e,t,r){var n=m.exec(t.slice(r));return n?(e.m=g[n[0].toLowerCase()],r+n[0].length):-1},c:function(e,r,n){return S(e,t,r,n)},d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:function(e,t,r){var n=c.exec(t.slice(r));return n?(e.p=l[n[0].toLowerCase()],r+n[0].length):-1},Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:function(e,t,n){return S(e,r,t,n)},X:function(e,t,r){return S(e,n,t,r)},y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};function E(e,t){return function(r){var n,i,o,a=[],s=-1,u=0,c=e.length;for(r instanceof Date||(r=new Date(+r));++s<c;)37===e.charCodeAt(s)&&(a.push(e.slice(u,s)),null!=(i=pads[n=e.charAt(++s)])?n=e.charAt(++s):i="e"===n?" ":"0",(o=t[n])&&(n=o(r,i)),a.push(n),u=s+1);return a.push(e.slice(u,s)),a.join("")}}function $(e,t){return function(r){var n,i,o=newYear(1900);if(S(o,e,r+="",0)!=r.length)return null;if("Q"in o)return new Date(o.Q);if("p"in o&&(o.H=o.H%12+12*o.p),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(n=(i=(n=utcDate(newYear(o.y))).getUTCDay())>4||0===i?utcMonday.ceil(n):utcMonday(n),n=utcDay.offset(n,7*(o.V-1)),o.y=n.getUTCFullYear(),o.m=n.getUTCMonth(),o.d=n.getUTCDate()+(o.w+6)%7):(n=(i=(n=t(newYear(o.y))).getDay())>4||0===i?monday.ceil(n):monday(n),n=day.offset(n,7*(o.V-1)),o.y=n.getFullYear(),o.m=n.getMonth(),o.d=n.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?utcDate(newYear(o.y)).getUTCDay():t(newYear(o.y)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,utcDate(o)):t(o)}}function S(e,t,r,n){for(var i,o,a=0,s=t.length,u=r.length;a<s;){if(n>=u)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=w[i in pads?t.charAt(a++):i])||(n=o(e,r,n))<0)return-1}else if(i!=r.charCodeAt(n++))return-1}return n}return v.x=E(r,v),v.X=E(n,v),v.c=E(t,v),_.x=E(r,_),_.X=E(n,_),_.c=E(t,_),{format:function(e){var t=E(e+="",v);return t.toString=function(){return e},t},parse:function(e){var t=$(e+="",localDate);return t.toString=function(){return e},t},utcFormat:function(e){var t=E(e+="",_);return t.toString=function(){return e},t},utcParse:function(e){var t=$(e,utcDate);return t.toString=function(){return e},t}}}utcYear.every=function(e){return isFinite(e=Math.floor(e))&&e>0?newInterval(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,r){t.setUTCFullYear(t.getUTCFullYear()+r*e)}):null};var pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\^$*+?|[\]().{}]/g,locale$1,timeFormat,timeParse,utcFormat,utcParse;function pad(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",o=i.length;return n+(o<r?new Array(r-o+1).join(t)+i:i)}function requote(e){return e.replace(requoteRe,"\\$&")}function formatRe(e){return new RegExp("^(?:"+e.map(requote).join("|")+")","i")}function formatLookup(e){for(var t={},r=-1,n=e.length;++r<n;)t[e[r].toLowerCase()]=r;return t}function parseWeekdayNumberSunday(e,t,r){var n=numberRe.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function parseWeekdayNumberMonday(e,t,r){var n=numberRe.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function parseWeekNumberSunday(e,t,r){var n=numberRe.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function parseWeekNumberISO(e,t,r){var n=numberRe.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function parseWeekNumberMonday(e,t,r){var n=numberRe.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function parseFullYear(e,t,r){var n=numberRe.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function parseYear(e,t,r){var n=numberRe.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function parseZone(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function parseMonthNumber(e,t,r){var n=numberRe.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function parseDayOfMonth(e,t,r){var n=numberRe.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function parseDayOfYear(e,t,r){var n=numberRe.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function parseHour24(e,t,r){var n=numberRe.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function parseMinutes(e,t,r){var n=numberRe.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function parseSeconds(e,t,r){var n=numberRe.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function parseMilliseconds(e,t,r){var n=numberRe.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function parseMicroseconds(e,t,r){var n=numberRe.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function parseLiteralPercent(e,t,r){var n=percentRe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function parseUnixTimestamp(e,t,r){var n=numberRe.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function parseUnixTimestampSeconds(e,t,r){var n=numberRe.exec(t.slice(r));return n?(e.Q=1e3*+n[0],r+n[0].length):-1}function formatDayOfMonth(e,t){return pad(e.getDate(),t,2)}function formatHour24(e,t){return pad(e.getHours(),t,2)}function formatHour12(e,t){return pad(e.getHours()%12||12,t,2)}function formatDayOfYear(e,t){return pad(1+day.count(year(e),e),t,3)}function formatMilliseconds(e,t){return pad(e.getMilliseconds(),t,3)}function formatMicroseconds(e,t){return formatMilliseconds(e,t)+"000"}function formatMonthNumber(e,t){return pad(e.getMonth()+1,t,2)}function formatMinutes(e,t){return pad(e.getMinutes(),t,2)}function formatSeconds(e,t){return pad(e.getSeconds(),t,2)}function formatWeekdayNumberMonday(e){var t=e.getDay();return 0===t?7:t}function formatWeekNumberSunday(e,t){return pad(sunday.count(year(e),e),t,2)}function formatWeekNumberISO(e,t){var r=e.getDay();return e=r>=4||0===r?thursday(e):thursday.ceil(e),pad(thursday.count(year(e),e)+(4===year(e).getDay()),t,2)}function formatWeekdayNumberSunday(e){return e.getDay()}function formatWeekNumberMonday(e,t){return pad(monday.count(year(e),e),t,2)}function formatYear(e,t){return pad(e.getFullYear()%100,t,2)}function formatFullYear(e,t){return pad(e.getFullYear()%1e4,t,4)}function formatZone(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+pad(t/60|0,"0",2)+pad(t%60,"0",2)}function formatUTCDayOfMonth(e,t){return pad(e.getUTCDate(),t,2)}function formatUTCHour24(e,t){return pad(e.getUTCHours(),t,2)}function formatUTCHour12(e,t){return pad(e.getUTCHours()%12||12,t,2)}function formatUTCDayOfYear(e,t){return pad(1+utcDay.count(utcYear(e),e),t,3)}function formatUTCMilliseconds(e,t){return pad(e.getUTCMilliseconds(),t,3)}function formatUTCMicroseconds(e,t){return formatUTCMilliseconds(e,t)+"000"}function formatUTCMonthNumber(e,t){return pad(e.getUTCMonth()+1,t,2)}function formatUTCMinutes(e,t){return pad(e.getUTCMinutes(),t,2)}function formatUTCSeconds(e,t){return pad(e.getUTCSeconds(),t,2)}function formatUTCWeekdayNumberMonday(e){var t=e.getUTCDay();return 0===t?7:t}function formatUTCWeekNumberSunday(e,t){return pad(utcSunday.count(utcYear(e),e),t,2)}function formatUTCWeekNumberISO(e,t){var r=e.getUTCDay();return e=r>=4||0===r?utcThursday(e):utcThursday.ceil(e),pad(utcThursday.count(utcYear(e),e)+(4===utcYear(e).getUTCDay()),t,2)}function formatUTCWeekdayNumberSunday(e){return e.getUTCDay()}function formatUTCWeekNumberMonday(e,t){return pad(utcMonday.count(utcYear(e),e),t,2)}function formatUTCYear(e,t){return pad(e.getUTCFullYear()%100,t,2)}function formatUTCFullYear(e,t){return pad(e.getUTCFullYear()%1e4,t,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(e){return+e}function formatUnixTimestampSeconds(e){return Math.floor(+e/1e3)}function defaultLocale$1(e){return locale$1=formatLocale$1(e),timeFormat=locale$1.format,timeParse=locale$1.parse,utcFormat=locale$1.utcFormat,utcParse=locale$1.utcParse,locale$1}defaultLocale$1({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var isoSpecifier="%Y-%m-%dT%H:%M:%S.%LZ";function formatIsoNative(e){return e.toISOString()}var formatIso=Date.prototype.toISOString?formatIsoNative:utcFormat(isoSpecifier);function parseIsoNative(e){var t=new Date(e);return isNaN(t)?null:t}var parseIso=+new Date("2000-01-01T00:00:00.000Z")?parseIsoNative:utcParse(isoSpecifier);function colors(e){return e.match(/.{6}/g).map(function(e){return"#"+e})}colors("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),colors("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),colors("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),colors("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),cubehelixLong(cubehelix(300,.5,0),cubehelix(-240,.5,1));var warm=cubehelixLong(cubehelix(-100,.75,.35),cubehelix(80,1.5,.8)),cool=cubehelixLong(cubehelix(260,.75,.35),cubehelix(80,1.5,.8)),rainbow=cubehelix();function ramp(e){var t=e.length;return function(r){return e[Math.max(0,Math.min(t-1,Math.floor(r*t)))]}}ramp(colors("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var magma=ramp(colors("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),inferno=ramp(colors("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),plasma=ramp(colors("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),pi$4=Math.PI;function sign$1(e){return e<0?-1:1}function slope3(e,t,r){var n=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(n||i<0&&-0),a=(r-e._y1)/(i||n<0&&-0),s=(o*i+a*n)/(n+i);return(sign$1(o)+sign$1(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function slope2(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function point$5(e,t,r){var n=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-n)/3;e._context.bezierCurveTo(n+s,i+s*t,o-s,a-s*r,o,a)}function MonotoneX(e){this._context=e}function MonotoneY(e){this._context=new ReflectContext(e)}function ReflectContext(e){this._context=e}MonotoneX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:point$5(this,this._t0,slope2(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,point$5(this,slope2(this,r=slope3(this,e,t)),r);break;default:point$5(this,this._t0,r=slope3(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}},(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(e,t){MonotoneX.prototype.point.call(this,t,e)},ReflectContext.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,o){this._context.bezierCurveTo(t,e,n,r,o,i)}};var fs={},empty$2=Object.freeze({default:fs}),fs$1=empty$2&&fs||empty$2,rb=fs$1.randomBytes;function rng(){return rb(16)}for(var rng_1=rng,byteToHex=[],i=0;i<256;++i)byteToHex[i]=(i+256).toString(16).substr(1);function bytesToUuid(e,t){var r=t||0,n=byteToHex;return n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]}var bytesToUuid_1=bytesToUuid,_seedBytes=rng_1(),_nodeId=[1|_seedBytes[0],_seedBytes[1],_seedBytes[2],_seedBytes[3],_seedBytes[4],_seedBytes[5]],_clockseq=16383&(_seedBytes[6]<<8|_seedBytes[7]),_lastMSecs=0,_lastNSecs=0;function v1(e,t,r){var n=t&&r||0,i=t||[],o=void 0!==(e=e||{}).clockseq?e.clockseq:_clockseq,a=void 0!==e.msecs?e.msecs:(new Date).getTime(),s=void 0!==e.nsecs?e.nsecs:_lastNSecs+1,u=a-_lastMSecs+(s-_lastNSecs)/1e4;if(u<0&&void 0===e.clockseq&&(o=o+1&16383),(u<0||a>_lastMSecs)&&void 0===e.nsecs&&(s=0),s>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=a,_lastNSecs=s,_clockseq=o;var c=(1e4*(268435455&(a+=122192928e5))+s)%4294967296;i[n++]=c>>>24&255,i[n++]=c>>>16&255,i[n++]=c>>>8&255,i[n++]=255&c;var l=a/4294967296*1e4&268435455;i[n++]=l>>>8&255,i[n++]=255&l,i[n++]=l>>>24&15|16,i[n++]=l>>>16&255,i[n++]=o>>>8|128,i[n++]=255&o;for(var f=e.node||_nodeId,d=0;d<6;++d)i[n+d]=f[d];return t||bytesToUuid_1(i)}var v1_1=v1;function v4(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||rng_1)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[n+o]=i[o];return t||bytesToUuid_1(i)}var v4_1=v4,uuid$1=v4_1;uuid$1.v1=v1_1,uuid$1.v4=v4_1;var uuid_1=uuid$1,commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var Mutation=commonjsGlobal.MutationObserver||commonjsGlobal.WebKitMutationObserver,scheduleDrain,draining;if(process.browser)if(Mutation){var called=0,observer=new Mutation(nextTick$1),element$2=commonjsGlobal.document.createTextNode("");observer.observe(element$2,{characterData:!0}),scheduleDrain=function(){element$2.data=called=++called%2}}else if(commonjsGlobal.setImmediate||void 0===commonjsGlobal.MessageChannel)scheduleDrain="document"in commonjsGlobal&&"onreadystatechange"in commonjsGlobal.document.createElement("script")?function(){var e=commonjsGlobal.document.createElement("script");e.onreadystatechange=function(){nextTick$1(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},commonjsGlobal.document.documentElement.appendChild(e)}:function(){setTimeout(nextTick$1,0)};else{var channel=new commonjsGlobal.MessageChannel;channel.port1.onmessage=nextTick$1,scheduleDrain=function(){channel.port2.postMessage(0)}}else scheduleDrain=function(){process.nextTick(nextTick$1)};var queue$1=[];function nextTick$1(){var e,t;draining=!0;for(var r=queue$1.length;r;){for(t=queue$1,queue$1=[],e=-1;++e<r;)t[e]();r=queue$1.length}draining=!1}var lib$1=immediate;function immediate(e){1!==queue$1.push(e)||draining||scheduleDrain()}function INTERNAL(){}var handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"];if(!process.browser)var UNHANDLED=["UNHANDLED"];var lib=Promise$1;function Promise$1(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,process.browser||(this.handled=UNHANDLED),e!==INTERNAL&&safelyResolveThenable(this,e)}function QueueItem(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function unwrap(e,t,r){lib$1(function(){var n;try{n=t(r)}catch(t){return handlers.reject(e,t)}n===e?handlers.reject(e,new TypeError("Cannot resolve promise with itself")):handlers.resolve(e,n)})}function getThen(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function safelyResolveThenable(e,t){var r=!1;function n(t){r||(r=!0,handlers.reject(e,t))}function i(t){r||(r=!0,handlers.resolve(e,t))}var o=tryCatch(function(){t(i,n)});"error"===o.status&&n(o.value)}function tryCatch(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}function resolve(e){return e instanceof this?e:handlers.resolve(new this(INTERNAL),e)}function reject(e){var t=new this(INTERNAL);return handlers.reject(t,e)}function all(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var i=new Array(r),o=0,a=-1,s=new this(INTERNAL);++a<r;)u(e[a],a);return s;function u(e,a){t.resolve(e).then(function(e){i[a]=e,++o!==r||n||(n=!0,handlers.resolve(s,i))},function(e){n||(n=!0,handlers.reject(s,e))})}}function race(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var i,o=-1,a=new this(INTERNAL);++o<r;)i=e[o],t.resolve(i).then(function(e){n||(n=!0,handlers.resolve(a,e))},function(e){n||(n=!0,handlers.reject(a,e))});return a}Promise$1.prototype.catch=function(e){return this.then(null,e)},Promise$1.prototype.then=function(e,t){if("function"!=typeof e&&this.state===FULFILLED||"function"!=typeof t&&this.state===REJECTED)return this;var r=new this.constructor(INTERNAL);(process.browser||this.handled===UNHANDLED&&(this.handled=null),this.state!==PENDING)?unwrap(r,this.state===FULFILLED?e:t,this.outcome):this.queue.push(new QueueItem(r,e,t));return r},QueueItem.prototype.callFulfilled=function(e){handlers.resolve(this.promise,e)},QueueItem.prototype.otherCallFulfilled=function(e){unwrap(this.promise,this.onFulfilled,e)},QueueItem.prototype.callRejected=function(e){handlers.reject(this.promise,e)},QueueItem.prototype.otherCallRejected=function(e){unwrap(this.promise,this.onRejected,e)},handlers.resolve=function(e,t){var r=tryCatch(getThen,t);if("error"===r.status)return handlers.reject(e,r.value);var n=r.value;if(n)safelyResolveThenable(e,n);else{e.state=FULFILLED,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},handlers.reject=function(e,t){e.state=REJECTED,e.outcome=t,process.browser||e.handled===UNHANDLED&&lib$1(function(){e.handled===UNHANDLED&&process.emit("unhandledRejection",t,e)});for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},Promise$1.resolve=resolve,Promise$1.reject=reject,Promise$1.all=all,Promise$1.race=race;var argsarray=argsArray;function argsArray(e){return function(){var t=arguments.length;if(t){for(var r=[],n=-1;++n<t;)r[n]=arguments[n];return e.call(this,r)}return e.call(this,[])}}var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,inited=!1;function init$1(){inited=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,r=e.length;t<r;++t)lookup[t]=e[t],revLookup[e.charCodeAt(t)]=t;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63}function toByteArray(e){var t,r,n,i,o,a;inited||init$1();var s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[s-2]?2:"="===e[s-1]?1:0,a=new Arr(3*s/4-o),n=o>0?s-4:s;var u=0;for(t=0,r=0;t<n;t+=4,r+=3)i=revLookup[e.charCodeAt(t)]<<18|revLookup[e.charCodeAt(t+1)]<<12|revLookup[e.charCodeAt(t+2)]<<6|revLookup[e.charCodeAt(t+3)],a[u++]=i>>16&255,a[u++]=i>>8&255,a[u++]=255&i;return 2===o?(i=revLookup[e.charCodeAt(t)]<<2|revLookup[e.charCodeAt(t+1)]>>4,a[u++]=255&i):1===o&&(i=revLookup[e.charCodeAt(t)]<<10|revLookup[e.charCodeAt(t+1)]<<4|revLookup[e.charCodeAt(t+2)]>>2,a[u++]=i>>8&255,a[u++]=255&i),a}function tripletToBase64(e){return lookup[e>>18&63]+lookup[e>>12&63]+lookup[e>>6&63]+lookup[63&e]}function encodeChunk(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16)+(e[o+1]<<8)+e[o+2],i.push(tripletToBase64(n));return i.join("")}function fromByteArray(e){var t;inited||init$1();for(var r=e.length,n=r%3,i="",o=[],a=0,s=r-n;a<s;a+=16383)o.push(encodeChunk(e,a,a+16383>s?s:a+16383));return 1===n?(t=e[r-1],i+=lookup[t>>2],i+=lookup[t<<4&63],i+="=="):2===n&&(t=(e[r-2]<<8)+e[r-1],i+=lookup[t>>10],i+=lookup[t>>4&63],i+=lookup[t<<2&63],i+="="),o.push(i),o.join("")}function read(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,c=u>>1,l=-7,f=r?i-1:0,d=r?-1:1,h=e[t+f];for(f+=d,o=h&(1<<-l)-1,h>>=-l,l+=s;l>0;o=256*o+e[t+f],f+=d,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=n;l>0;a=256*a+e[t+f],f+=d,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,n),o-=c}return(h?-1:1)*a*Math.pow(2,o-n)}function write(e,t,r,n,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:o-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+f>=1?d/u:d*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*u-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[r+h]=255&s,h+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+h]=255&a,h+=p,a/=256,c-=8);e[r+h-p]|=128*m}var toString={}.toString,isArray=Array.isArray||function(e){return"[object Array]"==toString.call(e)},INSPECT_MAX_BYTES=50;Buffer$2.TYPED_ARRAY_SUPPORT=void 0===global.TYPED_ARRAY_SUPPORT||global.TYPED_ARRAY_SUPPORT;var _kMaxLength=kMaxLength();function kMaxLength(){return Buffer$2.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(e,t){if(kMaxLength()<t)throw new RangeError("Invalid typed array length");return Buffer$2.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=Buffer$2.prototype:(null===e&&(e=new Buffer$2(t)),e.length=t),e}function Buffer$2(e,t,r){if(!(Buffer$2.TYPED_ARRAY_SUPPORT||this instanceof Buffer$2))return new Buffer$2(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,e)}return from(this,e,t,r)}function from(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?fromArrayBuffer(e,t,r,n):"string"==typeof t?fromString(e,t,r):fromObject(e,t)}function assertSize(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function alloc(e,t,r,n){return assertSize(t),t<=0?createBuffer(e,t):void 0!==r?"string"==typeof n?createBuffer(e,t).fill(r,n):createBuffer(e,t).fill(r):createBuffer(e,t)}function allocUnsafe(e,t){if(assertSize(t),e=createBuffer(e,t<0?0:0|checked(t)),!Buffer$2.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function fromString(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!Buffer$2.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|byteLength(t,r),i=(e=createBuffer(e,n)).write(t,r);return i!==n&&(e=e.slice(0,i)),e}function fromArrayLike(e,t){var r=t.length<0?0:0|checked(t.length);e=createBuffer(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function fromArrayBuffer(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),Buffer$2.TYPED_ARRAY_SUPPORT?(e=t).__proto__=Buffer$2.prototype:e=fromArrayLike(e,t),e}function fromObject(e,t){if(internalIsBuffer(t)){var r=0|checked(t.length);return 0===(e=createBuffer(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||isnan(t.length)?createBuffer(e,0):fromArrayLike(e,t);if("Buffer"===t.type&&isArray(t.data))return fromArrayLike(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(e){if(e>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|e}function SlowBuffer(e){return+e!=e&&(e=0),Buffer$2.alloc(+e)}function internalIsBuffer(e){return!(null==e||!e._isBuffer)}function byteLength(e,t){if(internalIsBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return utf8ToBytes(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return base64ToBytes(e).length;default:if(n)return utf8ToBytes(e).length;t=(""+t).toLowerCase(),n=!0}}function slowToString(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return hexSlice(this,t,r);case"utf8":case"utf-8":return utf8Slice(this,t,r);case"ascii":return asciiSlice(this,t,r);case"latin1":case"binary":return latin1Slice(this,t,r);case"base64":return base64Slice(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function swap(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function bidirectionalIndexOf(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=Buffer$2.from(t,n)),internalIsBuffer(t))return 0===t.length?-1:arrayIndexOf(e,t,r,n,i);if("number"==typeof t)return t&=255,Buffer$2.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):arrayIndexOf(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(e,t,r,n,i){var o,a=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(r+u>s&&(r=s-u),o=r;o>=0;o--){for(var f=!0,d=0;d<u;d++)if(c(e,o+d)!==c(t,d)){f=!1;break}if(f)return o}return-1}function hexWrite(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s}return a}function utf8Write(e,t,r,n){return blitBuffer(utf8ToBytes(t,e.length-r),e,r,n)}function asciiWrite(e,t,r,n){return blitBuffer(asciiToBytes(t),e,r,n)}function latin1Write(e,t,r,n){return asciiWrite(e,t,r,n)}function base64Write(e,t,r,n){return blitBuffer(base64ToBytes(t),e,r,n)}function ucs2Write(e,t,r,n){return blitBuffer(utf16leToBytes(t,e.length-r),e,r,n)}function base64Slice(e,t,r){return 0===t&&r===e.length?fromByteArray(e):fromByteArray(e.slice(t,r))}function utf8Slice(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,u,c=e[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=r)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=f}return decodeCodePointsArray(n)}Buffer$2.poolSize=8192,Buffer$2._augment=function(e){return e.__proto__=Buffer$2.prototype,e},Buffer$2.from=function(e,t,r){return from(null,e,t,r)},Buffer$2.TYPED_ARRAY_SUPPORT&&(Buffer$2.prototype.__proto__=Uint8Array.prototype,Buffer$2.__proto__=Uint8Array),Buffer$2.alloc=function(e,t,r){return alloc(null,e,t,r)},Buffer$2.allocUnsafe=function(e){return allocUnsafe(null,e)},Buffer$2.allocUnsafeSlow=function(e){return allocUnsafe(null,e)},Buffer$2.isBuffer=isBuffer,Buffer$2.compare=function(e,t){if(!internalIsBuffer(e)||!internalIsBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},Buffer$2.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer$2.concat=function(e,t){if(!isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Buffer$2.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=Buffer$2.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(!internalIsBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},Buffer$2.byteLength=byteLength,Buffer$2.prototype._isBuffer=!0,Buffer$2.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)swap(this,t,t+1);return this},Buffer$2.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)swap(this,t,t+3),swap(this,t+1,t+2);return this},Buffer$2.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)swap(this,t,t+7),swap(this,t+1,t+6),swap(this,t+2,t+5),swap(this,t+3,t+4);return this},Buffer$2.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?utf8Slice(this,0,e):slowToString.apply(this,arguments)},Buffer$2.prototype.equals=function(e){if(!internalIsBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Buffer$2.compare(this,e)},Buffer$2.prototype.inspect=function(){var e="",t=INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},Buffer$2.prototype.compare=function(e,t,r,n,i){if(!internalIsBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;for(var o=i-n,a=r-t,s=Math.min(o,a),u=this.slice(n,i),c=e.slice(t,r),l=0;l<s;++l)if(u[l]!==c[l]){o=u[l],a=c[l];break}return o<a?-1:a<o?1:0},Buffer$2.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},Buffer$2.prototype.indexOf=function(e,t,r){return bidirectionalIndexOf(this,e,t,r,!0)},Buffer$2.prototype.lastIndexOf=function(e,t,r){return bidirectionalIndexOf(this,e,t,r,!1)},Buffer$2.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return hexWrite(this,e,t,r);case"utf8":case"utf-8":return utf8Write(this,e,t,r);case"ascii":return asciiWrite(this,e,t,r);case"latin1":case"binary":return latin1Write(this,e,t,r);case"base64":return base64Write(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},Buffer$2.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(e){var t=e.length;if(t<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=MAX_ARGUMENTS_LENGTH));return r}function asciiSlice(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function latin1Slice(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function hexSlice(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=toHex(e[o]);return i}function utf16leSlice(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function checkOffset(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(e,t,r,n,i,o){if(!internalIsBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function objectWriteUInt16(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function objectWriteUInt32(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function checkIEEE754(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function writeFloat(e,t,r,n,i){return i||checkIEEE754(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),write(e,t,r,n,23,4),r+4}function writeDouble(e,t,r,n,i){return i||checkIEEE754(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),write(e,t,r,n,52,8),r+8}Buffer$2.prototype.slice=function(e,t){var r,n=this.length;if(e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),Buffer$2.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=Buffer$2.prototype;else{var i=t-e;r=new Buffer$2(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},Buffer$2.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},Buffer$2.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},Buffer$2.prototype.readUInt8=function(e,t){return t||checkOffset(e,1,this.length),this[e]},Buffer$2.prototype.readUInt16LE=function(e,t){return t||checkOffset(e,2,this.length),this[e]|this[e+1]<<8},Buffer$2.prototype.readUInt16BE=function(e,t){return t||checkOffset(e,2,this.length),this[e]<<8|this[e+1]},Buffer$2.prototype.readUInt32LE=function(e,t){return t||checkOffset(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Buffer$2.prototype.readUInt32BE=function(e,t){return t||checkOffset(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Buffer$2.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},Buffer$2.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},Buffer$2.prototype.readInt8=function(e,t){return t||checkOffset(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Buffer$2.prototype.readInt16LE=function(e,t){t||checkOffset(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},Buffer$2.prototype.readInt16BE=function(e,t){t||checkOffset(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},Buffer$2.prototype.readInt32LE=function(e,t){return t||checkOffset(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Buffer$2.prototype.readInt32BE=function(e,t){return t||checkOffset(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Buffer$2.prototype.readFloatLE=function(e,t){return t||checkOffset(e,4,this.length),read(this,e,!0,23,4)},Buffer$2.prototype.readFloatBE=function(e,t){return t||checkOffset(e,4,this.length),read(this,e,!1,23,4)},Buffer$2.prototype.readDoubleLE=function(e,t){return t||checkOffset(e,8,this.length),read(this,e,!0,52,8)},Buffer$2.prototype.readDoubleBE=function(e,t){return t||checkOffset(e,8,this.length),read(this,e,!1,52,8)},Buffer$2.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||checkInt(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},Buffer$2.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||checkInt(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},Buffer$2.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,1,255,0),Buffer$2.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},Buffer$2.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,65535,0),Buffer$2.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):objectWriteUInt16(this,e,t,!0),t+2},Buffer$2.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,65535,0),Buffer$2.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):objectWriteUInt16(this,e,t,!1),t+2},Buffer$2.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,4294967295,0),Buffer$2.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):objectWriteUInt32(this,e,t,!0),t+4},Buffer$2.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,4294967295,0),Buffer$2.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):objectWriteUInt32(this,e,t,!1),t+4},Buffer$2.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);checkInt(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},Buffer$2.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);checkInt(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},Buffer$2.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,1,127,-128),Buffer$2.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},Buffer$2.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,32767,-32768),Buffer$2.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):objectWriteUInt16(this,e,t,!0),t+2},Buffer$2.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,32767,-32768),Buffer$2.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):objectWriteUInt16(this,e,t,!1),t+2},Buffer$2.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,2147483647,-2147483648),Buffer$2.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):objectWriteUInt32(this,e,t,!0),t+4},Buffer$2.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Buffer$2.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):objectWriteUInt32(this,e,t,!1),t+4},Buffer$2.prototype.writeFloatLE=function(e,t,r){return writeFloat(this,e,t,!0,r)},Buffer$2.prototype.writeFloatBE=function(e,t,r){return writeFloat(this,e,t,!1,r)},Buffer$2.prototype.writeDoubleLE=function(e,t,r){return writeDouble(this,e,t,!0,r)},Buffer$2.prototype.writeDoubleBE=function(e,t,r){return writeDouble(this,e,t,!1,r)},Buffer$2.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!Buffer$2.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},Buffer$2.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Buffer$2.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=internalIsBuffer(e)?e:utf8ToBytes(new Buffer$2(e,n).toString()),s=a.length;for(o=0;o<r-t;++o)this[o+t]=a[o%s]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function base64clean(e){if((e=stringtrim(e).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function stringtrim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function toHex(e){return e<16?"0"+e.toString(16):e.toString(16)}function utf8ToBytes(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function asciiToBytes(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function utf16leToBytes(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}function base64ToBytes(e){return toByteArray(base64clean(e))}function blitBuffer(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function isnan(e){return e!=e}function isBuffer(e){return null!=e&&(!!e._isBuffer||isFastBuffer(e)||isSlowBuffer(e))}function isFastBuffer(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function isSlowBuffer(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&isFastBuffer(e.slice(0,0))}var bufferEs6=Object.freeze({INSPECT_MAX_BYTES:INSPECT_MAX_BYTES,kMaxLength:_kMaxLength,Buffer:Buffer$2,SlowBuffer:SlowBuffer,isBuffer:isBuffer}),Buffer$1=bufferEs6.Buffer;function hasFrom(){return Buffer$1.hasOwnProperty("from")&&"function"==typeof Buffer$1.from}function cloneBuffer(e){if(!Buffer$1.isBuffer(e))throw new Error("Can only clone Buffer.");if(hasFrom())return Buffer$1.from(e);var t=new Buffer$1(e.length);return e.copy(t),t}cloneBuffer.hasFrom=hasFrom;var cloneBuffer_1=cloneBuffer,domain;function EventHandlers(){}function EventEmitter(){EventEmitter.init.call(this)}function $getMaxListeners(e){return void 0===e._maxListeners?EventEmitter.defaultMaxListeners:e._maxListeners}function emitNone(e,t,r){if(t)e.call(r);else for(var n=e.length,i=arrayClone(e,n),o=0;o<n;++o)i[o].call(r)}function emitOne(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,o=arrayClone(e,i),a=0;a<i;++a)o[a].call(r,n)}function emitTwo(e,t,r,n,i){if(t)e.call(r,n,i);else for(var o=e.length,a=arrayClone(e,o),s=0;s<o;++s)a[s].call(r,n,i)}function emitThree(e,t,r,n,i,o){if(t)e.call(r,n,i,o);else for(var a=e.length,s=arrayClone(e,a),u=0;u<a;++u)s[u].call(r,n,i,o)}function emitMany(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,o=arrayClone(e,i),a=0;a<i;++a)o[a].apply(r,n)}function _addListener(e,t,r,n){var i,o,a;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),a=o[t]):(o=e._events=new EventHandlers,e._eventsCount=0),a){if("function"==typeof a?a=o[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),!a.warned&&(i=$getMaxListeners(e))&&i>0&&a.length>i){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=a.length,emitWarning(s)}}else a=o[t]=r,++e._eventsCount;return e}function emitWarning(e){"function"==typeof console.warn?console.warn(e):console.log(e)}function _onceWrap(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}function listenerCount$1(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function spliceOne(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}function arrayClone(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function unwrapListeners(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}EventHandlers.prototype=Object.create(null),EventEmitter.EventEmitter=EventEmitter,EventEmitter.usingDomains=!1,EventEmitter.prototype.domain=void 0,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.init=function(){this.domain=null,EventEmitter.usingDomains&&(!domain.active||this instanceof domain.Domain||(this.domain=domain.active)),this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new EventHandlers,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},EventEmitter.prototype.getMaxListeners=function(){return $getMaxListeners(this)},EventEmitter.prototype.emit=function(e){var t,r,n,i,o,a,s,u="error"===e;if(a=this._events)u=u&&null==a.error;else if(!u)return!1;if(s=this.domain,u){if(t=arguments[1],!s){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(r=a[e]))return!1;var l="function"==typeof r;switch(n=arguments.length){case 1:emitNone(r,l,this);break;case 2:emitOne(r,l,this,arguments[1]);break;case 3:emitTwo(r,l,this,arguments[1],arguments[2]);break;case 4:emitThree(r,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),o=1;o<n;o++)i[o-1]=arguments[o];emitMany(r,l,this,i)}return!0},EventEmitter.prototype.addListener=function(e,t){return _addListener(this,e,t,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function(e,t){return _addListener(this,e,t,!0)},EventEmitter.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.removeListener=function(e,t){var r,n,i,o,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[e]))return this;if(r===t||r.listener&&r.listener===t)0==--this._eventsCount?this._events=new EventHandlers:(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length;o-- >0;)if(r[o]===t||r[o].listener&&r[o].listener===t){a=r[o].listener,i=o;break}if(i<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new EventHandlers,this;delete n[e]}else spliceOne(r,i);n.removeListener&&this.emit("removeListener",e,a||t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new EventHandlers,this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=new EventHandlers:delete r[e]),this;if(0===arguments.length){for(var n,i=Object.keys(r),o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new EventHandlers,this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},EventEmitter.prototype.listeners=function(e){var t,r=this._events;return r&&(t=r[e])?"function"==typeof t?[t.listener||t]:unwrapListeners(t):[]},EventEmitter.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):listenerCount$1.call(e,t)},EventEmitter.prototype.listenerCount=listenerCount$1,EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var events=Object.freeze({default:EventEmitter,EventEmitter:EventEmitter});function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}var cachedSetTimeout=defaultSetTimout,cachedClearTimeout=defaultClearTimeout;function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}"function"==typeof global.setTimeout&&(cachedSetTimeout=setTimeout),"function"==typeof global.clearTimeout&&(cachedClearTimeout=clearTimeout);var queue$2=[],draining$1=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){draining$1&&currentQueue&&(draining$1=!1,currentQueue.length?queue$2=currentQueue.concat(queue$2):queueIndex=-1,queue$2.length&&drainQueue())}function drainQueue(){if(!draining$1){var e=runTimeout(cleanUpNextTick);draining$1=!0;for(var t=queue$2.length;t;){for(currentQueue=queue$2,queue$2=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue$2.length}currentQueue=null,draining$1=!1,runClearTimeout(e)}}function nextTick$2(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];queue$2.push(new Item(e,t)),1!==queue$2.length||draining$1||runTimeout(drainQueue)}function Item(e,t){this.fun=e,this.array=t}Item.prototype.run=function(){this.fun.apply(null,this.array)};var title="browser",platform="browser",browser=!0,env={},argv=[],version$2="",versions={},release={},config={};function noop$3(){}var on=noop$3,addListener=noop$3,once$1=noop$3,off=noop$3,removeListener=noop$3,removeAllListeners=noop$3,emit=noop$3;function binding(e){throw new Error("process.binding is not supported")}function cwd(){return"/"}function chdir(e){throw new Error("process.chdir is not supported")}function umask(){return 0}var performance$1=global.performance||{},performanceNow=performance$1.now||performance$1.mozNow||performance$1.msNow||performance$1.oNow||performance$1.webkitNow||function(){return(new Date).getTime()};function hrtime(e){var t=.001*performanceNow.call(performance$1),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n]}var startTime=new Date;function uptime(){return(new Date-startTime)/1e3}var process$1={nextTick:nextTick$2,title:title,browser:browser,env:env,argv:argv,version:version$2,versions:versions,on:on,addListener:addListener,once:once$1,off:off,removeListener:removeListener,removeAllListeners:removeAllListeners,emit:emit,binding:binding,cwd:cwd,chdir:chdir,umask:umask,hrtime:hrtime,platform:platform,release:release,config:config,uptime:uptime},inherits$2;inherits$2="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e};var inherits$3=inherits$2,formatRegExp=/%[sdj%]/g;function format$1(e){if(!isString(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(inspect(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,o=String(e).replace(formatRegExp,function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),a=n[r];r<i;a=n[++r])isNull(a)||!isObject(a)?o+=" "+a:o+=" "+inspect(a);return o}function deprecate(e,t){if(isUndefined(global.process))return function(){return deprecate(e,t).apply(this,arguments)};if(!0===process$1.noDeprecation)return e;var r=!1;return function(){if(!r){if(process$1.throwDeprecation)throw new Error(t);process$1.traceDeprecation?console.trace(t):console.error(t),r=!0}return e.apply(this,arguments)}}var debugs={},debugEnviron;function debuglog(e){if(isUndefined(debugEnviron)&&(debugEnviron=process$1.env.NODE_DEBUG||""),e=e.toUpperCase(),!debugs[e])if(new RegExp("\\b"+e+"\\b","i").test(debugEnviron)){debugs[e]=function(){var t=format$1.apply(null,arguments);console.error("%s %d: %s",e,0,t)}}else debugs[e]=function(){};return debugs[e]}function inspect(e,t){var r={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),isBoolean(t)?r.showHidden=t:t&&_extend(r,t),isUndefined(r.showHidden)&&(r.showHidden=!1),isUndefined(r.depth)&&(r.depth=2),isUndefined(r.colors)&&(r.colors=!1),isUndefined(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=stylizeWithColor),formatValue(r,e,r.depth)}function stylizeWithColor(e,t){var r=inspect.styles[t];return r?"["+inspect.colors[r][0]+"m"+e+"["+inspect.colors[r][1]+"m":e}function stylizeNoColor(e,t){return e}function arrayToHash(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}function formatValue(e,t,r){if(e.customInspect&&t&&isFunction$1(t.inspect)&&t.inspect!==inspect&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(r,e);return isString(n)||(n=formatValue(e,n,r)),n}var i=formatPrimitive(e,t);if(i)return i;var o=Object.keys(t),a=arrayToHash(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(t)),isError(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return formatError(t);if(0===o.length){if(isFunction$1(t)){var s=t.name?": "+t.name:"";return e.stylize("[Function"+s+"]","special")}if(isRegExp(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(isDate(t))return e.stylize(Date.prototype.toString.call(t),"date");if(isError(t))return formatError(t)}var u,c="",l=!1,f=["{","}"];(isArray$1(t)&&(l=!0,f=["[","]"]),isFunction$1(t))&&(c=" [Function"+(t.name?": "+t.name:"")+"]");return isRegExp(t)&&(c=" "+RegExp.prototype.toString.call(t)),isDate(t)&&(c=" "+Date.prototype.toUTCString.call(t)),isError(t)&&(c=" "+formatError(t)),0!==o.length||l&&0!=t.length?r<0?isRegExp(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),u=l?formatArray(e,t,r,a,o):o.map(function(n){return formatProperty(e,t,r,a,n,l)}),e.seen.pop(),reduceToSingleString(u,c,f)):f[0]+c+f[1]}function formatPrimitive(e,t){if(isUndefined(t))return e.stylize("undefined","undefined");if(isString(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return isNumber(t)?e.stylize(""+t,"number"):isBoolean(t)?e.stylize(""+t,"boolean"):isNull(t)?e.stylize("null","null"):void 0}function formatError(e){return"["+Error.prototype.toString.call(e)+"]"}function formatArray(e,t,r,n,i){for(var o=[],a=0,s=t.length;a<s;++a)hasOwnProperty(t,String(a))?o.push(formatProperty(e,t,r,n,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(formatProperty(e,t,r,n,i,!0))}),o}function formatProperty(e,t,r,n,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),hasOwnProperty(n,i)||(a="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=isNull(r)?formatValue(e,u.value,null):formatValue(e,u.value,r-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),isUndefined(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function reduceToSingleString(e,t,r){return e.reduce(function(e,t){return 0,t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}function isArray$1(e){return Array.isArray(e)}function isBoolean(e){return"boolean"==typeof e}function isNull(e){return null===e}function isNullOrUndefined(e){return null==e}function isNumber(e){return"number"==typeof e}function isString(e){return"string"==typeof e}function isSymbol(e){return"symbol"==typeof e}function isUndefined(e){return void 0===e}function isRegExp(e){return isObject(e)&&"[object RegExp]"===objectToString(e)}function isObject(e){return"object"==typeof e&&null!==e}function isDate(e){return isObject(e)&&"[object Date]"===objectToString(e)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction$1(e){return"function"==typeof e}function isPrimitive(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function isBuffer$1(e){return Buffer.isBuffer(e)}function objectToString(e){return Object.prototype.toString.call(e)}function pad$2(e){return e<10?"0"+e.toString(10):e.toString(10)}inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var months$1=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var e=new Date,t=[pad$2(e.getHours()),pad$2(e.getMinutes()),pad$2(e.getSeconds())].join(":");return[e.getDate(),months$1[e.getMonth()],t].join(" ")}function log$3(){console.log("%s - %s",timestamp(),format$1.apply(null,arguments))}function _extend(e,t){if(!t||!isObject(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}function hasOwnProperty(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var util={inherits:inherits$3,_extend:_extend,log:log$3,isBuffer:isBuffer$1,isPrimitive:isPrimitive,isFunction:isFunction$1,isError:isError,isDate:isDate,isObject:isObject,isRegExp:isRegExp,isUndefined:isUndefined,isSymbol:isSymbol,isString:isString,isNumber:isNumber,isNullOrUndefined:isNullOrUndefined,isNull:isNull,isBoolean:isBoolean,isArray:isArray$1,inspect:inspect,deprecate:deprecate,format:format$1,debuglog:debuglog},util$1=Object.freeze({format:format$1,deprecate:deprecate,debuglog:debuglog,inspect:inspect,isArray:isArray$1,isBoolean:isBoolean,isNull:isNull,isNullOrUndefined:isNullOrUndefined,isNumber:isNumber,isString:isString,isSymbol:isSymbol,isUndefined:isUndefined,isRegExp:isRegExp,isObject:isObject,isDate:isDate,isError:isError,isFunction:isFunction$1,isPrimitive:isPrimitive,isBuffer:isBuffer$1,log:log$3,inherits:inherits$3,_extend:_extend,default:util}),inherits_browser=createCommonjsModule(function(e){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}),util$2=util$1&&util||util$1,inherits=createCommonjsModule(function(e){try{var t=util$2;if("function"!=typeof t.inherits)throw"";e.exports=t.inherits}catch(t){e.exports=inherits_browser}}),s$1=1e3,m=60*s$1,h=60*m,d=24*h,y$5=365.25*d,ms=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return parse(e);if("number"===r&&!1===isNaN(e))return t.long?fmtLong(e):fmtShort(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function parse(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*y$5;case"days":case"day":case"d":return r*d;case"hours":case"hour":case"hrs":case"hr":case"h":return r*h;case"minutes":case"minute":case"mins":case"min":case"m":return r*m;case"seconds":case"second":case"secs":case"sec":case"s":return r*s$1;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function fmtShort(e){return e>=d?Math.round(e/d)+"d":e>=h?Math.round(e/h)+"h":e>=m?Math.round(e/m)+"m":e>=s$1?Math.round(e/s$1)+"s":e+"ms"}function fmtLong(e){return plural(e,d,"day")||plural(e,h,"hour")||plural(e,m,"minute")||plural(e,s$1,"second")||e+" ms"}function plural(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}var debug$1=createCommonjsModule(function(e,t){function r(e){var r;function i(){if(i.enabled){var e=i,n=+new Date,o=n-(r||n);e.diff=o,e.prev=r,e.curr=n,r=n;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var u=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;u++;var i=t.formatters[n];if("function"==typeof i){var o=a[u];r=i.call(e,o),a.splice(u,1),u--}return r}),t.formatArgs.call(e,a),(i.log||t.log||console.log.bind(console)).apply(e,a)}}return i.namespace=e,i.enabled=t.enabled(e),i.useColors=t.useColors(),i.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),i.destroy=n,"function"==typeof t.init&&t.init(i),t.instances.push(i),i}function n(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var o=t.instances[r];o.enabled=t.enabled(o.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=ms,t.instances=[],t.names=[],t.skips=[],t.formatters={}}),debug_1=debug$1.coerce,debug_2=debug$1.disable,debug_3=debug$1.enable,debug_4=debug$1.enabled,debug_5=debug$1.humanize,debug_6=debug$1.instances,debug_7=debug$1.names,debug_8=debug$1.skips,debug_9=debug$1.formatters,browser$1=createCommonjsModule(function(e,t){function r(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=debug$1).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(o=++i)}),e.splice(o,0,n)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=r,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(r())}),browser_1=browser$1.log,browser_2=browser$1.formatArgs,browser_3=browser$1.save,browser_4=browser$1.load,browser_5=browser$1.useColors,browser_6=browser$1.storage,browser_7=browser$1.colors;function isatty(){return!1}function ReadStream$1(){throw new Error("tty.ReadStream is not implemented")}function WriteStream(){throw new Error("tty.ReadStream is not implemented")}var tty={isatty:isatty,ReadStream:ReadStream$1,WriteStream:WriteStream},tty$1=Object.freeze({isatty:isatty,ReadStream:ReadStream$1,WriteStream:WriteStream,default:tty}),argv$1=process.argv,terminator=argv$1.indexOf("--"),hasFlag=function(e){e="--"+e;var t=argv$1.indexOf(e);return-1!==t&&(-1===terminator||t<terminator)},supportsColor="FORCE_COLOR"in process.env||!(hasFlag("no-color")||hasFlag("no-colors")||hasFlag("color=false"))&&(!!(hasFlag("color")||hasFlag("colors")||hasFlag("color=true")||hasFlag("color=always"))||!(process.stdout&&!process.stdout.isTTY)&&("win32"===process.platform||"COLORTERM"in process.env||"dumb"!==process.env.TERM&&!!/^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(process.env.TERM))),tty$2=tty$1&&tty||tty$1,node=createCommonjsModule(function(e,t){(t=e.exports=debug$1).init=function(e){e.inspectOpts={};for(var r=Object.keys(t.inspectOpts),n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(){return process.stderr.write(util$2.format.apply(util$2,arguments)+"\n")},t.formatArgs=function(e){var r=this.namespace;if(this.useColors){var n=this.color,i="[3"+(n<8?n:"8;5;"+n),o="  "+i+";1m"+r+" [0m";e[0]=o+e[0].split("\n").join("\n"+o),e.push(i+"m+"+t.humanize(this.diff)+"[0m")}else e[0]=(new Date).toISOString()+" "+r+" "+e[0]},t.save=function(e){null==e?delete process.env.DEBUG:process.env.DEBUG=e},t.load=r,t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):tty$2.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{supportsColor&&supportsColor.level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}function r(){return process.env.DEBUG}t.inspectOpts=Object.keys(process.env).filter(function(e){return/^debug_/i.test(e)}).reduce(function(e,t){var r=t.substring(6).toLowerCase().replace(/_([a-z])/g,function(e,t){return t.toUpperCase()}),n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e},{}),t.formatters.o=function(e){return this.inspectOpts.colors=this.useColors,util$2.inspect(e,this.inspectOpts).replace(/\s*\n\s*/g," ")},t.formatters.O=function(e){return this.inspectOpts.colors=this.useColors,util$2.inspect(e,this.inspectOpts)},t.enable(r())}),node_1=node.init,node_2=node.log,node_3=node.formatArgs,node_4=node.save,node_5=node.load,node_6=node.useColors,node_7=node.colors,node_8=node.inspectOpts,src=createCommonjsModule(function(e){"undefined"!=typeof process&&"renderer"===process.type?e.exports=browser$1:e.exports=node}),_defineProp;function Object_keys(e){if(Object.keys)return Object.keys(e);var t=[];for(var r in e)t.push(r);return t}function forEach(e,t){if(e.forEach)return e.forEach(t);for(var r=0;r<e.length;r++)t(e[r],r,e)}function defineProp(e,t,r){"function"!=typeof _defineProp&&(_defineProp=createDefineProp),_defineProp(e,t,r)}function createDefineProp(){try{return Object.defineProperty({},"_",{}),function(e,t,r){Object.defineProperty(e,t,{writable:!0,enumerable:!1,configurable:!0,value:r})}}catch(e){return function(e,t,r){e[t]=r}}}var globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}function Script(e){if(!(this instanceof Script))return new Script(e);this.code=e}function otherRunInContext(e,t){var r=Object_keys(global);return r.push("with (this.__ctx__){return eval(this.__code__)}"),Function.apply(null,r).apply({__code__:e,__ctx__:t})}function createScript(e){return new Script(e)}function createContext(e){if(isContext(e))return e;var t=new Context;return"object"==typeof e&&forEach(Object_keys(e),function(r){t[r]=e[r]}),t}function runInContext(e,t,r){return new Script(e,r).runInContext(t,r)}function runInThisContext(e,t){return new Script(e,t).runInThisContext(t)}function isContext(e){return e instanceof Context}function runInNewContext(e,t,r){return new Script(e,r).runInNewContext(t,r)}Context.prototype={},Script.prototype.runInContext=function(e){if(!(e instanceof Context))throw new TypeError("needs a 'context' argument.");if(global.document){var t=global.document.createElement("iframe");t.style||(t.style={}),t.style.display="none",global.document.body.appendChild(t);var r=t.contentWindow,n=r.eval,i=r.execScript;!n&&i&&(i.call(r,"null"),n=r.eval),forEach(Object_keys(e),function(t){r[t]=e[t]}),forEach(globals,function(t){e[t]&&(r[t]=e[t])});var o=Object_keys(r),a=n.call(r,this.code);return forEach(Object_keys(r),function(t){(t in e||-1===indexOf(o,t))&&(e[t]=r[t])}),forEach(globals,function(t){t in e||defineProp(e,t,r[t])}),global.document.body.removeChild(t),a}return otherRunInContext(this.code,e)},Script.prototype.runInThisContext=function(){return new Function("code","return eval(code);").call(global,this.code)},Script.prototype.runInNewContext=function(e){var t=createContext(e),r=this.runInContext(t);return e&&forEach(Object_keys(t),function(r){e[r]=t[r]}),r};var vm={runInContext:runInContext,isContext:isContext,createContext:createContext,createScript:createScript,Script:Script,runInThisContext:runInThisContext,runInNewContext:runInNewContext},_indexOf=[].indexOf;function indexOf(e,t){if(_indexOf)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}var immutable=extend$1,hasOwnProperty$1=Object.prototype.hasOwnProperty;function extend$1(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var n in r)hasOwnProperty$1.call(r,n)&&(e[n]=r[n])}return e}function AbstractIterator$1(e){this.db=e,this._ended=!1,this._nexting=!1}AbstractIterator$1.prototype.next=function(e){var t=this;if("function"!=typeof e)throw new Error("next() requires a callback argument");return t._ended?e(new Error("cannot call next() after end()")):t._nexting?e(new Error("cannot call next() before previous next() has completed")):(t._nexting=!0,"function"==typeof t._next?t._next(function(){t._nexting=!1,e.apply(null,arguments)}):void process.nextTick(function(){t._nexting=!1,e()}))},AbstractIterator$1.prototype.end=function(e){if("function"!=typeof e)throw new Error("end() requires a callback argument");return this._ended?e(new Error("end() already called on iterator")):(this._ended=!0,"function"==typeof this._end?this._end(e):void process.nextTick(e))};var abstractIterator=AbstractIterator$1;function AbstractChainedBatch$1(e){this._db=e,this._operations=[],this._written=!1}AbstractChainedBatch$1.prototype._serializeKey=function(e){return this._db._serializeKey(e)},AbstractChainedBatch$1.prototype._serializeValue=function(e){return this._db._serializeValue(e)},AbstractChainedBatch$1.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},AbstractChainedBatch$1.prototype.put=function(e,t){this._checkWritten();var r=this._db._checkKey(e,"key",this._db._isBuffer);if(r)throw r;return e=this._serializeKey(e),t=this._serializeValue(t),"function"==typeof this._put?this._put(e,t):this._operations.push({type:"put",key:e,value:t}),this},AbstractChainedBatch$1.prototype.del=function(e){this._checkWritten();var t=this._db._checkKey(e,"key",this._db._isBuffer);if(t)throw t;return e=this._serializeKey(e),"function"==typeof this._del?this._del(e):this._operations.push({type:"del",key:e}),this},AbstractChainedBatch$1.prototype.clear=function(){return this._checkWritten(),this._operations=[],"function"==typeof this._clear&&this._clear(),this},AbstractChainedBatch$1.prototype.write=function(e,t){if(this._checkWritten(),"function"==typeof e&&(t=e),"function"!=typeof t)throw new Error("write() requires a callback argument");return"object"!=typeof e&&(e={}),this._written=!0,"function"==typeof this._write?this._write(t):"function"==typeof this._db._batch?this._db._batch(this._operations,e,t):void process.nextTick(t)};var abstractChainedBatch=AbstractChainedBatch$1;function AbstractLevelDOWN$2(e){if(!arguments.length||void 0===e)throw new Error("constructor requires at least a location argument");if("string"!=typeof e)throw new Error("constructor requires a location string argument");this.location=e,this.status="new"}AbstractLevelDOWN$2.prototype.open=function(e,t){var r=this,n=this.status;if("function"==typeof e&&(t=e),"function"!=typeof t)throw new Error("open() requires a callback argument");"object"!=typeof e&&(e={}),e.createIfMissing=0!=e.createIfMissing,e.errorIfExists=!!e.errorIfExists,"function"==typeof this._open?(this.status="opening",this._open(e,function(e){if(e)return r.status=n,t(e);r.status="open",t()})):(this.status="open",process.nextTick(t))},AbstractLevelDOWN$2.prototype.close=function(e){var t=this,r=this.status;if("function"!=typeof e)throw new Error("close() requires a callback argument");"function"==typeof this._close?(this.status="closing",this._close(function(n){if(n)return t.status=r,e(n);t.status="closed",e()})):(this.status="closed",process.nextTick(e))},AbstractLevelDOWN$2.prototype.get=function(e,t,r){var n;if("function"==typeof t&&(r=t),"function"!=typeof r)throw new Error("get() requires a callback argument");return(n=this._checkKey(e,"key"))?r(n):(e=this._serializeKey(e),"object"!=typeof t&&(t={}),t.asBuffer=0!=t.asBuffer,"function"==typeof this._get?this._get(e,t,r):void process.nextTick(function(){r(new Error("NotFound"))}))},AbstractLevelDOWN$2.prototype.put=function(e,t,r,n){var i;if("function"==typeof r&&(n=r),"function"!=typeof n)throw new Error("put() requires a callback argument");return(i=this._checkKey(e,"key"))?n(i):(e=this._serializeKey(e),t=this._serializeValue(t),"object"!=typeof r&&(r={}),"function"==typeof this._put?this._put(e,t,r,n):void process.nextTick(n))},AbstractLevelDOWN$2.prototype.del=function(e,t,r){var n;if("function"==typeof t&&(r=t),"function"!=typeof r)throw new Error("del() requires a callback argument");return(n=this._checkKey(e,"key"))?r(n):(e=this._serializeKey(e),"object"!=typeof t&&(t={}),"function"==typeof this._del?this._del(e,t,r):void process.nextTick(r))},AbstractLevelDOWN$2.prototype.batch=function(e,t,r){if(!arguments.length)return this._chainedBatch();if("function"==typeof t&&(r=t),"function"==typeof e&&(r=e),"function"!=typeof r)throw new Error("batch(array) requires a callback argument");if(!Array.isArray(e))return r(new Error("batch(array) requires an array argument"));t&&"object"==typeof t||(t={});for(var n,i,o=0,a=e.length;o<a;o++)if("object"==typeof(n=e[o])){if(i=this._checkKey(n.type,"type"))return r(i);if(i=this._checkKey(n.key,"key"))return r(i)}if("function"==typeof this._batch)return this._batch(e,t,r);process.nextTick(r)},AbstractLevelDOWN$2.prototype.approximateSize=function(e,t,r){if(null==e||null==t||"function"==typeof e||"function"==typeof t)throw new Error("approximateSize() requires valid `start`, `end` and `callback` arguments");if("function"!=typeof r)throw new Error("approximateSize() requires a callback argument");if(e=this._serializeKey(e),t=this._serializeKey(t),"function"==typeof this._approximateSize)return this._approximateSize(e,t,r);process.nextTick(function(){r(null,0)})},AbstractLevelDOWN$2.prototype._setupIteratorOptions=function(e){var t=this;return e=immutable(e),["start","end","gt","gte","lt","lte"].forEach(function(r){e[r]&&t._isBuffer(e[r])&&0===e[r].length&&delete e[r]}),e.reverse=!!e.reverse,e.keys=0!=e.keys,e.values=0!=e.values,e.limit="limit"in e?e.limit:-1,e.keyAsBuffer=0!=e.keyAsBuffer,e.valueAsBuffer=0!=e.valueAsBuffer,e},AbstractLevelDOWN$2.prototype.iterator=function(e){return"object"!=typeof e&&(e={}),e=this._setupIteratorOptions(e),"function"==typeof this._iterator?this._iterator(e):new abstractIterator(this)},AbstractLevelDOWN$2.prototype._chainedBatch=function(){return new abstractChainedBatch(this)},AbstractLevelDOWN$2.prototype._isBuffer=function(e){return Buffer.isBuffer(e)},AbstractLevelDOWN$2.prototype._serializeKey=function(e){return this._isBuffer(e)?e:String(e)},AbstractLevelDOWN$2.prototype._serializeValue=function(e){return null==e?"":this._isBuffer(e)||process.browser?e:String(e)},AbstractLevelDOWN$2.prototype._checkKey=function(e,t){return null===e||void 0===e?new Error(t+" cannot be `null` or `undefined`"):this._isBuffer(e)&&0===e.length?new Error(t+" cannot be an empty Buffer"):""===String(e)?new Error(t+" cannot be an empty String"):void 0};var abstractLeveldown$2=AbstractLevelDOWN$2;function isLevelDOWN$1(e){return!(!e||"object"!=typeof e)&&Object.keys(abstractLeveldown$2.prototype).filter(function(e){return"_"!=e[0]&&"approximateSize"!=e}).every(function(t){return"function"==typeof e[t]})}var isLeveldown=isLevelDOWN$1,AbstractLevelDOWN$1=abstractLeveldown$2,AbstractIterator=abstractIterator,AbstractChainedBatch=abstractChainedBatch,isLevelDOWN=isLeveldown,abstractLeveldown={AbstractLevelDOWN:AbstractLevelDOWN$1,AbstractIterator:AbstractIterator,AbstractChainedBatch:AbstractChainedBatch,isLevelDOWN:isLevelDOWN},AbstractIterator$3=abstractLeveldown.AbstractIterator;function DeferredIterator(e){AbstractIterator$3.call(this,e),this._options=e,this._iterator=null,this._operations=[]}util$2.inherits(DeferredIterator,AbstractIterator$3),DeferredIterator.prototype.setDb=function(e){var t=this._iterator=e.iterator(this._options);this._operations.forEach(function(e){t[e.method].apply(t,e.args)})},DeferredIterator.prototype._operation=function(e,t){if(this._iterator)return this._iterator[e].apply(this._iterator,t);this._operations.push({method:e,args:t})},"next end".split(" ").forEach(function(e){DeferredIterator.prototype["_"+e]=function(){this._operation(e,arguments)}});var deferredIterator=DeferredIterator,AbstractLevelDOWN=abstractLeveldown.AbstractLevelDOWN,deferrables="put get del batch approximateSize".split(" ");function DeferredLevelDOWN(e){AbstractLevelDOWN.call(this,""),this._db=e,this._operations=[],this._iterators=[]}function open(e){deferrables.concat("iterator").forEach(function(t){e["_"+t]=function(){return this._db[t].apply(this._db,arguments)}})}function closed(e){deferrables.forEach(function(t){e["_"+t]=function(){this._operations.push({method:t,args:arguments})}}),e._iterator=function(e){var t=new deferredIterator(e);return this._iterators.push(t),t}}util$2.inherits(DeferredLevelDOWN,AbstractLevelDOWN),DeferredLevelDOWN.prototype._open=function(e,t){var r=this;this._db.open(e,function(e){if(e)return t(e);r._operations.forEach(function(e){r._db[e.method].apply(r._db,e.args)}),r._operations=[],r._iterators.forEach(function(e){e.setDb(r._db)}),r._iterators=[],open(r),t()})},DeferredLevelDOWN.prototype._close=function(e){var t=this;this._db.close(function(r){if(r)return e(r);closed(t),e()})},closed(DeferredLevelDOWN.prototype),DeferredLevelDOWN.prototype._isBuffer=function(e){return Buffer.isBuffer(e)},DeferredLevelDOWN.prototype._serializeKey=function(e){return e},DeferredLevelDOWN.prototype._serializeValue=function(e){return e};var deferredLeveldown=DeferredLevelDOWN,DeferredIterator_1=deferredIterator;function BufferList$1(){this.head=null,this.tail=null,this.length=0}deferredLeveldown.DeferredIterator=DeferredIterator_1,BufferList$1.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},BufferList$1.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},BufferList$1.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},BufferList$1.prototype.clear=function(){this.head=this.tail=null,this.length=0},BufferList$1.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},BufferList$1.prototype.concat=function(e){if(0===this.length)return Buffer$2.alloc(0);if(1===this.length)return this.head.data;for(var t=Buffer$2.allocUnsafe(e>>>0),r=this.head,n=0;r;)r.data.copy(t,n),n+=r.data.length,r=r.next;return t};var isBufferEncoding=Buffer$2.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function assertEncoding(e){if(e&&!isBufferEncoding(e))throw new Error("Unknown encoding: "+e)}function StringDecoder(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer$2(6),this.charReceived=0,this.charLength=0}function passThroughWrite(e){return e.toString(this.encoding)}function utf16DetectIncompleteChar(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}StringDecoder.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";if(e=e.slice(r,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var n=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,n),n-=this.charReceived);var i;n=(t+=e.toString(this.encoding,0,n)).length-1;if((i=t.charCodeAt(n))>=55296&&i<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,n)}return t},StringDecoder.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},StringDecoder.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,n=this.charBuffer,i=this.encoding;t+=n.slice(0,r).toString(i)}return t};var stringDecoder=Object.freeze({StringDecoder:StringDecoder});Readable$3.ReadableState=ReadableState;var debug$3=debuglog("stream");function prependListener(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}function listenerCount$2(e,t){return e.listeners(t).length}function ReadableState(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof Duplex$1&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.buffer=new BufferList$1,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable$3(e){if(!(this instanceof Readable$3))return new Readable$3(e);this._readableState=new ReadableState(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),EventEmitter.call(this)}function readableAddChunk(e,t,r,n,i){var o=chunkInvalid(t,r);if(o)e.emit("error",o);else if(null===r)t.reading=!1,onEofChunk(e,t);else if(t.objectMode||r&&r.length>0)if(t.ended&&!i){var a=new Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&i){var s=new Error("stream.unshift() after end event");e.emit("error",s)}else{var u;!t.decoder||i||n||(r=t.decoder.write(r),u=!t.objectMode&&0===r.length),i||(t.reading=!1),u||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&emitReadable(e))),maybeReadMore(e,t)}else i||(t.reading=!1);return needMoreData(t)}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}inherits$3(Readable$3,EventEmitter),Readable$3.prototype.push=function(e,t){var r=this._readableState;return r.objectMode||"string"!=typeof e||(t=t||r.defaultEncoding)!==r.encoding&&(e=Buffer.from(e,t),t=""),readableAddChunk(this,r,e,t,!1)},Readable$3.prototype.unshift=function(e){return readableAddChunk(this,this._readableState,e,"",!0)},Readable$3.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable$3.prototype.setEncoding=function(e){return this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e,this};var MAX_HWM=8388608;function computeNewHighWaterMark(e){return e>=MAX_HWM?e=MAX_HWM:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function howMuchToRead(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=computeNewHighWaterMark(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function chunkInvalid(e,t){var r=null;return Buffer.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function onEofChunk(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,emitReadable(e)}}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug$3("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?nextTick$2(emitReadable_,e):emitReadable_(e))}function emitReadable_(e){debug$3("emit readable"),e.emit("readable"),flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,nextTick$2(maybeReadMore_,e,t))}function maybeReadMore_(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(debug$3("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug$3("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&e.listeners("data").length&&(t.flowing=!0,flow(e))}}function nReadingNextTick(e){debug$3("readable nexttick read 0"),e.read(0)}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,nextTick$2(resume_,e,t))}function resume_(e,t){t.reading||(debug$3("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){var t=e._readableState;for(debug$3("flow",t.flowing);t.flowing&&null!==e.read(););}function fromList(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=fromListPartial(e,t.buffer,t.decoder),r);var r}function fromListPartial(e,t,r){var n;return e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?copyFromBufferString(e,t):copyFromBuffer(e,t),n}function copyFromBufferString(e,t){var r=t.head,n=1,i=r.data;for(e-=i.length;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(a===o.length?i+=o:i+=o.slice(0,e),0===(e-=a)){a===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++n}return t.length-=n,i}function copyFromBuffer(e,t){var r=Buffer.allocUnsafe(e),n=t.head,i=1;for(n.data.copy(r),e-=n.data.length;n=n.next;){var o=n.data,a=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,a),0===(e-=a)){a===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(a));break}++i}return t.length-=i,r}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,nextTick$2(endReadableNT,t,e))}function endReadableNT(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function forEach$1(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}function indexOf$1(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function nop(){}function WriteReq(e,t,r){this.chunk=e,this.encoding=t,this.callback=r,this.next=null}function WritableState(e,t){Object.defineProperty(this,"buffer",{get:deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof Duplex$1&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var i=!1===e.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}function Writable$1(e){if(!(this instanceof Writable$1||this instanceof Duplex$1))return new Writable$1(e);this._writableState=new WritableState(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),EventEmitter.call(this)}function writeAfterEnd(e,t){var r=new Error("write after end");e.emit("error",r),nextTick$2(t,r)}function validChunk(e,t,r,n){var i=!0,o=!1;return null===r?o=new TypeError("May not write null values to stream"):Buffer$2.isBuffer(r)||"string"==typeof r||void 0===r||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),nextTick$2(n,o),i=!1),i}function decodeChunk(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=Buffer$2.from(t,r)),t}function writeOrBuffer(e,t,r,n,i){r=decodeChunk(t,r,n),Buffer$2.isBuffer(r)&&(n="buffer");var o=t.objectMode?1:r.length;t.length+=o;var a=t.length<t.highWaterMark;if(a||(t.needDrain=!0),t.writing||t.corked){var s=t.lastBufferedRequest;t.lastBufferedRequest=new WriteReq(r,n,i),s?s.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else doWrite(e,t,!1,o,r,n,i);return a}function doWrite(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function onwriteError(e,t,r,n,i){--t.pendingcb,r?nextTick$2(i,n):i(n),e._writableState.errorEmitted=!0,e.emit("error",n)}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(onwriteStateUpdate(r),t)onwriteError(e,r,n,t,i);else{var o=needFinish(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||clearBuffer(e,r),n?nextTick$2(afterWrite,e,r,o,i):afterWrite(e,r,o,i)}}function afterWrite(e,t,r,n){r||onwriteDrain(e,t),t.pendingcb--,n(),finishMaybe(e,t)}function onwriteDrain(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var a=0;r;)i[a]=r,r=r.next,a+=1;doWrite(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new CorkedRequest(t)}else{for(;r;){var s=r.chunk,u=r.encoding,c=r.callback;if(doWrite(e,t,!1,t.objectMode?1:s.length,s,u,c),r=r.next,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=r,t.bufferProcessing=!1}function needFinish(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function prefinish(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function finishMaybe(e,t){var r=needFinish(t);return r&&(0===t.pendingcb?(prefinish(e,t),t.finished=!0,e.emit("finish")):prefinish(e,t)),r}function endWritable(e,t,r){t.ending=!0,finishMaybe(e,t),r&&(t.finished?nextTick$2(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function CorkedRequest(e){var t=this;this.next=null,this.entry=null,this.finish=function(r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}Readable$3.prototype.read=function(e){debug$3("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return debug$3("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return 0===t.length&&endReadable(this),null;var n,i=t.needReadable;return debug$3("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&debug$3("length less than watermark",i=!0),t.ended||t.reading?debug$3("reading or ended",i=!1):i&&(debug$3("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=howMuchToRead(r,t))),null===(n=e>0?fromList(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&endReadable(this)),null!==n&&this.emit("data",n),n},Readable$3.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Readable$3.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,debug$3("pipe count=%d opts=%j",n.pipesCount,t);var i=!t||!1!==t.end?a:c;function o(e){debug$3("onunpipe"),e===r&&c()}function a(){debug$3("onend"),e.end()}n.endEmitted?nextTick$2(i):r.once("end",i),e.on("unpipe",o);var s=pipeOnDrain(r);e.on("drain",s);var u=!1;function c(){debug$3("cleanup"),e.removeListener("close",h),e.removeListener("finish",p),e.removeListener("drain",s),e.removeListener("error",d),e.removeListener("unpipe",o),r.removeListener("end",a),r.removeListener("end",c),r.removeListener("data",f),u=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||s()}var l=!1;function f(t){debug$3("ondata"),l=!1,!1!==e.write(t)||l||((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==indexOf$1(n.pipes,e))&&!u&&(debug$3("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,l=!0),r.pause())}function d(t){debug$3("onerror",t),m(),e.removeListener("error",d),0===listenerCount$2(e,"error")&&e.emit("error",t)}function h(){e.removeListener("finish",p),m()}function p(){debug$3("onfinish"),e.removeListener("close",h),m()}function m(){debug$3("unpipe"),r.unpipe(e)}return r.on("data",f),prependListener(e,"error",d),e.once("close",h),e.once("finish",p),e.emit("pipe",r),n.flowing||(debug$3("pipe resume"),r.resume()),e},Readable$3.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<n;i++)r[i].emit("unpipe",this);return this}var o=indexOf$1(t.pipes,e);return-1===o?this:(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Readable$3.prototype.on=function(e,t){var r=EventEmitter.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&emitReadable(this,n):nextTick$2(nReadingNextTick,this))}return r},Readable$3.prototype.addListener=Readable$3.prototype.on,Readable$3.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug$3("resume"),e.flowing=!0,resume(this,e)),this},Readable$3.prototype.pause=function(){return debug$3("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug$3("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable$3.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;e.on("end",function(){if(debug$3("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),e.on("data",function(i){(debug$3("wrapped data"),t.decoder&&(i=t.decoder.write(i)),!t.objectMode||null!==i&&void 0!==i)&&((t.objectMode||i&&i.length)&&(n.push(i)||(r=!0,e.pause())))});for(var i in e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return forEach$1(["error","close","destroy","pause","resume"],function(t){e.on(t,n.emit.bind(n,t))}),n._read=function(t){debug$3("wrapped _read",t),r&&(r=!1,e.resume())},n},Readable$3._fromList=fromList,Writable$1.WritableState=WritableState,inherits$3(Writable$1,EventEmitter),WritableState.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},Writable$1.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Writable$1.prototype.write=function(e,t,r){var n=this._writableState,i=!1;return"function"==typeof t&&(r=t,t=null),Buffer$2.isBuffer(e)?t="buffer":t||(t=n.defaultEncoding),"function"!=typeof r&&(r=nop),n.ended?writeAfterEnd(this,r):validChunk(this,n,e,r)&&(n.pendingcb++,i=writeOrBuffer(this,n,e,t,r)),i},Writable$1.prototype.cork=function(){this._writableState.corked++},Writable$1.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||clearBuffer(this,e))},Writable$1.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Writable$1.prototype._write=function(e,t,r){r(new Error("not implemented"))},Writable$1.prototype._writev=null,Writable$1.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||endWritable(this,n,r)},inherits$3(Duplex$1,Readable$3);for(var keys$2=Object.keys(Writable$1.prototype),v=0;v<keys$2.length;v++){var method=keys$2[v];Duplex$1.prototype[method]||(Duplex$1.prototype[method]=Writable$1.prototype[method])}function Duplex$1(e){if(!(this instanceof Duplex$1))return new Duplex$1(e);Readable$3.call(this,e),Writable$1.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||nextTick$2(onEndNT,this)}function onEndNT(e){e.end()}function TransformState(e){this.afterTransform=function(t,r){return afterTransform(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function afterTransform(e,t,r){var n=e._transformState;n.transforming=!1;var i=n.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!==r&&void 0!==r&&e.push(r),i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}function Transform$2(e){if(!(this instanceof Transform$2))return new Transform$2(e);Duplex$1.call(this,e),this._transformState=new TransformState(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e){done(t,e)}):done(t)})}function done(e,t){if(t)return e.emit("error",t);var r=e._writableState,n=e._transformState;if(r.length)throw new Error("Calling transform done when ws.length != 0");if(n.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function PassThrough$1(e){if(!(this instanceof PassThrough$1))return new PassThrough$1(e);Transform$2.call(this,e)}function Stream$1(){EventEmitter.call(this)}inherits$3(Transform$2,Duplex$1),Transform$2.prototype.push=function(e,t){return this._transformState.needTransform=!1,Duplex$1.prototype.push.call(this,e,t)},Transform$2.prototype._transform=function(e,t,r){throw new Error("Not implemented")},Transform$2.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform$2.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},inherits$3(PassThrough$1,Transform$2),PassThrough$1.prototype._transform=function(e,t,r){r(null,e)},inherits$3(Stream$1,EventEmitter),Stream$1.Readable=Readable$3,Stream$1.Writable=Writable$1,Stream$1.Duplex=Duplex$1,Stream$1.Transform=Transform$2,Stream$1.PassThrough=PassThrough$1,Stream$1.Stream=Stream$1,Stream$1.prototype.pipe=function(e,t){var r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function i(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",i),e._isStdio||t&&!1===t.end||(r.on("end",a),r.on("close",s));var o=!1;function a(){o||(o=!0,e.end())}function s(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(c(),0===EventEmitter.listenerCount(this,"error"))throw e}function c(){r.removeListener("data",n),e.removeListener("drain",i),r.removeListener("end",a),r.removeListener("close",s),r.removeListener("error",u),e.removeListener("error",u),r.removeListener("end",c),r.removeListener("close",c),e.removeListener("close",c)}return r.on("error",u),e.on("error",u),r.on("end",c),r.on("close",c),e.on("close",c),e.emit("pipe",r),e};var stream=Object.freeze({default:Stream$1,Readable:Readable$3,Writable:Writable$1,Duplex:Duplex$1,Transform:Transform$2,PassThrough:PassThrough$1,Stream:Stream$1}),processNextickArgs=createCommonjsModule(function(e){!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?e.exports=function(e,t,r,n){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var i,o,a=arguments.length;switch(a){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,t)});case 3:return process.nextTick(function(){e.call(null,t,r)});case 4:return process.nextTick(function(){e.call(null,t,r,n)});default:for(i=new Array(a-1),o=0;o<i.length;)i[o++]=arguments[o];return process.nextTick(function(){e.apply(null,i)})}}:e.exports=process.nextTick}),toString$1={}.toString,isarray=Array.isArray||function(e){return"[object Array]"==toString$1.call(e)},require$$0$5=stream&&Stream$1||stream,stream$1=require$$0$5,safeBuffer=createCommonjsModule(function(e,t){var r=bufferEs6.Buffer;function n(e,t){for(var r in e)t[r]=e[r]}function i(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=bufferEs6:(n(bufferEs6,t),t.Buffer=i),n(r,i),i.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},i.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=r(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},i.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},i.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return bufferEs6.SlowBuffer(e)}}),safeBuffer_1=safeBuffer.Buffer;function isArray$2(e){return Array.isArray?Array.isArray(e):"[object Array]"===objectToString$1(e)}var isArray_1=isArray$2;function isBoolean$1(e){return"boolean"==typeof e}var isBoolean_1=isBoolean$1;function isNull$1(e){return null===e}var isNull_1=isNull$1;function isNullOrUndefined$1(e){return null==e}var isNullOrUndefined_1=isNullOrUndefined$1;function isNumber$1(e){return"number"==typeof e}var isNumber_1=isNumber$1;function isString$1(e){return"string"==typeof e}var isString_1=isString$1;function isSymbol$1(e){return"symbol"==typeof e}var isSymbol_1=isSymbol$1;function isUndefined$1(e){return void 0===e}var isUndefined_1=isUndefined$1;function isRegExp$1(e){return"[object RegExp]"===objectToString$1(e)}var isRegExp_1=isRegExp$1;function isObject$1(e){return"object"==typeof e&&null!==e}var isObject_1=isObject$1;function isDate$1(e){return"[object Date]"===objectToString$1(e)}var isDate_1=isDate$1;function isError$1(e){return"[object Error]"===objectToString$1(e)||e instanceof Error}var isError_1=isError$1;function isFunction$2(e){return"function"==typeof e}var isFunction_1=isFunction$2;function isPrimitive$1(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}var isPrimitive_1=isPrimitive$1,isBuffer$2=Buffer.isBuffer;function objectToString$1(e){return Object.prototype.toString.call(e)}var util$3={isArray:isArray_1,isBoolean:isBoolean_1,isNull:isNull_1,isNullOrUndefined:isNullOrUndefined_1,isNumber:isNumber_1,isString:isString_1,isSymbol:isSymbol_1,isUndefined:isUndefined_1,isRegExp:isRegExp_1,isObject:isObject_1,isDate:isDate_1,isError:isError_1,isFunction:isFunction_1,isPrimitive:isPrimitive_1,isBuffer:isBuffer$2};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Buffer$4=safeBuffer.Buffer;function copyBuffer(e,t,r){e.copy(t,r)}var BufferList$2=function(){function e(){_classCallCheck(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return Buffer$4.alloc(0);if(1===this.length)return this.head.data;for(var t=Buffer$4.allocUnsafe(e>>>0),r=this.head,n=0;r;)copyBuffer(r.data,t,n),n+=r.data.length,r=r.next;return t},e}();function destroy(e,t){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;n||i?t?t(e):!e||this._writableState&&this._writableState.errorEmitted||processNextickArgs(emitErrorNT,this,e):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(processNextickArgs(emitErrorNT,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)}))}function undestroy(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function emitErrorNT(e,t){e.emit("error",t)}var destroy_1={destroy:destroy,undestroy:undestroy},node$2=util$2.deprecate,_stream_writable=Writable$2;function CorkedRequest$1(e){var t=this;this.next=null,this.entry=null,this.finish=function(){onCorkedFinish(t,e)}}var asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:processNextickArgs,Duplex$4;Writable$2.WritableState=WritableState$1,util$3.inherits=inherits;var internalUtil={deprecate:node$2},Buffer$5=safeBuffer.Buffer,OurUint8Array$1=commonjsGlobal.Uint8Array||function(){},realHasInstance;function _uint8ArrayToBuffer$1(e){return Buffer$5.from(e)}function _isUint8Array$1(e){return Buffer$5.isBuffer(e)||e instanceof OurUint8Array$1}function nop$1(){}function WritableState$1(e,t){Duplex$4=Duplex$4||_stream_duplex,e=e||{},this.objectMode=!!e.objectMode,t instanceof Duplex$4&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=!1===e.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite$1(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest$1(this)}function Writable$2(e){if(Duplex$4=Duplex$4||_stream_duplex,!(realHasInstance.call(Writable$2,this)||this instanceof Duplex$4))return new Writable$2(e);this._writableState=new WritableState$1(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),stream$1.call(this)}function writeAfterEnd$1(e,t){var r=new Error("write after end");e.emit("error",r),processNextickArgs(t,r)}function validChunk$1(e,t,r,n){var i=!0,o=!1;return null===r?o=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),processNextickArgs(n,o),i=!1),i}function decodeChunk$1(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=Buffer$5.from(t,r)),t}function writeOrBuffer$1(e,t,r,n,i,o){if(!r){var a=decodeChunk$1(t,n,i);n!==a&&(r=!0,i="buffer",n=a)}var s=t.objectMode?1:n.length;t.length+=s;var u=t.length<t.highWaterMark;if(u||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else doWrite$1(e,t,!1,s,n,i,o);return u}function doWrite$1(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function onwriteError$1(e,t,r,n,i){--t.pendingcb,r?(processNextickArgs(i,n),processNextickArgs(finishMaybe$1,e,t),e._writableState.errorEmitted=!0,e.emit("error",n)):(i(n),e._writableState.errorEmitted=!0,e.emit("error",n),finishMaybe$1(e,t))}function onwriteStateUpdate$1(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite$1(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(onwriteStateUpdate$1(r),t)onwriteError$1(e,r,n,t,i);else{var o=needFinish$1(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||clearBuffer$1(e,r),n?asyncWrite(afterWrite$1,e,r,o,i):afterWrite$1(e,r,o,i)}}function afterWrite$1(e,t,r,n){r||onwriteDrain$1(e,t),t.pendingcb--,n(),finishMaybe$1(e,t)}function onwriteDrain$1(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer$1(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var a=0,s=!0;r;)i[a]=r,r.isBuf||(s=!1),r=r.next,a+=1;i.allBuffers=s,doWrite$1(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new CorkedRequest$1(t)}else{for(;r;){var u=r.chunk,c=r.encoding,l=r.callback;if(doWrite$1(e,t,!1,t.objectMode?1:u.length,u,c,l),r=r.next,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=r,t.bufferProcessing=!1}function needFinish$1(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function callFinal(e,t){e._final(function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),finishMaybe$1(e,t)})}function prefinish$1(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,processNextickArgs(callFinal,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function finishMaybe$1(e,t){var r=needFinish$1(t);return r&&(prefinish$1(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}function endWritable$1(e,t,r){t.ending=!0,finishMaybe$1(e,t),r&&(t.finished?processNextickArgs(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function onCorkedFinish(e,t,r){var n=e.entry;for(e.entry=null;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}util$3.inherits(Writable$2,stream$1),WritableState$1.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(WritableState$1.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable$2,Symbol.hasInstance,{value:function(e){return!!realHasInstance.call(this,e)||e&&e._writableState instanceof WritableState$1}})):realHasInstance=function(e){return e instanceof this},Writable$2.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Writable$2.prototype.write=function(e,t,r){var n=this._writableState,i=!1,o=_isUint8Array$1(e)&&!n.objectMode;return o&&!Buffer$5.isBuffer(e)&&(e=_uint8ArrayToBuffer$1(e)),"function"==typeof t&&(r=t,t=null),o?t="buffer":t||(t=n.defaultEncoding),"function"!=typeof r&&(r=nop$1),n.ended?writeAfterEnd$1(this,r):(o||validChunk$1(this,n,e,r))&&(n.pendingcb++,i=writeOrBuffer$1(this,n,o,e,t,r)),i},Writable$2.prototype.cork=function(){this._writableState.corked++},Writable$2.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||clearBuffer$1(this,e))},Writable$2.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Writable$2.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},Writable$2.prototype._writev=null,Writable$2.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||endWritable$1(this,n,r)},Object.defineProperty(Writable$2.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),Writable$2.prototype.destroy=destroy_1.destroy,Writable$2.prototype._undestroy=destroy_1.undestroy,Writable$2.prototype._destroy=function(e,t){this.end(),t(e)};var objectKeys=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t},_stream_duplex=Duplex$3;util$3.inherits=inherits,util$3.inherits(Duplex$3,_stream_readable);for(var keys$3=objectKeys(_stream_writable.prototype),v$1=0;v$1<keys$3.length;v$1++){var method$1=keys$3[v$1];Duplex$3.prototype[method$1]||(Duplex$3.prototype[method$1]=_stream_writable.prototype[method$1])}function Duplex$3(e){if(!(this instanceof Duplex$3))return new Duplex$3(e);_stream_readable.call(this,e),_stream_writable.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend$1)}function onend$1(){this.allowHalfOpen||this._writableState.ended||processNextickArgs(onEndNT$1,this)}function onEndNT$1(e){e.end()}Object.defineProperty(Duplex$3.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),Duplex$3.prototype._destroy=function(e,t){this.push(null),this.end(),processNextickArgs(t,e)};var Buffer$6=safeBuffer.Buffer,isEncoding=Buffer$6.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _normalizeEncoding(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function normalizeEncoding(e){var t=_normalizeEncoding(e);if("string"!=typeof t&&(Buffer$6.isEncoding===isEncoding||!isEncoding(e)))throw new Error("Unknown encoding: "+e);return t||e}var StringDecoder_1=StringDecoder$2;function StringDecoder$2(e){var t;switch(this.encoding=normalizeEncoding(e),this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,t=4;break;case"utf8":this.fillLast=utf8FillLast,t=4;break;case"base64":this.text=base64Text,this.end=base64End,t=3;break;default:return this.write=simpleWrite,void(this.end=simpleEnd)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer$6.allocUnsafe(t)}function utf8CheckByte(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:-1}function utf8CheckIncomplete(e,t,r){var n=t.length-1;if(n<r)return 0;var i=utf8CheckByte(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r?0:(i=utf8CheckByte(t[n]))>=0?(i>0&&(e.lastNeed=i-2),i):--n<r?0:(i=utf8CheckByte(t[n]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}function utf8CheckExtraBytes(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"".repeat(r);if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"".repeat(r+1);if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"".repeat(r+2)}}function utf8FillLast(e){var t=this.lastTotal-this.lastNeed,r=utf8CheckExtraBytes(this,e,t);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function utf8Text(e,t){var r=utf8CheckIncomplete(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)}function utf8End(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"".repeat(this.lastTotal-this.lastNeed):t}function utf16Text(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function utf16End(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function base64Text(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function base64End(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function simpleWrite(e){return e.toString(this.encoding)}function simpleEnd(e){return e&&e.length?this.write(e):""}StringDecoder$2.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},StringDecoder$2.prototype.end=utf8End,StringDecoder$2.prototype.text=utf8Text,StringDecoder$2.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length};var string_decoder={StringDecoder:StringDecoder_1},require$$1$4=events&&EventEmitter||events,_stream_readable=Readable$4,Duplex$2;Readable$4.ReadableState=ReadableState$1;var EE=require$$1$4.EventEmitter,EElistenerCount=function(e,t){return e.listeners(t).length},Buffer$3=safeBuffer.Buffer,OurUint8Array=commonjsGlobal.Uint8Array||function(){};function _uint8ArrayToBuffer(e){return Buffer$3.from(e)}function _isUint8Array(e){return Buffer$3.isBuffer(e)||e instanceof OurUint8Array}util$3.inherits=inherits;var debug$4=void 0,StringDecoder$1;debug$4=util$2&&util$2.debuglog?util$2.debuglog("stream"):function(){},util$3.inherits(Readable$4,stream$1);var kProxyEvents=["error","close","destroy","pause","resume"];function prependListener$1(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?isarray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}function ReadableState$1(e,t){Duplex$2=Duplex$2||_stream_duplex,e=e||{},this.objectMode=!!e.objectMode,t instanceof Duplex$2&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new BufferList$2,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder$1||(StringDecoder$1=string_decoder.StringDecoder),this.decoder=new StringDecoder$1(e.encoding),this.encoding=e.encoding)}function Readable$4(e){if(Duplex$2=Duplex$2||_stream_duplex,!(this instanceof Readable$4))return new Readable$4(e);this._readableState=new ReadableState$1(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),stream$1.call(this)}function readableAddChunk$1(e,t,r,n,i){var o,a=e._readableState;null===t?(a.reading=!1,onEofChunk$1(e,a)):(i||(o=chunkInvalid$1(a,t)),o?e.emit("error",o):a.objectMode||t&&t.length>0?("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===Buffer$3.prototype||(t=_uint8ArrayToBuffer(t)),n?a.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):addChunk(e,a,t,!0):a.ended?e.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!r?(t=a.decoder.write(t),a.objectMode||0!==t.length?addChunk(e,a,t,!1):maybeReadMore$1(e,a)):addChunk(e,a,t,!1))):n||(a.reading=!1));return needMoreData$1(a)}function addChunk(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&emitReadable$1(e)),maybeReadMore$1(e,t)}function chunkInvalid$1(e,t){var r;return _isUint8Array(t)||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function needMoreData$1(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}Object.defineProperty(Readable$4.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),Readable$4.prototype.destroy=destroy_1.destroy,Readable$4.prototype._undestroy=destroy_1.undestroy,Readable$4.prototype._destroy=function(e,t){this.push(null),t(e)},Readable$4.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=Buffer$3.from(e,t),t=""),r=!0),readableAddChunk$1(this,e,t,!1,r)},Readable$4.prototype.unshift=function(e){return readableAddChunk$1(this,e,null,!0,!1)},Readable$4.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable$4.prototype.setEncoding=function(e){return StringDecoder$1||(StringDecoder$1=string_decoder.StringDecoder),this._readableState.decoder=new StringDecoder$1(e),this._readableState.encoding=e,this};var MAX_HWM$1=8388608;function computeNewHighWaterMark$1(e){return e>=MAX_HWM$1?e=MAX_HWM$1:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function howMuchToRead$1(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=computeNewHighWaterMark$1(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function onEofChunk$1(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,emitReadable$1(e)}}function emitReadable$1(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug$4("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?processNextickArgs(emitReadable_$1,e):emitReadable_$1(e))}function emitReadable_$1(e){debug$4("emit readable"),e.emit("readable"),flow$1(e)}function maybeReadMore$1(e,t){t.readingMore||(t.readingMore=!0,processNextickArgs(maybeReadMore_$1,e,t))}function maybeReadMore_$1(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(debug$4("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function pipeOnDrain$1(e){return function(){var t=e._readableState;debug$4("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&EElistenerCount(e,"data")&&(t.flowing=!0,flow$1(e))}}function nReadingNextTick$1(e){debug$4("readable nexttick read 0"),e.read(0)}function resume$1(e,t){t.resumeScheduled||(t.resumeScheduled=!0,processNextickArgs(resume_$1,e,t))}function resume_$1(e,t){t.reading||(debug$4("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),flow$1(e),t.flowing&&!t.reading&&e.read(0)}function flow$1(e){var t=e._readableState;for(debug$4("flow",t.flowing);t.flowing&&null!==e.read(););}function fromList$1(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=fromListPartial$1(e,t.buffer,t.decoder),r);var r}function fromListPartial$1(e,t,r){var n;return e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?copyFromBufferString$1(e,t):copyFromBuffer$1(e,t),n}function copyFromBufferString$1(e,t){var r=t.head,n=1,i=r.data;for(e-=i.length;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(a===o.length?i+=o:i+=o.slice(0,e),0===(e-=a)){a===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++n}return t.length-=n,i}function copyFromBuffer$1(e,t){var r=Buffer$3.allocUnsafe(e),n=t.head,i=1;for(n.data.copy(r),e-=n.data.length;n=n.next;){var o=n.data,a=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,a),0===(e-=a)){a===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(a));break}++i}return t.length-=i,r}function endReadable$1(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,processNextickArgs(endReadableNT$1,t,e))}function endReadableNT$1(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function indexOf$2(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}Readable$4.prototype.read=function(e){debug$4("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return debug$4("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable$1(this):emitReadable$1(this),null;if(0===(e=howMuchToRead$1(e,t))&&t.ended)return 0===t.length&&endReadable$1(this),null;var n,i=t.needReadable;return debug$4("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&debug$4("length less than watermark",i=!0),t.ended||t.reading?debug$4("reading or ended",i=!1):i&&(debug$4("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=howMuchToRead$1(r,t))),null===(n=e>0?fromList$1(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&endReadable$1(this)),null!==n&&this.emit("data",n),n},Readable$4.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},Readable$4.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,debug$4("pipe count=%d opts=%j",n.pipesCount,t);var i=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?a:p;function o(t,i){debug$4("onunpipe"),t===r&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,debug$4("cleanup"),e.removeListener("close",d),e.removeListener("finish",h),e.removeListener("drain",s),e.removeListener("error",f),e.removeListener("unpipe",o),r.removeListener("end",a),r.removeListener("end",p),r.removeListener("data",l),u=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||s())}function a(){debug$4("onend"),e.end()}n.endEmitted?processNextickArgs(i):r.once("end",i),e.on("unpipe",o);var s=pipeOnDrain$1(r);e.on("drain",s);var u=!1;var c=!1;function l(t){debug$4("ondata"),c=!1,!1!==e.write(t)||c||((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==indexOf$2(n.pipes,e))&&!u&&(debug$4("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,c=!0),r.pause())}function f(t){debug$4("onerror",t),p(),e.removeListener("error",f),0===EElistenerCount(e,"error")&&e.emit("error",t)}function d(){e.removeListener("finish",h),p()}function h(){debug$4("onfinish"),e.removeListener("close",d),p()}function p(){debug$4("unpipe"),r.unpipe(e)}return r.on("data",l),prependListener$1(e,"error",f),e.once("close",d),e.once("finish",h),e.emit("pipe",r),n.flowing||(debug$4("pipe resume"),r.resume()),e},Readable$4.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,r);return this}var a=indexOf$2(t.pipes,e);return-1===a?this:(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},Readable$4.prototype.on=function(e,t){var r=stream$1.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&emitReadable$1(this):processNextickArgs(nReadingNextTick$1,this))}return r},Readable$4.prototype.addListener=Readable$4.prototype.on,Readable$4.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug$4("resume"),e.flowing=!0,resume$1(this,e)),this},Readable$4.prototype.pause=function(){return debug$4("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug$4("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable$4.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;e.on("end",function(){if(debug$4("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),e.on("data",function(i){(debug$4("wrapped data"),t.decoder&&(i=t.decoder.write(i)),!t.objectMode||null!==i&&void 0!==i)&&((t.objectMode||i&&i.length)&&(n.push(i)||(r=!0,e.pause())))});for(var i in e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<kProxyEvents.length;o++)e.on(kProxyEvents[o],n.emit.bind(n,kProxyEvents[o]));return n._read=function(t){debug$4("wrapped _read",t),r&&(r=!1,e.resume())},n},Readable$4._fromList=fromList$1;var _stream_transform=Transform$3;function TransformState$1(e){this.afterTransform=function(t,r){return afterTransform$1(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function afterTransform$1(e,t,r){var n=e._transformState;n.transforming=!1;var i=n.writecb;if(!i)return e.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!==r&&void 0!==r&&e.push(r),i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}function Transform$3(e){if(!(this instanceof Transform$3))return new Transform$3(e);_stream_duplex.call(this,e),this._transformState=new TransformState$1(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e,r){done$1(t,e,r)}):done$1(t)})}function done$1(e,t,r){if(t)return e.emit("error",t);null!==r&&void 0!==r&&e.push(r);var n=e._writableState,i=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}util$3.inherits=inherits,util$3.inherits(Transform$3,_stream_duplex),Transform$3.prototype.push=function(e,t){return this._transformState.needTransform=!1,_stream_duplex.prototype.push.call(this,e,t)},Transform$3.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},Transform$3.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform$3.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},Transform$3.prototype._destroy=function(e,t){var r=this;_stream_duplex.prototype._destroy.call(this,e,function(e){t(e),r.emit("close")})};var _stream_passthrough=PassThrough$2;function PassThrough$2(e){if(!(this instanceof PassThrough$2))return new PassThrough$2(e);_stream_transform.call(this,e)}util$3.inherits=inherits,util$3.inherits(PassThrough$2,_stream_transform),PassThrough$2.prototype._transform=function(e,t,r){r(null,e)};var readable=createCommonjsModule(function(e,t){"disable"===process.env.READABLE_STREAM&&require$$0$5?(e.exports=require$$0$5,(t=e.exports=require$$0$5.Readable).Readable=require$$0$5.Readable,t.Writable=require$$0$5.Writable,t.Duplex=require$$0$5.Duplex,t.Transform=require$$0$5.Transform,t.PassThrough=require$$0$5.PassThrough,t.Stream=require$$0$5):((t=e.exports=_stream_readable).Stream=require$$0$5||t,t.Readable=t,t.Writable=_stream_writable,t.Duplex=_stream_duplex,t.Transform=_stream_transform,t.PassThrough=_stream_passthrough)}),readable_1=readable.Readable,readable_2=readable.Writable,readable_3=readable.Duplex,readable_4=readable.Transform,readable_5=readable.PassThrough,readable_6=readable.Stream,Readable$1=readable.Readable,levelIteratorStream=ReadStream$2;function ReadStream$2(e,t){if(!(this instanceof ReadStream$2))return new ReadStream$2(e,t);t=t||{},Readable$1.call(this,immutable(t,{objectMode:!0})),this._iterator=e,this._destroyed=!1,this._options=t,this.on("end",this._cleanup.bind(this))}inherits(ReadStream$2,Readable$1),ReadStream$2.prototype._read=function(){var e=this,t=this._options;this._destroyed||this._iterator.next(function(r,n,i){if(!e._destroyed)return r?e.emit("error",r):void(void 0===n&&void 0===i?e.push(null):!1!==t.keys&&!1===t.values?e.push(n):!1===t.keys&&!1!==t.values?e.push(i):e.push({key:n,value:i}))})},ReadStream$2.prototype.destroy=ReadStream$2.prototype._cleanup=function(){var e=this;this._destroyed||(this._destroyed=!0,this._iterator.end(function(t){if(t)return e.emit("error",t);e.emit("close")}))};var prr=createCommonjsModule(function(e){var t,r;t=commonjsGlobal,r=function(){var e="function"==typeof Object.defineProperty?function(e,t,r){return Object.defineProperty(e,t,r),e}:function(e,t,r){return e[t]=r.value,e};return function(t,r,n,i){var o,a,s,u,c,l;if(a=n,c=!(u="object"==typeof(s=i))&&"string"==typeof s,i={enumerable:(l=function(e){return u?!!s[e]:!!c&&s.indexOf(e[0])>-1})("enumerable"),configurable:l("configurable"),writable:l("writable"),value:a},"object"==typeof r){for(o in r)Object.hasOwnProperty.call(r,o)&&(i.value=r[o],e(t,o,i));return t}return e(t,r,i)}},e.exports?e.exports=r():t.prr=r()});function init$2(e,t,r){prr(this,{type:e,name:e,cause:"string"!=typeof t?t:r,message:t&&"string"!=typeof t?t.message:t},"ewr")}function CustomError(e,t){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),init$2.call(this,"CustomError",e,t)}function createError$2(e,t,r){var n=function(r,i){init$2.call(this,t,r,i),"FilesystemError"==t&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(e.errno[this.cause.errno]?e.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,n)};return n.prototype=r?new r:new CustomError,n}CustomError.prototype=new Error;var custom=function(e){var t=function(t,r){return createError$2(e,t,r)};return{CustomError:CustomError,FilesystemError:t("FilesystemError"),createError:t}},errno=createCommonjsModule(function(e){var t=e.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];e.exports.errno={},e.exports.code={},t.forEach(function(t){e.exports.errno[t.errno]=t,e.exports.code[t.code]=t}),e.exports.custom=custom(e.exports),e.exports.create=e.exports.custom.createError}),errno_1=errno.all,errno_2=errno.errno,errno_3=errno.code,errno_4=errno.custom,errno_5=errno.create,createError$1=errno.create,LevelUPError=createError$1("LevelUPError"),NotFoundError$2$1=createError$1("NotFoundError",LevelUPError);NotFoundError$2$1.prototype.notFound=!0,NotFoundError$2$1.prototype.status=404;var errors={LevelUPError:LevelUPError,InitializationError:createError$1("InitializationError",LevelUPError),OpenError:createError$1("OpenError",LevelUPError),ReadError:createError$1("ReadError",LevelUPError),WriteError:createError$1("WriteError",LevelUPError),NotFoundError:NotFoundError$2$1,EncodingError:createError$1("EncodingError",LevelUPError)};function promisify(){var e,t=new Promise(function(t,r){e=function(e,n){e?r(e):t(n)}});return e.promise=t,e}var promisify_1=promisify,WriteError$1=errors.WriteError;function Batch(e){this._levelup=e,this.batch=e.db.batch(),this.ops=[],this.length=0}Batch.prototype.put=function(e,t){try{this.batch.put(e,t)}catch(e){throw new WriteError$1(e)}return this.ops.push({type:"put",key:e,value:t}),this.length++,this},Batch.prototype.del=function(e){try{this.batch.del(e)}catch(e){throw new WriteError$1(e)}return this.ops.push({type:"del",key:e}),this.length++,this},Batch.prototype.clear=function(){try{this.batch.clear()}catch(e){throw new WriteError$1(e)}return this.ops=[],this.length=0,this},Batch.prototype.write=function(e){var t,r=this._levelup,n=this.ops;e||(t=(e=promisify_1()).promise);try{this.batch.write(function(t){if(t)return e(new WriteError$1(t));r.emit("batch",n),e()})}catch(e){throw new WriteError$1(e)}return t};var batch=Batch;function compare$1$1(e,t){if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0}var hasOwn=Object.prototype.hasOwnProperty,objectKeys$1=Object.keys||function(e){var t=[];for(var r in e)hasOwn.call(e,r)&&t.push(r);return t},pSlice=Array.prototype.slice,_functionsHaveNames;function functionsHaveNames(){return void 0!==_functionsHaveNames?_functionsHaveNames:_functionsHaveNames="foo"===function(){}.name}function pToString(e){return Object.prototype.toString.call(e)}function isView(e){return!isBuffer(e)&&("function"==typeof global.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}function assert(e,t){e||fail(e,!0,t,"==",ok)}var regex=/\s*function\s+([^\(\s]*)\s*/;function getName(e){if(isFunction$1(e)){if(functionsHaveNames())return e.name;var t=e.toString().match(regex);return t&&t[1]}}function AssertionError(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=getMessage(this),this.generatedMessage=!0);var t=e.stackStartFunction||fail;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var r=new Error;if(r.stack){var n=r.stack,i=getName(t),o=n.indexOf("\n"+i);if(o>=0){var a=n.indexOf("\n",o+1);n=n.substring(a+1)}this.stack=n}}}function truncate(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function inspect$1(e){if(functionsHaveNames()||!isFunction$1(e))return inspect(e);var t=getName(e);return"[Function"+(t?": "+t:"")+"]"}function getMessage(e){return truncate(inspect$1(e.actual),128)+" "+e.operator+" "+truncate(inspect$1(e.expected),128)}function fail(e,t,r,n,i){throw new AssertionError({message:r,actual:e,expected:t,operator:n,stackStartFunction:i})}function ok(e,t){e||fail(e,!0,t,"==",ok)}function equal(e,t,r){e!=t&&fail(e,t,r,"==",equal)}function notEqual(e,t,r){e==t&&fail(e,t,r,"!=",notEqual)}function deepEqual(e,t,r){_deepEqual(e,t,!1)||fail(e,t,r,"deepEqual",deepEqual)}function deepStrictEqual(e,t,r){_deepEqual(e,t,!0)||fail(e,t,r,"deepStrictEqual",deepStrictEqual)}function _deepEqual(e,t,r,n){if(e===t)return!0;if(isBuffer(e)&&isBuffer(t))return 0===compare$1$1(e,t);if(isDate(e)&&isDate(t))return e.getTime()===t.getTime();if(isRegExp(e)&&isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(isView(e)&&isView(t)&&pToString(e)===pToString(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===compare$1$1(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(isBuffer(e)!==isBuffer(t))return!1;var i=(n=n||{actual:[],expected:[]}).actual.indexOf(e);return-1!==i&&i===n.expected.indexOf(t)||(n.actual.push(e),n.expected.push(t),objEquiv(e,t,r,n))}return r?e===t:e==t}function isArguments(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function objEquiv(e,t,r,n){if(null===e||void 0===e||null===t||void 0===t)return!1;if(isPrimitive(e)||isPrimitive(t))return e===t;if(r&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=isArguments(e),o=isArguments(t);if(i&&!o||!i&&o)return!1;if(i)return _deepEqual(e=pSlice.call(e),t=pSlice.call(t),r);var a,s,u=objectKeys$1(e),c=objectKeys$1(t);if(u.length!==c.length)return!1;for(u.sort(),c.sort(),s=u.length-1;s>=0;s--)if(u[s]!==c[s])return!1;for(s=u.length-1;s>=0;s--)if(!_deepEqual(e[a=u[s]],t[a],r,n))return!1;return!0}function notDeepEqual(e,t,r){_deepEqual(e,t,!1)&&fail(e,t,r,"notDeepEqual",notDeepEqual)}function notDeepStrictEqual(e,t,r){_deepEqual(e,t,!0)&&fail(e,t,r,"notDeepStrictEqual",notDeepStrictEqual)}function strictEqual(e,t,r){e!==t&&fail(e,t,r,"===",strictEqual)}function notStrictEqual(e,t,r){e===t&&fail(e,t,r,"!==",notStrictEqual)}function expectedException(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function _tryBlock(e){var t;try{e()}catch(e){t=e}return t}function _throws(e,t,r,n){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(n=r,r=null),i=_tryBlock(t),n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),e&&!i&&fail(i,r,"Missing expected exception"+n);var o="string"==typeof n,a=!e&&isError(i),s=!e&&i&&!r;if((a&&o&&expectedException(i,r)||s)&&fail(i,r,"Got unwanted exception"+n),e&&i&&r&&!expectedException(i,r)||!e&&i)throw i}function throws(e,t,r){_throws(!0,e,t,r)}function doesNotThrow(e,t,r){_throws(!1,e,t,r)}function ifError(e){if(e)throw e}assert.AssertionError=AssertionError,inherits$3(AssertionError,Error),assert.fail=fail,assert.ok=ok,assert.equal=equal,assert.notEqual=notEqual,assert.deepEqual=deepEqual,assert.deepStrictEqual=deepStrictEqual,assert.notDeepEqual=notDeepEqual,assert.notDeepStrictEqual=notDeepStrictEqual,assert.strictEqual=strictEqual,assert.notStrictEqual=notStrictEqual,assert.throws=throws,assert.doesNotThrow=doesNotThrow,assert.ifError=ifError;var assert$2=Object.freeze({default:assert,AssertionError:AssertionError,fail:fail,ok:ok,assert:ok,equal:equal,notEqual:notEqual,deepEqual:deepEqual,deepStrictEqual:deepStrictEqual,notDeepEqual:notDeepEqual,notDeepStrictEqual:notDeepStrictEqual,strictEqual:strictEqual,notStrictEqual:notStrictEqual,throws:throws,doesNotThrow:doesNotThrow,ifError:ifError}),assert$3=assert$2&&assert||assert$2,EventEmitter$2=require$$1$4.EventEmitter,inherits$4=util$2.inherits,WriteError=errors.WriteError,ReadError=errors.ReadError,NotFoundError$1=errors.NotFoundError,OpenError=errors.OpenError,InitializationError=errors.InitializationError;function LevelUP(e,t,r){if(!(this instanceof LevelUP))return new LevelUP(e,t,r);var n;if(EventEmitter$2.call(this),this.setMaxListeners(1/0),"function"==typeof t&&(r=t,t={}),t=t||{},!e||"object"!=typeof e){if(n=new InitializationError("Must provide db"),"function"==typeof r)return process.nextTick(r,n);throw n}assert$3.equal(typeof e.status,"string",".status required, old abstract-leveldown"),this.options=getOptions(t),this._db=e,this.db=new deferredLeveldown(e),this.open(r)}function getCallback(e,t){return"function"==typeof e?e:t}function getOptions(e){return"object"==typeof e&&null!==e?e:{}}function maybeError(e,t){if(!e._isOpening()&&!e.isOpen())return process.nextTick(t,new ReadError("Database is not open")),!0}LevelUP.prototype.emit=EventEmitter$2.prototype.emit,LevelUP.prototype.once=EventEmitter$2.prototype.once,inherits$4(LevelUP,EventEmitter$2),LevelUP.prototype.open=function(e){var t,r=this;return e||(t=(e=promisify_1()).promise),this.isOpen()?(process.nextTick(e,null,r),t):this._isOpening()?(this.once("open",function(){e(null,r)}),t):(this.emit("opening"),this.db.open(this.options,function(t){if(t)return e(new OpenError(t));r.db=r._db,e(null,r),r.emit("open"),r.emit("ready")}),t)},LevelUP.prototype.close=function(e){var t,r=this;return e||(t=(e=promisify_1()).promise),this.isOpen()?(this.db.close(function(){r.emit("closed"),e.apply(null,arguments)}),this.emit("closing"),this.db=new deferredLeveldown(this._db)):this.isClosed()?process.nextTick(e):"closing"===this.db.status?this.once("closed",e):this._isOpening()&&this.once("open",function(){r.close(e)}),t},LevelUP.prototype.isOpen=function(){return"open"===this.db.status},LevelUP.prototype._isOpening=function(){return"opening"===this.db.status},LevelUP.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)},LevelUP.prototype.get=function(e,t,r){if(null===e||void 0===e)throw new ReadError("get() requires a key argument");var n;return(r=getCallback(t,r))||(n=(r=promisify_1()).promise),maybeError(this,r)?n:(t=getOptions(t),this.db.get(e,t,function(t,n){if(t)return t=/notfound/i.test(t)||t.notFound?new NotFoundError$1("Key not found in database ["+e+"]",t):new ReadError(t),r(t);r(null,n)}),n)},LevelUP.prototype.put=function(e,t,r,n){if(null===e||void 0===e)throw new WriteError("put() requires a key argument");var i,o=this;return(n=getCallback(r,n))||(i=(n=promisify_1()).promise),maybeError(this,n)?i:(r=getOptions(r),this.db.put(e,t,r,function(r){if(r)return n(new WriteError(r));o.emit("put",e,t),n()}),i)},LevelUP.prototype.del=function(e,t,r){if(null===e||void 0===e)throw new WriteError("del() requires a key argument");var n,i=this;return(r=getCallback(t,r))||(n=(r=promisify_1()).promise),maybeError(this,r)?n:(t=getOptions(t),this.db.del(e,t,function(t){if(t)return r(new WriteError(t));i.emit("del",e),r()}),n)},LevelUP.prototype.batch=function(e,t,r){if(!arguments.length)return new batch(this);if(!Array.isArray(e))throw new WriteError("batch() requires an array argument");var n,i=this;return(r=getCallback(t,r))||(n=(r=promisify_1()).promise),maybeError(this,r)?n:(t=getOptions(t),e=e.map(function(e){return e.type||void 0===e.key||void 0===e.value||(e.type="put"),e}),this.db.batch(e,t,function(t){if(t)return r(new WriteError(t));i.emit("batch",e),r()}),n)},LevelUP.prototype.readStream=LevelUP.prototype.createReadStream=function(e){return"number"!=typeof(e=immutable({keys:!0,values:!0},e)).limit&&(e.limit=-1),new levelIteratorStream(this.db.iterator(e),e)},LevelUP.prototype.keyStream=LevelUP.prototype.createKeyStream=function(e){return this.createReadStream(immutable(e,{keys:!0,values:!1}))},LevelUP.prototype.valueStream=LevelUP.prototype.createValueStream=function(e){return this.createReadStream(immutable(e,{keys:!1,values:!0}))},LevelUP.prototype.toString=function(){return"LevelUP"},LevelUP.errors=errors;var levelup=LevelUP.default=LevelUP,ltgt=createCommonjsModule(function(e,t){function r(e,t){return Object.hasOwnProperty.call(e,t)}function n(e){return void 0!==e&&""!==e}function r(e,t){return Object.hasOwnProperty.call(e,t)}function i(e,t){return Object.hasOwnProperty.call(e,t)&&t}t.compare=function(e,t){if(Buffer.isBuffer(e)){for(var r=Math.min(e.length,t.length),n=0;n<r;n++){var i=e[n]-t[n];if(i)return i}return e.length-t.length}return e<t?-1:e>t?1:0};var o=t.lowerBoundKey=function(e){return i(e,"gt")||i(e,"gte")||i(e,"min")||(e.reverse?i(e,"end"):i(e,"start"))||void 0},a=t.lowerBound=function(e,t){var r=o(e);return r?e[r]:t},s=t.lowerBoundInclusive=function(e){return!r(e,"gt")},u=t.upperBoundInclusive=function(e){return!r(e,"lt")},c=t.lowerBoundExclusive=function(e){return!s(e)},l=t.upperBoundExclusive=function(e){return!u(e)},f=t.upperBoundKey=function(e){return i(e,"lt")||i(e,"lte")||i(e,"max")||(e.reverse?i(e,"start"):i(e,"end"))||void 0},d=t.upperBound=function(e,t){var r=f(e);return r?e[r]:t};function h(e){return e}t.start=function(e,t){return e.reverse?d(e,t):a(e,t)},t.end=function(e,t){return e.reverse?a(e,t):d(e,t)},t.startInclusive=function(e){return e.reverse?u(e):s(e)},t.endInclusive=function(e){return e.reverse?s(e):u(e)},t.toLtgt=function(e,n,i,o,a){n=n||{},i=i||h;var s=arguments.length>3,u=t.lowerBoundKey(e),c=t.upperBoundKey(e);return u?"gt"===u?n.gt=i(e.gt,!1):n.gte=i(e[u],!1):s&&(n.gte=i(o,!1)),c?"lt"===c?n.lt=i(e.lt,!0):n.lte=i(e[c],!0):s&&(n.lte=i(a,!0)),null!=e.reverse&&(n.reverse=!!e.reverse),r(n,"max")&&delete n.max,r(n,"min")&&delete n.min,r(n,"start")&&delete n.start,r(n,"end")&&delete n.end,n},t.contains=function(e,r,i){i=i||t.compare;var o=a(e);if(n(o)&&((s=i(r,o))<0||0===s&&c(e)))return!1;var s,u=d(e);if(n(u)&&((s=i(r,u))>0||0===s&&l(e)))return!1;return!0},t.filter=function(e,r){return function(n){return t.contains(e,n,r)}}}),ltgt_1=ltgt.compare,ltgt_2=ltgt.lowerBoundKey,ltgt_3=ltgt.lowerBound,ltgt_4=ltgt.lowerBoundInclusive,ltgt_5=ltgt.upperBoundInclusive,ltgt_6=ltgt.lowerBoundExclusive,ltgt_7=ltgt.upperBoundExclusive,ltgt_8=ltgt.upperBoundKey,ltgt_9=ltgt.upperBound,ltgt_10=ltgt.start,ltgt_11=ltgt.end,ltgt_12=ltgt.startInclusive,ltgt_13=ltgt.endInclusive,ltgt_14=ltgt.toLtgt,ltgt_15=ltgt.contains,ltgt_16=ltgt.filter,encodings=createCommonjsModule(function(e,t){t.utf8=t["utf-8"]={encode:function(e){return n(e)?e:String(e)},decode:function(e){return"string"==typeof e?e:String(e)},buffer:!1,type:"utf8"},t.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"},t.binary={encode:function(e){return n(e)?e:new Buffer(e)},decode:r,buffer:!0,type:"binary"},t.none={encode:r,decode:r,buffer:!1,type:"id"},t.id=t.none;function r(e){return e}function n(e){return void 0===e||null===e||Buffer.isBuffer(e)}["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"].forEach(function(e){t[e]={encode:function(t){return n(t)?t:new Buffer(t,e)},decode:function(t){return t.toString(e)},buffer:!0,type:e}})}),encodings_1=encodings.utf8,encodings_2=encodings.json,encodings_3=encodings.binary,encodings_4=encodings.none,encodings_5=encodings.id,levelCodec=Codec;function Codec(e){this.opts=e||{},this.encodings=encodings}Codec.prototype._encoding=function(e){return"string"==typeof e&&(e=encodings[e]),e||(e=encodings.id),e},Codec.prototype._keyEncoding=function(e,t){return this._encoding(t&&t.keyEncoding||e&&e.keyEncoding||this.opts.keyEncoding)},Codec.prototype._valueEncoding=function(e,t){return this._encoding(t&&(t.valueEncoding||t.encoding)||e&&(e.valueEncoding||e.encoding)||this.opts.valueEncoding||this.opts.encoding)},Codec.prototype.encodeKey=function(e,t,r){return this._keyEncoding(t,r).encode(e)},Codec.prototype.encodeValue=function(e,t,r){return this._valueEncoding(t,r).encode(e)},Codec.prototype.decodeKey=function(e,t){return this._keyEncoding(t).decode(e)},Codec.prototype.decodeValue=function(e,t){return this._valueEncoding(t).decode(e)},Codec.prototype.encodeBatch=function(e,t){var r=this;return e.map(function(e){var n={type:e.type,key:r.encodeKey(e.key,t,e)};return r.keyAsBuffer(t,e)&&(n.keyEncoding="binary"),e.prefix&&(n.prefix=e.prefix),"value"in e&&(n.value=r.encodeValue(e.value,t,e),r.valueAsBuffer(t,e)&&(n.valueEncoding="binary")),n})};var ltgtKeys=["lt","gt","lte","gte","start","end"];Codec.prototype.encodeLtgt=function(e){var t=this,r={};return Object.keys(e).forEach(function(n){r[n]=ltgtKeys.indexOf(n)>-1?t.encodeKey(e[n],e):e[n]}),r},Codec.prototype.createStreamDecoder=function(e){var t=this;return e.keys&&e.values?function(r,n){return{key:t.decodeKey(r,e),value:t.decodeValue(n,e)}}:e.keys?function(r){return t.decodeKey(r,e)}:e.values?function(r,n){return t.decodeValue(n,e)}:function(){}},Codec.prototype.keyAsBuffer=function(e){return this._keyEncoding(e).buffer},Codec.prototype.valueAsBuffer=function(e){return this._valueEncoding(e).buffer};var isarray$2=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},string_decoder$2=createCommonjsModule(function(e,t){var r=bufferEs6.Buffer,n=r.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};var i=t.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!n(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=a;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=s;break;default:return void(this.write=o)}this.charBuffer=new r(6),this.charReceived=0,this.charLength=0};function o(e){return e.toString(this.encoding)}function a(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function s(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}i.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";if(e=e.slice(r,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var n=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,n),n-=this.charReceived);var i;n=(t+=e.toString(this.encoding,0,n)).length-1;if((i=t.charCodeAt(n))>=55296&&i<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,n)}return t},i.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},i.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,n=this.charBuffer,i=this.encoding;t+=n.slice(0,r).toString(i)}return t}}),string_decoder_1=string_decoder$2.StringDecoder,_stream_readable$2=Readable$6,Buffer$7=bufferEs6.Buffer;Readable$6.ReadableState=ReadableState$2;var EE$1=require$$1$4.EventEmitter,StringDecoder$3;function ReadableState$2(e,t){var r=(e=e||{}).highWaterMark;this.highWaterMark=r||0===r?r:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder$3||(StringDecoder$3=string_decoder$2.StringDecoder),this.decoder=new StringDecoder$3(e.encoding),this.encoding=e.encoding)}function Readable$6(e){if(!(this instanceof Readable$6))return new Readable$6(e);this._readableState=new ReadableState$2(e,this),this.readable=!0,require$$0$5.call(this)}function readableAddChunk$2(e,t,r,n,i){var o=chunkInvalid$2(t,r);if(o)e.emit("error",o);else if(null===r||void 0===r)t.reading=!1,t.ended||onEofChunk$2(e,t);else if(t.objectMode||r&&r.length>0)if(t.ended&&!i){var a=new Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&i){a=new Error("stream.unshift() after end event");e.emit("error",a)}else!t.decoder||i||n||(r=t.decoder.write(r)),t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):(t.reading=!1,t.buffer.push(r)),t.needReadable&&emitReadable$2(e),maybeReadMore$2(e,t);else i||(t.reading=!1);return needMoreData$2(t)}function needMoreData$2(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}EE$1.listenerCount||(EE$1.listenerCount=function(e,t){return e.listeners(t).length}),util$3.inherits=inherits,util$3.inherits(Readable$6,require$$0$5),Readable$6.prototype.push=function(e,t){var r=this._readableState;return"string"!=typeof e||r.objectMode||(t=t||r.defaultEncoding)!==r.encoding&&(e=new Buffer$7(e,t),t=""),readableAddChunk$2(this,r,e,t,!1)},Readable$6.prototype.unshift=function(e){return readableAddChunk$2(this,this._readableState,e,"",!0)},Readable$6.prototype.setEncoding=function(e){StringDecoder$3||(StringDecoder$3=string_decoder$2.StringDecoder),this._readableState.decoder=new StringDecoder$3(e),this._readableState.encoding=e};var MAX_HWM$2=8388608;function roundUpToNextPowerOf2(e){if(e>=MAX_HWM$2)e=MAX_HWM$2;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}function howMuchToRead$2(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:null===e||isNaN(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=roundUpToNextPowerOf2(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function chunkInvalid$2(e,t){var r=null;return Buffer$7.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function onEofChunk$2(e,t){if(t.decoder&&!t.ended){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.length>0?emitReadable$2(e):endReadable$2(e)}function emitReadable$2(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,t.sync?process.nextTick(function(){emitReadable_$2(e)}):emitReadable_$2(e))}function emitReadable_$2(e){e.emit("readable")}function maybeReadMore$2(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(function(){maybeReadMore_$2(e,t)}))}function maybeReadMore_$2(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function pipeOnDrain$2(e){return function(){var t=e._readableState;t.awaitDrain--,0===t.awaitDrain&&flow$2(e)}}function flow$2(e){var t,r=e._readableState;function n(e,n,i){!1===e.write(t)&&r.awaitDrain++}for(r.awaitDrain=0;r.pipesCount&&null!==(t=e.read());)if(1===r.pipesCount?n(r.pipes):forEach$4(r.pipes,n),e.emit("data",t),r.awaitDrain>0)return;if(0===r.pipesCount)return r.flowing=!1,void(EE$1.listenerCount(e,"data")>0&&emitDataEvents(e));r.ranOut=!0}function pipeOnReadable(){this._readableState.ranOut&&(this._readableState.ranOut=!1,flow$2(this))}function emitDataEvents(e,t){if(e._readableState.flowing)throw new Error("Cannot switch to old mode now.");var r=t||!1,n=!1;e.readable=!0,e.pipe=require$$0$5.prototype.pipe,e.on=e.addListener=require$$0$5.prototype.on,e.on("readable",function(){var t;for(n=!0;!r&&null!==(t=e.read());)e.emit("data",t);null===t&&(n=!1,e._readableState.needReadable=!0)}),e.pause=function(){r=!0,this.emit("pause")},e.resume=function(){r=!1,n?process.nextTick(function(){e.emit("readable")}):this.read(0),this.emit("resume")},e.emit("readable")}function fromList$2(e,t){var r,n=t.buffer,i=t.length,o=!!t.decoder,a=!!t.objectMode;if(0===n.length)return null;if(0===i)r=null;else if(a)r=n.shift();else if(!e||e>=i)r=o?n.join(""):Buffer$7.concat(n,i),n.length=0;else{if(e<n[0].length)r=(l=n[0]).slice(0,e),n[0]=l.slice(e);else if(e===n[0].length)r=n.shift();else{r=o?"":new Buffer$7(e);for(var s=0,u=0,c=n.length;u<c&&s<e;u++){var l=n[0],f=Math.min(e-s,l.length);o?r+=l.slice(0,f):l.copy(r,s,0,f),f<l.length?n[0]=l.slice(f):n.shift(),s+=f}}}return r}function endReadable$2(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");!t.endEmitted&&t.calledRead&&(t.ended=!0,process.nextTick(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function forEach$4(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}function indexOf$3(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}Readable$6.prototype.read=function(e){var t=this._readableState;t.calledRead=!0;var r,n=e;if(("number"!=typeof e||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return emitReadable$2(this),null;if(0===(e=howMuchToRead$2(e,t))&&t.ended)return r=null,t.length>0&&t.decoder&&(r=fromList$2(e,t),t.length-=r.length),0===t.length&&endReadable$2(this),r;var i=t.needReadable;return t.length-e<=t.highWaterMark&&(i=!0),(t.ended||t.reading)&&(i=!1),i&&(t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),i&&!t.reading&&(e=howMuchToRead$2(n,t)),null===(r=e>0?fromList$2(e,t):null)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),t.ended&&!t.endEmitted&&0===t.length&&endReadable$2(this),r},Readable$6.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Readable$6.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1;var i=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?a:u;function o(e){e===r&&u()}function a(){e.end()}n.endEmitted?process.nextTick(i):r.once("end",i),e.on("unpipe",o);var s=pipeOnDrain$2(r);function u(){e.removeListener("close",l),e.removeListener("finish",f),e.removeListener("drain",s),e.removeListener("error",c),e.removeListener("unpipe",o),r.removeListener("end",a),r.removeListener("end",u),e._writableState&&!e._writableState.needDrain||s()}function c(t){d(),e.removeListener("error",c),0===EE$1.listenerCount(e,"error")&&e.emit("error",t)}function l(){e.removeListener("finish",f),d()}function f(){e.removeListener("close",l),d()}function d(){r.unpipe(e)}return e.on("drain",s),e._events&&e._events.error?isarray$2(e._events.error)?e._events.error.unshift(c):e._events.error=[c,e._events.error]:e.on("error",c),e.once("close",l),e.once("finish",f),e.emit("pipe",r),n.flowing||(this.on("readable",pipeOnReadable),n.flowing=!0,process.nextTick(function(){flow$2(r)})),e},Readable$6.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,this.removeListener("readable",pipeOnReadable),t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,this.removeListener("readable",pipeOnReadable),t.flowing=!1;for(var i=0;i<n;i++)r[i].emit("unpipe",this);return this}return-1===(i=indexOf$3(t.pipes,e))?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Readable$6.prototype.on=function(e,t){var r=require$$0$5.prototype.on.call(this,e,t);if("data"!==e||this._readableState.flowing||emitDataEvents(this),"readable"===e&&this.readable){var n=this._readableState;n.readableListening||(n.readableListening=!0,n.emittedReadable=!1,n.needReadable=!0,n.reading?n.length&&emitReadable$2(this,n):this.read(0))}return r},Readable$6.prototype.addListener=Readable$6.prototype.on,Readable$6.prototype.resume=function(){emitDataEvents(this),this.read(0),this.emit("resume")},Readable$6.prototype.pause=function(){emitDataEvents(this,!0),this.emit("pause")},Readable$6.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;e.on("end",function(){if(t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),e.on("data",function(i){(t.decoder&&(i=t.decoder.write(i)),!t.objectMode||null!==i&&void 0!==i)&&((t.objectMode||i&&i.length)&&(n.push(i)||(r=!0,e.pause())))});for(var i in e)"function"==typeof e[i]&&void 0===this[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return forEach$4(["error","close","destroy","pause","resume"],function(t){e.on(t,n.emit.bind(n,t))}),n._read=function(t){r&&(r=!1,e.resume())},n},Readable$6._fromList=fromList$2;var _stream_duplex$2=Duplex$6,objectKeys$2=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};function Duplex$6(e){if(!(this instanceof Duplex$6))return new Duplex$6(e);_stream_readable$2.call(this,e),_stream_writable$2.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend$2)}function onend$2(){this.allowHalfOpen||this._writableState.ended||process.nextTick(this.end.bind(this))}function forEach$5(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}util$3.inherits=inherits,util$3.inherits(Duplex$6,_stream_readable$2),forEach$5(objectKeys$2(_stream_writable$2.prototype),function(e){Duplex$6.prototype[e]||(Duplex$6.prototype[e]=_stream_writable$2.prototype[e])});var _stream_writable$2=Writable$4,Buffer$8=bufferEs6.Buffer;function WriteReq$2(e,t,r){this.chunk=e,this.encoding=t,this.callback=r}function WritableState$2(e,t){var r=(e=e||{}).highWaterMark;this.highWaterMark=r||0===r?r:16384,this.objectMode=!!e.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var n=!1===e.decodeStrings;this.decodeStrings=!n,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite$2(t,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function Writable$4(e){if(!(this instanceof Writable$4||this instanceof _stream_duplex$2))return new Writable$4(e);this._writableState=new WritableState$2(e,this),this.writable=!0,require$$0$5.call(this)}function writeAfterEnd$2(e,t,r){var n=new Error("write after end");e.emit("error",n),process.nextTick(function(){r(n)})}function validChunk$2(e,t,r,n){var i=!0;if(!Buffer$8.isBuffer(r)&&"string"!=typeof r&&null!==r&&void 0!==r&&!t.objectMode){var o=new TypeError("Invalid non-string/buffer chunk");e.emit("error",o),process.nextTick(function(){n(o)}),i=!1}return i}function decodeChunk$2(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=new Buffer$8(t,r)),t}function writeOrBuffer$2(e,t,r,n,i){r=decodeChunk$2(t,r,n),Buffer$8.isBuffer(r)&&(n="buffer");var o=t.objectMode?1:r.length;t.length+=o;var a=t.length<t.highWaterMark;return a||(t.needDrain=!0),t.writing?t.buffer.push(new WriteReq$2(r,n,i)):doWrite$2(e,t,o,r,n,i),a}function doWrite$2(e,t,r,n,i,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,e._write(n,i,t.onwrite),t.sync=!1}function onwriteError$2(e,t,r,n,i){r?process.nextTick(function(){i(n)}):i(n),e._writableState.errorEmitted=!0,e.emit("error",n)}function onwriteStateUpdate$2(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite$2(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(onwriteStateUpdate$2(r),t)onwriteError$2(e,r,n,t,i);else{var o=needFinish$2(e,r);o||r.bufferProcessing||!r.buffer.length||clearBuffer$2(e,r),n?process.nextTick(function(){afterWrite$2(e,r,o,i)}):afterWrite$2(e,r,o,i)}}function afterWrite$2(e,t,r,n){r||onwriteDrain$2(e,t),n(),r&&finishMaybe$2(e,t)}function onwriteDrain$2(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer$2(e,t){t.bufferProcessing=!0;for(var r=0;r<t.buffer.length;r++){var n=t.buffer[r],i=n.chunk,o=n.encoding,a=n.callback;if(doWrite$2(e,t,t.objectMode?1:i.length,i,o,a),t.writing){r++;break}}t.bufferProcessing=!1,r<t.buffer.length?t.buffer=t.buffer.slice(r):t.buffer.length=0}function needFinish$2(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function finishMaybe$2(e,t){var r=needFinish$2(e,t);return r&&(t.finished=!0,e.emit("finish")),r}function endWritable$2(e,t,r){t.ending=!0,finishMaybe$2(e,t),r&&(t.finished?process.nextTick(r):e.once("finish",r)),t.ended=!0}Writable$4.WritableState=WritableState$2,util$3.inherits=inherits,util$3.inherits(Writable$4,require$$0$5),Writable$4.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},Writable$4.prototype.write=function(e,t,r){var n=this._writableState,i=!1;return"function"==typeof t&&(r=t,t=null),Buffer$8.isBuffer(e)?t="buffer":t||(t=n.defaultEncoding),"function"!=typeof r&&(r=function(){}),n.ended?writeAfterEnd$2(this,n,r):validChunk$2(this,n,e,r)&&(i=writeOrBuffer$2(this,n,e,t,r)),i},Writable$4.prototype._write=function(e,t,r){r(new Error("not implemented"))},Writable$4.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),void 0!==e&&null!==e&&this.write(e,t),n.ending||n.finished||endWritable$2(this,n,r)};var _stream_transform$2=Transform$5;function TransformState$2(e,t){this.afterTransform=function(e,r){return afterTransform$2(t,e,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function afterTransform$2(e,t,r){var n=e._transformState;n.transforming=!1;var i=n.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!==r&&void 0!==r&&e.push(r),i&&i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}function Transform$5(e){if(!(this instanceof Transform$5))return new Transform$5(e);_stream_duplex$2.call(this,e);this._transformState=new TransformState$2(e,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(e){done$2(t,e)}):done$2(t)})}function done$2(e,t){if(t)return e.emit("error",t);var r=e._writableState,n=(e._readableState,e._transformState);if(r.length)throw new Error("calling transform done when ws.length != 0");if(n.transforming)throw new Error("calling transform done when still transforming");return e.push(null)}util$3.inherits=inherits,util$3.inherits(Transform$5,_stream_duplex$2),Transform$5.prototype.push=function(e,t){return this._transformState.needTransform=!1,_stream_duplex$2.prototype.push.call(this,e,t)},Transform$5.prototype._transform=function(e,t,r){throw new Error("not implemented")},Transform$5.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform$5.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0};var _stream_passthrough$2=PassThrough$3;function PassThrough$3(e){if(!(this instanceof PassThrough$3))return new PassThrough$3(e);_stream_transform$2.call(this,e)}util$3.inherits=inherits,util$3.inherits(PassThrough$3,_stream_transform$2),PassThrough$3.prototype._transform=function(e,t,r){r(null,e)};var readable$2=createCommonjsModule(function(e,t){(t=e.exports=_stream_readable$2).Stream=require$$0$5,t.Readable=t,t.Writable=_stream_writable$2,t.Duplex=_stream_duplex$2,t.Transform=_stream_transform$2,t.PassThrough=_stream_passthrough$2}),readable_1$1=readable$2.Stream,readable_2$1=readable$2.Readable,readable_3$1=readable$2.Writable,readable_4$1=readable$2.Duplex,readable_5$1=readable$2.Transform,readable_6$1=readable$2.PassThrough,transform$2=readable.Transform,inherits$5=util$2.inherits;function DestroyableTransform(e){transform$2.call(this,e),this._destroyed=!1}function noop$4(e,t,r){r(null,e)}function through2(e){return function(t,r,n){return"function"==typeof t&&(n=r,r=t,t={}),"function"!=typeof r&&(r=noop$4),"function"!=typeof n&&(n=null),e(t,r,n)}}inherits$5(DestroyableTransform,transform$2),DestroyableTransform.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;process.nextTick(function(){e&&t.emit("error",e),t.emit("close")})}};var obj=through2(function(e,t,r){var n=new DestroyableTransform(immutable({objectMode:!0,highWaterMark:16},e));return n._transform=t,r&&(n._flush=r),n});function Deque(e){if(this._capacity=getCapacity(e),this._length=0,this._front=0,isArray$5(e)){for(var t=e.length,r=0;r<t;++r)this[r]=e[r];this._length=t}}Deque.prototype.toArray=function(){for(var e=this._length,t=new Array(e),r=this._front,n=this._capacity,i=0;i<e;++i)t[i]=this[r+i&n-1];return t},Deque.prototype.push=function(e){var t=arguments.length,r=this._length;if(t>1){var n=this._capacity;if(r+t>n){for(var i=0;i<t;++i){this._checkCapacity(r+1),this[o=this._front+r&this._capacity-1]=arguments[i],r++,this._length=r}return r}for(var o=this._front,i=0;i<t;++i)this[o+r&n-1]=arguments[i],o++;return this._length=r+t,r+t}return 0===t?r:(this._checkCapacity(r+1),this[i=this._front+r&this._capacity-1]=e,this._length=r+1,r+1)},Deque.prototype.pop=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1,r=this[t];return this[t]=void 0,this._length=e-1,r}},Deque.prototype.shift=function(){var e=this._length;if(0!==e){var t=this._front,r=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,r}},Deque.prototype.unshift=function(e){var t=this._length,r=arguments.length;if(r>1){if(t+r>(i=this._capacity)){for(var n=r-1;n>=0;n--){this._checkCapacity(t+1);var i=this._capacity;this[a=(this._front-1&i-1^i)-i]=arguments[n],t++,this._length=t,this._front=a}return t}var o=this._front;for(n=r-1;n>=0;n--){var a;this[a=(o-1&i-1^i)-i]=arguments[n],o=a}return this._front=o,this._length=t+r,t+r}if(0===r)return t;this._checkCapacity(t+1);i=this._capacity;return this[n=(this._front-1&i-1^i)-i]=e,this._length=t+1,this._front=n,t+1},Deque.prototype.peekBack=function(){var e=this._length;if(0!==e)return this[this._front+e-1&this._capacity-1]},Deque.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},Deque.prototype.get=function(e){var t=e;if(t===(0|t)){var r=this._length;if(t<0&&(t+=r),!(t<0||t>=r))return this[this._front+t&this._capacity-1]}},Deque.prototype.isEmpty=function(){return 0===this._length},Deque.prototype.clear=function(){for(var e=this._length,t=this._front,r=this._capacity,n=0;n<e;++n)this[t+n&r-1]=void 0;this._length=0,this._front=0},Deque.prototype.toString=function(){return this.toArray().toString()},Deque.prototype.valueOf=Deque.prototype.toString,Deque.prototype.removeFront=Deque.prototype.shift,Deque.prototype.removeBack=Deque.prototype.pop,Deque.prototype.insertFront=Deque.prototype.unshift,Deque.prototype.insertBack=Deque.prototype.push,Deque.prototype.enqueue=Deque.prototype.push,Deque.prototype.dequeue=Deque.prototype.shift,Deque.prototype.toJSON=Deque.prototype.toArray,Object.defineProperty(Deque.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),Deque.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(getCapacity(1.5*this._capacity+16))},Deque.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var r=this._front,n=this._length;r+n>t&&arrayMove(this,0,this,t,r+n&t-1)};var isArray$5=Array.isArray;function arrayMove(e,t,r,n,i){for(var o=0;o<i;++o)r[o+n]=e[o+t],e[o+t]=void 0}function pow2AtLeast(e){return e>>>=0,e-=1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)+1}function getCapacity(e){if("number"!=typeof e){if(!isArray$5(e))return 16;e=e.length}return pow2AtLeast(Math.min(Math.max(16,e),1073741824))}var deque=Deque,getArgs=function(e){var t=e.length>>>0,r=[],n=t-1;if(n<1)return r;r.length=n;for(var i=1;i<t;i+=1)r[i-1]=e[i];return r},attemptX=function(e){try{return{threw:!1,value:e.apply(this,getArgs(arguments))}}catch(e){return{threw:!0,value:e}}},toBooleanX=function(e){return!!e},isFalseyX=function(e){return!1===toBooleanX(e)};function isNull$2(e){return null===e}var lodash_isnull=isNull$2;function isUndefined$2(e){return void 0===e}for(var lib$3=isUndefined$2,toStr={}.toString,toStringTagX=function(e){return lodash_isnull(e)?"[object Null]":lib$3(e)?"[object Undefined]":toStr.call(e)},hasSymbolSupportX="function"==typeof Symbol&&"symbol"==typeof Symbol(""),hasToStringTagX=hasSymbolSupportX&&"symbol"==typeof Symbol.toStringTag,isPrimitive$2=function(e){return null==e||"function"!=typeof e&&"object"!=typeof e},isNilX=function(e){return lodash_isnull(e)||lib$3(e)},requireObjectCoercibleX=function(e){if(isNilX(e))throw new TypeError("Cannot call method on "+e);return e},isSymbol$2=createCommonjsModule(function(e){var t=Object.prototype.toString;if("function"==typeof Symbol&&"symbol"==typeof Symbol()){var r=Symbol.prototype.toString,n=/^Symbol\(.*\)$/;e.exports=function(e){if("symbol"==typeof e)return!0;if("[object Symbol]"!==t.call(e))return!1;try{return"symbol"==typeof(i=e).valueOf()&&n.test(r.call(i))}catch(e){return!1}var i}}else e.exports=function(e){return!1}}),castString="".constructor,toStringX=function(e){if(isSymbol$2(e))throw new TypeError("Cannot convert a Symbol value to a string");return castString(e)},requireCoercibleToStringX=function(e){return toStringX(requireObjectCoercibleX(e))},cachedConstructorsX={Array:[].constructor,Boolean:(!0).constructor,Number:(0).constructor,Object:{}.constructor,RegExp:/(?:)/.constructor,String:"".constructor},list=[{code:9,description:"Tab",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:"\t"},{code:10,description:"Line Feed",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:"\n"},{code:11,description:"Vertical Tab",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:"\v"},{code:12,description:"Form Feed",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:"\f"},{code:13,description:"Carriage Return",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:"\r"},{code:32,description:"Space",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:" "},{code:160,description:"No-break space",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:5760,description:"Ogham space mark",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:6158,description:"Mongolian vowel separator",es5:!0,es2015:!0,es2016:!0,es2017:!1,es2018:!1,string:""},{code:8192,description:"En quad",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:8193,description:"Em quad",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:8194,description:"En space",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:8195,description:"Em space",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:8196,description:"Three-per-em space",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:8197,description:"Four-per-em space",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:8198,description:"Six-per-em space",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:8199,description:"Figure space",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:8200,description:"Punctuation space",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:8201,description:"Thin space",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:8202,description:"Hair space",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:8232,description:"Line separator",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:"\u2028"},{code:8233,description:"Paragraph separator",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:"\u2029"},{code:8239,description:"Narrow no-break space",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:8287,description:"Medium mathematical space",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:12288,description:"Ideographic space",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:""},{code:65279,description:"Byte Order Mark",es5:!0,es2015:!0,es2016:!0,es2017:!0,es2018:!0,string:"\ufeff"}],stringES2016="",stringES2018="",length$3=list.length,i$1=0;i$1<length$3;i$1+=1)list[i$1].es2016&&(stringES2016+=list[i$1].string),list[i$1].es2018&&(stringES2018+=list[i$1].string);var whiteSpaceX={list:list,string:stringES2018,string5:stringES2016,string2015:stringES2016,string2016:stringES2016,string2017:stringES2018,string2018:stringES2018},Rx$1=cachedConstructorsX.RegExp,reLeft2016=new Rx$1("^["+whiteSpaceX.string2016+"]+"),reLeft2018=new Rx$1("^["+whiteSpaceX.string2018+"]+"),replace$1="".replace,$trimLeft2016=function(e){return replace$1.call(requireCoercibleToStringX(e),reLeft2016,"")},$trimLeft2018=function(e){return replace$1.call(requireCoercibleToStringX(e),reLeft2018,"")},trimLeftX={trimLeft:$trimLeft2018,trimLeft2016:$trimLeft2016,trimLeft2018:$trimLeft2018},Rx$2=cachedConstructorsX.RegExp,reRight2016=new Rx$2("["+whiteSpaceX.string2016+"]+$"),reRight2018=new Rx$2("["+whiteSpaceX.string2018+"]+$"),replace$2="".replace,$trimRight2016=function(e){return replace$2.call(requireCoercibleToStringX(e),reRight2016,"")},$trimRight2018=function(e){return replace$2.call(requireCoercibleToStringX(e),reRight2018,"")},trimRightX={trimRight:$trimRight2018,trimRight2016:$trimRight2016,trimRight2018:$trimRight2018},trimLeft2016=trimLeftX.trimLeft2016,trimLeft2018=trimLeftX.trimLeft2018,trimRight2016=trimRightX.trimRight2016,trimRight2018=trimRightX.trimRight2016,$trim2016=function(e){return trimLeft2016(trimRight2016(e))},$trim2018=function(e){return trimLeft2018(trimRight2018(e))},trimX={trim:$trim2018,trim2016:$trim2016,trim2018:$trim2018},trim2016=trimX.trim2016,trim2018=trimX.trim2018,Rx=cachedConstructorsX.RegExp,reNormalize2016=new Rx("["+whiteSpaceX.string2016+"]+","g"),reNormalize2018=new Rx("["+whiteSpaceX.string2018+"]+","g"),replace="".replace,$normalizeSpace2016=function(e){return replace.call(trim2016(e),reNormalize2016," ")},$normalizeSpace2018=function(e){return replace.call(trim2018(e),reNormalize2018," ")},normalizeSpaceX={normalizeSpace:$normalizeSpace2018,normalizeSpace2016:$normalizeSpace2016,normalizeSpace2018:$normalizeSpace2018},STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,replace$3="".replace,replaceCommentsX=function(e){return replace$3.call(requireCoercibleToStringX(e),STRIP_COMMENTS,arguments.length>1?toStringX(arguments[1]):"")},fToString=Function.prototype.toString,normalise=normalizeSpaceX.normalizeSpace,funcTag="[object Function]",genTag="[object GeneratorFunction]",asyncTag="[object AsyncFunction]",ctrRx=/^class /,test=ctrRx.test,hasNativeClass=!1===attemptX(function(){return Function('"use strict"; return class My {};')()}).threw,testClassstring=function(e){return test.call(ctrRx,normalise(replaceCommentsX(fToString.call(e)," ")))},isES6ClassFn=function(e){var t=attemptX(testClassstring,e);return!1===t.threw&&t.value},tryFuncToString=function(e,t){return(!hasNativeClass||!1!==t||!isES6ClassFn(e))&&!1===attemptX.call(e,fToString).threw},isFunctionX=function(e){if(isPrimitive$2(e))return!1;if(hasToStringTagX)return tryFuncToString(e,toBooleanX(arguments[1]));if(hasNativeClass&&isFalseyX(arguments[1])&&isES6ClassFn(e))return!1;var t=toStringTagX(e);return t===funcTag||t===genTag||t===asyncTag},isObjectLikeX=function(e){return!1===isPrimitive$2(e)&&!1===isFunctionX(e,!0)},castObject=cachedConstructorsX.Object,toObjectX=function(e){return castObject(requireObjectCoercibleX(e))},getDay=Date.prototype.getDay,tryDateObject=function(e){try{return getDay.call(e),!0}catch(e){return!1}},toStr$2=Object.prototype.toString,dateClass="[object Date]",hasToStringTag$1="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,isDateObject=function(e){return"object"==typeof e&&null!==e&&(hasToStringTag$1?tryDateObject(e):toStr$2.call(e)===dateClass)},symToPrimitive=hasSymbolSupportX&&Symbol.toPrimitive,symValueOf=hasSymbolSupportX&&Symbol.prototype.valueOf,toStringOrder=["toString","valueOf"],toNumberOrder=["valueOf","toString"],orderLength=2,ordinaryToPrimitive=function(e,t){if(requireObjectCoercibleX(e),"string"!=typeof t||"number"!==t&&"string"!==t)throw new TypeError('hint must be "string" or "number"');for(var r,n,i="string"===t?toStringOrder:toNumberOrder,o=0;o<orderLength;o+=1)if(r=e[i[o]],isFunctionX(r)&&(n=r.call(e),isPrimitive$2(n)))return n;throw new TypeError("No default value")},getMethod=function(e,t){var r=e[t];if(!1===isNilX(r)){if(!1===isFunctionX(r))throw new TypeError(r+" returned for property "+t+" of object "+e+" is not a function");return r}},toPrimitiveX=function(e,t){if(isPrimitive$2(e))return e;var r,n="default";if(arguments.length>1&&(t===String?n="string":t===Number&&(n="number")),hasSymbolSupportX&&(symToPrimitive?r=getMethod(e,symToPrimitive):isSymbol$2(e)&&(r=symValueOf)),!1===lib$3(r)){var i=r.call(e,n);if(isPrimitive$2(i))return i;throw new TypeError("unable to convert exotic object to primitive")}return"default"===n&&(isDateObject(e)||isSymbol$2(e))&&(n="string"),ordinaryToPrimitive(e,"default"===n?"number":n)},toPropertyKeyX=function(e){var t=toPrimitiveX(e,String);return hasSymbolSupportX&&"symbol"==typeof t?t:toStringX(t)},hop=cachedConstructorsX.Object.prototype.hasOwnProperty,hasOwnPropertyX=function(e,t){return hop.call(toObjectX(e),toPropertyKeyX(t))},strValue=String.prototype.valueOf,tryStringObject=function(e){try{return strValue.call(e),!0}catch(e){return!1}},toStr$3=Object.prototype.toString,strClass="[object String]",hasToStringTag$2="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,isString$3=function(e){return"string"==typeof e||"object"==typeof e&&(hasToStringTag$2?tryStringObject(e):toStr$3.call(e)===strClass)},castString$1=cachedConstructorsX.String,pToString$1=hasSymbolSupportX&&Symbol.prototype.toString,isSymbol$4="function"==typeof pToString$1&&isSymbol$2,toStringSymbolsSupportedX=function(e){return isSymbol$4&&isSymbol$4(e)?pToString$1.call(e):castString$1(e)},nanX=NaN,nativeParseInt=parseInt,trimLeft2016$1=trimLeftX.trimLeft2016,trimLeft2018$1=trimLeftX.trimLeft2018,castNumber$1=cachedConstructorsX.Number,charAt=cachedConstructorsX.String.prototype.charAt,hexRegex=/^[-+]?0[xX]/,test$2=hexRegex.test,$parseInt2016$1=function(e,t){var r=trimLeft2016$1(toStringX(e));return nativeParseInt(r,castNumber$1(t)||(test$2.call(hexRegex,r)?16:10))},$parseInt2018$1=function(e,t){var r=trimLeft2018$1(toStringX(e));return""===charAt.call(r,0)?nanX:nativeParseInt(r,castNumber$1(t)||(test$2.call(hexRegex,r)?16:10))},parseIntX={parseInt:$parseInt2018$1,parseInt2016:$parseInt2016$1,parseInt2018:$parseInt2018$1},castNumber=cachedConstructorsX.Number,Rx$3=cachedConstructorsX.RegExp,trim2016$1=trimX.trim2016,trim2018$1=trimX.trim2018,$parseInt2016=parseIntX.parseInt2016,$parseInt2018=parseIntX.parseInt2018,pStrSlice=cachedConstructorsX.String.prototype.slice,binaryRegex=/^0b[01]+$/i,test$1=binaryRegex.test,isBinary=function(e){return test$1.call(binaryRegex,e)},octalRegex=/^0o[0-7]+$/i,isOctal=function(e){return test$1.call(octalRegex,e)},nonWSregex2016=new Rx$3("[]","g"),hasNonWS2016=function(e){return test$1.call(nonWSregex2016,e)},nonWSregex2018=new Rx$3("[]","g"),hasNonWS2018=function(e){return test$1.call(nonWSregex2018,e)},invalidHexLiteral=/^[-+]0x[0-9a-f]+$/i,isInvalidHexLiteral=function(e){return test$1.call(invalidHexLiteral,e)},$toNumber2016=function e(t){var r=toPrimitiveX(t,Number);if("symbol"==typeof r)throw new TypeError("Cannot convert a Symbol value to a number");if("string"==typeof r){if(isBinary(r))return e($parseInt2016(pStrSlice.call(r,2),2));if(isOctal(r))return e($parseInt2016(pStrSlice.call(r,2),8));if(hasNonWS2016(r)||isInvalidHexLiteral(r))return nanX;var n=trim2016$1(r);if(n!==r)return e(n)}return castNumber(r)},$toNumber2018=function e(t){var r=toPrimitiveX(t,Number);if("symbol"==typeof r)throw new TypeError("Cannot convert a Symbol value to a number");if("string"==typeof r){if(isBinary(r))return e($parseInt2018(pStrSlice.call(r,2),2));if(isOctal(r))return e($parseInt2018(pStrSlice.call(r,2),8));if(hasNonWS2018(r)||isInvalidHexLiteral(r))return nanX;var n=trim2018$1(r);if(n!==r)return e(n)}return castNumber(r)},toNumberX={toNumber:$toNumber2018,toNumber2016:$toNumber2016,toNumber2018:$toNumber2018},isNanX=function(e){return e!=e},infinityX=1/0,isFiniteX=function(e){return"number"==typeof e&&!1===isNanX(e)&&e!==infinityX&&e!==-infinityX},toNumber2016$1=toNumberX.toNumber2016,toNumber2018$1=toNumberX.toNumber2018,$sign2016=function(e){var t=toNumber2016$1(e);return 0===t||isNanX(t)?t:t>0?1:-1},$sign2018=function(e){var t=toNumber2018$1(e);return 0===t||isNanX(t)?t:t>0?1:-1},mathSignX={sign:$sign2018,sign2016:$sign2016,sign2018:$sign2018},toNumber2016=toNumberX.toNumber2016,toNumber2018=toNumberX.toNumber2018,mathSign2016=mathSignX.sign2016,mathSign2018=mathSignX.sign2018,mathFloor=Math.floor,mathAbs=Math.abs,$toInteger2016=function(e){var t=toNumber2016(e);return isNanX(t)?0:0===t||!1===isFiniteX(t)?t:mathSign2016(t)*mathFloor(mathAbs(t))},$toInteger2018=function(e){var t=toNumber2018(e);return isNanX(t)?0:0===t||!1===isFiniteX(t)?t:mathSign2018(t)*mathFloor(mathAbs(t))},toIntegerX={toInteger:$toInteger2018,toInteger2016:$toInteger2016,toInteger2018:$toInteger2018},toNumber$1=toNumberX.toNumber2018,mathClampX=function(e){var t=toNumber$1(e),r=arguments.length;if(r<2)return t;var n,i=toNumber$1(arguments[1]);if(r<3?(n=i,i=0):n=toNumber$1(arguments[2]),i>n)throw new RangeError('"min" must be less than "max"');return t<i?i:t>n?n:t},maxSafeInteger=9007199254740991,toInteger=toIntegerX.toInteger2018,toNumber=toNumberX.toNumber2018,reIsUint=/^(?:0|[1-9]\d*)$/,rxTest=reIsUint.test,isIndexX=function(e){var t=toStringSymbolsSupportedX(e);if(!1===rxTest.call(reIsUint,t))return!1;var r=toNumber(t);return arguments.length>1?r<mathClampX(toInteger(arguments[1]),maxSafeInteger):r<maxSafeInteger},propIsEnumerable=Object.prototype.propertyIsEnumerable,propertyIsEnumerableX=function(e,t){return propIsEnumerable.call(toObjectX(e),toPropertyKeyX(t))},nativeGOPD="function"==typeof Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor,getOPDFallback1,getOPDFallback2,doesGOPDWork=function(e,t){e[toPropertyKeyX(t)]=0;var r=attemptX(nativeGOPD,e,t);return!1===r.threw&&0===r.value.value},$getOwnPropertyDescriptor;if(nativeGOPD){var doc="undefined"!=typeof document&&document,getOPDWorksOnDom=!doc||doesGOPDWork(doc.createElement("div"),"sentinel");if(getOPDWorksOnDom){var res$2=attemptX(nativeGOPD,Object("abc"),1),worksWithStr=!1===res$2.threw&&res$2.value&&"b"===res$2.value.value;if(worksWithStr){var getOPDWorksOnObject=doesGOPDWork({},"sentinel");if(getOPDWorksOnObject){var worksWithPrim=!1===attemptX(nativeGOPD,42,"name").threw,worksWithObjSym=hasSymbolSupportX&&doesGOPDWork({},Object(Symbol("")));$getOwnPropertyDescriptor=worksWithObjSym?worksWithPrim?nativeGOPD:function(e,t){return nativeGOPD(toObjectX(e),t)}:worksWithPrim?function(e,t){return nativeGOPD(e,toPropertyKeyX(t))}:function(e,t){return nativeGOPD(toObjectX(e),toPropertyKeyX(t))}}else getOPDFallback1=nativeGOPD}else getOPDFallback2=nativeGOPD}}if(isFalseyX($getOwnPropertyDescriptor)||getOPDFallback1||getOPDFallback2){var owns=hasOwnPropertyX,isPrimitive$5=isPrimitive$2,isString$2=isString$3,isIndex=isIndexX,propertyIsEnumerable=propertyIsEnumerableX,prototypeOfObject=Object.prototype,lookupGetter,lookupSetter,supportsAccessors=owns(prototypeOfObject,"__defineGetter__");if(supportsAccessors){var lg=prototypeOfObject.__lookupGetter__,ls=prototypeOfObject.__lookupSetter__;lookupGetter=function(e,t){return lg.call(e,t)},lookupSetter=function(e,t){return ls.call(e,t)}}$getOwnPropertyDescriptor=function(e,t){var r,n=toObjectX(e),i=toPropertyKeyX(t);if(getOPDFallback1&&!1===(r=attemptX.call(Object,getOPDFallback1,n,i)).threw)return r.value;var o,a=isString$2(n)&&isIndex(i,n.length);if(getOPDFallback2&&!1===a&&!1===(r=attemptX.call(Object,getOPDFallback2,n,i)).threw)return r.value;if(!1===a&&!1===owns(n,i))return o;if(o={configurable:!1===isPrimitive$5(e)&&!1===a,enumerable:propertyIsEnumerable(n,i)},supportsAccessors){var s=n.__proto__,u=n!==prototypeOfObject;u&&(n.__proto__=prototypeOfObject);var c=lookupGetter(n,i),l=lookupSetter(n,i);if(u&&(n.__proto__=s),c||l)return c&&(o.get=c),l&&(o.set=l),o}return a?(o.value=n.charAt(i),o.writable=!1):(o.value=n[i],o.writable=!0),o}}var objectGetOwnPropertyDescriptorX=$getOwnPropertyDescriptor,hasABuf="function"==typeof ArrayBuffer,bLength=!1,toStringTag,aBufTag;if(hasABuf){if(hasToStringTagX){var getOwnPropertyDescriptor=objectGetOwnPropertyDescriptorX,descriptor=getOwnPropertyDescriptor(ArrayBuffer.prototype,"byteLength");if(descriptor&&"function"==typeof descriptor.get){var res$1$1=attemptX(function(){return new ArrayBuffer(4)});!1===res$1$1.threw&&isObjectLikeX(res$1$1.value)&&(res$1$1=attemptX.call(res$1$1.value,descriptor.get),bLength=!1===res$1$1.threw&&"number"==typeof res$1$1.value&&descriptor.get)}}!1===bLength&&(toStringTag=toStringTagX,aBufTag="[object ArrayBuffer]")}var isArrayBufferX=function(e){if(!1===hasABuf||!1===isObjectLikeX(e))return!1;if(!1===bLength)return toStringTag(e)===aBufTag;var t=attemptX.call(e,bLength);return!1===t.threw&&"number"==typeof t.value},isModern="function"==typeof Buffer.alloc&&"function"==typeof Buffer.allocUnsafe&&"function"==typeof Buffer.from;function fromArrayBuffer$1(e,t,r){t>>>=0;var n=e.byteLength-t;if(n<0)throw new RangeError("'offset' is out of bounds");if(void 0===r)r=n;else if((r>>>=0)>n)throw new RangeError("'length' is out of bounds");return isModern?Buffer.from(e.slice(t,t+r)):new Buffer(new Uint8Array(e.slice(t,t+r)))}function fromString$1(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!Buffer.isEncoding(t))throw new TypeError('"encoding" must be a valid string encoding');return isModern?Buffer.from(e,t):new Buffer(e,t)}function bufferFrom(e,t,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return isArrayBufferX(e)?fromArrayBuffer$1(e,t,r):"string"==typeof e?fromString$1(e,t):isModern?Buffer.from(e):new Buffer(e)}var bufferFrom_1=bufferFrom,stringify$1=function(e){var t=[];t.push({obj:e});for(var r,n,i,o,a,s,u,c,l,f,d="";r=t.pop();)if(n=r.obj,d+=r.prefix||"",i=r.val||"")d+=i;else if("object"!=typeof n)d+=void 0===n?null:JSON.stringify(n);else if(null===n)d+="null";else if(Array.isArray(n)){for(t.push({val:"]"}),o=n.length-1;o>=0;o--)a=0===o?"":",",t.push({obj:n[o],prefix:a});t.push({val:"["})}else{s=[];for(u in n)n.hasOwnProperty(u)&&s.push(u);for(t.push({val:"}"}),o=s.length-1;o>=0;o--)l=n[c=s[o]],f=o>0?",":"",f+=JSON.stringify(c)+":",t.push({obj:l,prefix:f});t.push({val:"{"})}return d};function pop$1(e,t,r){var n=r[r.length-1];e===n.element&&(r.pop(),n=r[r.length-1]);var i=n.element,o=n.index;if(Array.isArray(i))i.push(e);else if(o===t.length-2){i[t.pop()]=e}else t.push(e)}var parse$1=function(e){for(var t,r,n,i,o,a,s,u,c,l=[],f=[],d=0;;)if("}"!==(t=e[d++])&&"]"!==t&&void 0!==t)switch(t){case" ":case"\t":case"\n":case":":case",":break;case"n":d+=3,pop$1(null,l,f);break;case"t":d+=3,pop$1(!0,l,f);break;case"f":d+=4,pop$1(!1,l,f);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(r="",d--;;){if(n=e[d++],!/[\d\.\-e\+]/.test(n)){d--;break}r+=n}pop$1(parseFloat(r),l,f);break;case'"':for(i="",o=void 0,a=0;'"'!==(s=e[d++])||"\\"===o&&a%2==1;)i+=s,"\\"===(o=s)?a++:a=0;pop$1(JSON.parse('"'+i+'"'),l,f);break;case"[":u={element:[],index:l.length},l.push(u.element),f.push(u);break;case"{":c={element:{},index:l.length},l.push(c.element),f.push(c);break;default:throw new Error("unexpectedly reached end of input: "+t)}else{if(1===l.length)return l.pop();pop$1(l.pop(),l,f)}},vuvuzela={stringify:stringify$1,parse:parse$1};function normalizeArray(e,t){for(var r=0,n=e.length-1;n>=0;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,splitPath=function(e){return splitPathRe.exec(e).slice(1)};function resolve$1(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:"/";if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(e=n+"/"+e,t="/"===n.charAt(0))}return e=normalizeArray(filter$1(e.split("/"),function(e){return!!e}),!t).join("/"),(t?"/":"")+e||"."}function normalize$1(e){var t=isAbsolute(e),r="/"===substr(e,-1);return(e=normalizeArray(filter$1(e.split("/"),function(e){return!!e}),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e}function isAbsolute(e){return"/"===e.charAt(0)}function join(){return normalize$1(filter$1(Array.prototype.slice.call(arguments,0),function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))}function relative(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=resolve$1(e).substr(1),t=resolve$1(t).substr(1);for(var n=r(e.split("/")),i=r(t.split("/")),o=Math.min(n.length,i.length),a=o,s=0;s<o;s++)if(n[s]!==i[s]){a=s;break}var u=[];for(s=a;s<n.length;s++)u.push("..");return(u=u.concat(i.slice(a))).join("/")}var sep="/",delimiter=":";function dirname(e){var t=splitPath(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."}function basename(e,t){var r=splitPath(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r}function extname(e){return splitPath(e)[3]}var path$2={extname:extname,basename:basename,dirname:dirname,sep:sep,delimiter:delimiter,relative:relative,join:join,isAbsolute:isAbsolute,normalize:normalize$1,resolve:resolve$1};function filter$1(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var substr="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)},path$3=Object.freeze({resolve:resolve$1,normalize:normalize$1,isAbsolute:isAbsolute,join:join,relative:relative,sep:sep,delimiter:delimiter,dirname:dirname,basename:basename,extname:extname,default:path$2}),encodings$3=createCommonjsModule(function(e,t){t.utf8=t["utf-8"]={encode:function(e){return n(e)?e:String(e)},decode:r,buffer:!1,type:"utf8"},t.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"},t.binary={encode:function(e){return n(e)?e:new Buffer(e)},decode:r,buffer:!0,type:"binary"},t.none={encode:r,decode:r,buffer:!1,type:"id"},t.id=t.none;function r(e){return e}function n(e){return void 0===e||null===e||Buffer.isBuffer(e)}["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"].forEach(function(e){t[e]={encode:function(t){return n(t)?t:new Buffer(t,e)},decode:function(t){return t.toString(e)},buffer:!0,type:e}})}),encodings_1$1=encodings$3.utf8,encodings_2$1=encodings$3.json,encodings_3$1=encodings$3.binary,encodings_4$1=encodings$3.none,encodings_5$1=encodings$3.id,levelCodec$1=Codec$2;function Codec$2(e){this.opts=e||{},this.encodings=encodings$3}Codec$2.prototype._encoding=function(e){return"string"==typeof e&&(e=encodings$3[e]),e||(e=encodings$3.id),e},Codec$2.prototype._keyEncoding=function(e,t){return this._encoding(t&&t.keyEncoding||e&&e.keyEncoding||this.opts.keyEncoding)},Codec$2.prototype._valueEncoding=function(e,t){return this._encoding(t&&(t.valueEncoding||t.encoding)||e&&(e.valueEncoding||e.encoding)||this.opts.valueEncoding||this.opts.encoding)},Codec$2.prototype.encodeKey=function(e,t,r){return this._keyEncoding(t,r).encode(e)},Codec$2.prototype.encodeValue=function(e,t,r){return this._valueEncoding(t,r).encode(e)},Codec$2.prototype.decodeKey=function(e,t){return this._keyEncoding(t).decode(e)},Codec$2.prototype.decodeValue=function(e,t){return this._valueEncoding(t).decode(e)},Codec$2.prototype.encodeBatch=function(e,t){var r=this;return e.map(function(e){var n={type:e.type,key:r.encodeKey(e.key,t,e)};return r.keyAsBuffer(t,e)&&(n.keyEncoding="binary"),e.prefix&&(n.prefix=e.prefix),"value"in e&&(n.value=r.encodeValue(e.value,t,e),r.valueAsBuffer(t,e)&&(n.valueEncoding="binary")),n})};var ltgtKeys$1=["lt","gt","lte","gte","start","end"];Codec$2.prototype.encodeLtgt=function(e){var t=this,r={};return Object.keys(e).forEach(function(n){r[n]=ltgtKeys$1.indexOf(n)>-1?t.encodeKey(e[n],e):e[n]}),r},Codec$2.prototype.createStreamDecoder=function(e){var t=this;return e.keys&&e.values?function(r,n){return{key:t.decodeKey(r,e),value:t.decodeValue(n,e)}}:e.keys?function(r){return t.decodeKey(r,e)}:e.values?function(r,n){return t.decodeValue(n,e)}:function(){}},Codec$2.prototype.keyAsBuffer=function(e){return this._keyEncoding(e).buffer},Codec$2.prototype.valueAsBuffer=function(e){return this._valueEncoding(e).buffer};var AbstractLevelDOWN$4=abstractLeveldown.AbstractLevelDOWN,AbstractChainedBatch$3=abstractLeveldown.AbstractChainedBatch,AbstractIterator$4=abstractLeveldown.AbstractIterator,inherits$6=util$2.inherits,EncodingError=errors.EncodingError,encodingDown=DB.default=DB;function DB(e,t){if(!(this instanceof DB))return new DB(e,t);AbstractLevelDOWN$4.call(this,""),void 0===(t=t||{}).keyEncoding&&(t.keyEncoding="utf8"),void 0===t.valueEncoding&&(t.valueEncoding="utf8"),this.db=e,this.codec=new levelCodec$1(t)}function Iterator(e,t){AbstractIterator$4.call(this,e),this.codec=e.codec,this.keys=t.keys,this.values=t.values,this.opts=this.codec.encodeLtgt(t),this.it=e.db.iterator(this.opts)}function Batch$2(e,t){AbstractChainedBatch$3.call(this,e),this.codec=e.codec,this.batch=e.db.batch()}function packager(e){function t(t,r,n){return"function"==typeof r&&(n=r),"object"==typeof r&&null!==r||(r={}),levelup(encodingDown(e(t),r),r,n)}return["destroy","repair"].forEach(function(r){"function"==typeof e[r]&&(t[r]=function(t,n){e[r](t,n||function(){})})}),t.errors=levelup.errors,t}inherits$6(DB,AbstractLevelDOWN$4),DB.prototype._serializeKey=DB.prototype._serializeValue=function(e){return e},DB.prototype._open=function(e,t){this.db.open(e,t)},DB.prototype._close=function(e){this.db.close(e)},DB.prototype._put=function(e,t,r,n){e=this.codec.encodeKey(e,r),t=this.codec.encodeValue(t,r),this.db.put(e,t,r,n)},DB.prototype._get=function(e,t,r){var n=this;e=this.codec.encodeKey(e,t),t.asBuffer=this.codec.valueAsBuffer(t),this.db.get(e,t,function(e,i){if(e)return r(e);try{i=n.codec.decodeValue(i,t)}catch(e){return r(new EncodingError(e))}r(null,i)})},DB.prototype._del=function(e,t,r){e=this.codec.encodeKey(e,t),this.db.del(e,t,r)},DB.prototype._chainedBatch=function(){return new Batch$2(this)},DB.prototype._batch=function(e,t,r){e=this.codec.encodeBatch(e,t),this.db.batch(e,t,r)},DB.prototype._iterator=function(e){return e.keyAsBuffer=this.codec.keyAsBuffer(e),e.valueAsBuffer=this.codec.valueAsBuffer(e),new Iterator(this,e)},DB.prototype.approximateSize=function(e,t,r,n){return this.db.approximateSize(e,t,r,n)},inherits$6(Iterator,AbstractIterator$4),Iterator.prototype._next=function(e){var t=this;this.it.next(function(r,n,i){if(r)return e(r);try{n=t.keys&&void 0!==n?t.codec.decodeKey(n,t.opts):void 0,i=t.values&&void 0!==i?t.codec.decodeValue(i,t.opts):void 0}catch(r){return e(new EncodingError(r))}e(null,n,i)})},Iterator.prototype._end=function(e){this.it.end(e)},inherits$6(Batch$2,AbstractChainedBatch$3),Batch$2.prototype._put=function(e,t){e=this.codec.encodeKey(e),t=this.codec.encodeValue(t),this.batch.put(e,t)},Batch$2.prototype._del=function(e){e=this.codec.encodeKey(e),this.batch.del(e)},Batch$2.prototype._clear=function(){this.batch.clear()},Batch$2.prototype._write=function(e,t){this.batch.write(e,t)};var levelPackager=packager,path$4=path$3&&path$2||path$3,bindings_1=createCommonjsModule(function(e,t){var r=path$4.join,n=path$4.dirname,i=fs$1.accessSync&&function(e){try{fs$1.accessSync(e)}catch(e){return!1}return!0}||fs$1.existsSync||path$4.existsSync,o={arrow:process.env.NODE_BINDINGS_ARROW||"  ",compiled:process.env.NODE_BINDINGS_COMPILED_DIR||"compiled",platform:process.platform,arch:process.arch,version:process.versions.node,bindings:"bindings.node",try:[["module_root","build","bindings"],["module_root","build","Debug","bindings"],["module_root","build","Release","bindings"],["module_root","out","Debug","bindings"],["module_root","Debug","bindings"],["module_root","out","Release","bindings"],["module_root","Release","bindings"],["module_root","build","default","bindings"],["module_root","compiled","version","platform","arch","bindings"]]};e.exports=t=function(e){"string"==typeof e?e={bindings:e}:e||(e={}),Object.keys(o).map(function(t){t in e||(e[t]=o[t])}),e.module_root||(e.module_root=t.getRoot(t.getFileName())),".node"!=path$4.extname(e.bindings)&&(e.bindings+=".node");for(var n,i,a,s=[],u=0,c=e.try.length;u<c;u++){n=r.apply(null,e.try[u].map(function(t){return e[t]||t})),s.push(n);try{return i=e.path?commonjsRequire.resolve(n):commonjsRequire(n),e.path||(i.path=n),i}catch(e){if(!/not find/i.test(e.message))throw e}}throw(a=new Error("Could not locate the bindings file. Tried:\n"+s.map(function(t){return e.arrow+t}).join("\n"))).tries=s,a},t.getFileName=function(e){var t,r=Error.prepareStackTrace,n=Error.stackTraceLimit;return Error.stackTraceLimit=10,Error.prepareStackTrace=function(r,n){for(var i=0,o=n.length;i<o;i++)if((t=n[i].getFileName())!==__filename){if(!e)return;if(t!==e)return}},Error.captureStackTrace({}),Error.prepareStackTrace=r,Error.stackTraceLimit=n,t},t.getRoot=function(e){for(var t,o=n(e);;){if("."===o&&(o=process.cwd()),i(r(o,"package.json"))||i(r(o,"node_modules")))return o;if(t===o)throw new Error('Could not find module root given file: "'+e+'". Do you have a `package.json` file? ');t=o,o=r(o,"..")}}}),bindings_2=bindings_1.getFileName,bindings_3=bindings_1.getRoot;const AbstractChainedBatch$4=abstractLeveldown.AbstractChainedBatch;function ChainedBatch(e){AbstractChainedBatch$4.call(this,e),this.binding=e.binding.batch()}ChainedBatch.prototype._put=function(e,t){this.binding.put(e,t)},ChainedBatch.prototype._del=function(e){this.binding.del(e)},ChainedBatch.prototype._clear=function(e){this.binding.clear(e)},ChainedBatch.prototype._write=function(e,t){this.binding.write(e,t)},util$2.inherits(ChainedBatch,AbstractChainedBatch$4);var chainedBatch=ChainedBatch,LIMIT=process.maxTickDepth/2||1e3,factory=function(){var e=0;return function(t){e>=LIMIT?(commonjsGlobal.setImmediate(t),e=0):process.nextTick(t),e++}},fastFuture=commonjsGlobal.setImmediate?factory:function(){return process.nextTick};const AbstractIterator$5=abstractLeveldown.AbstractIterator;function Iterator$1(e,t){AbstractIterator$5.call(this,e),this.binding=e.binding.iterator(t),this.cache=null,this.finished=!1,this.fastFuture=fastFuture()}util$2.inherits(Iterator$1,AbstractIterator$5),Iterator$1.prototype.seek=function(e){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");if("string"!=typeof e&&!Buffer.isBuffer(e))throw new Error("seek() requires a string or buffer key");if(0==e.length)throw new Error("cannot seek() to an empty key");this.cache=null,this.binding.seek(e),this.finished=!1},Iterator$1.prototype._next=function(e){var t,r,n=this;return this.cache&&this.cache.length?(t=this.cache.pop(),r=this.cache.pop(),this.fastFuture(function(){e(null,t,r)})):this.finished?this.fastFuture(function(){e()}):this.binding.next(function(t,r,i){if(t)return e(t);n.cache=r,n.finished=i,n._next(e)}),this},Iterator$1.prototype._end=function(e){delete this.cache,this.binding.end(e)};var iterator=Iterator$1;const AbstractLevelDOWN$5=abstractLeveldown.AbstractLevelDOWN,binding$1=bindings_1("leveldown").leveldown;function LevelDOWN(e){if(!(this instanceof LevelDOWN))return new LevelDOWN(e);AbstractLevelDOWN$5.call(this,e),this.binding=binding$1(e)}util$2.inherits(LevelDOWN,AbstractLevelDOWN$5),LevelDOWN.prototype._open=function(e,t){this.binding.open(e,t)},LevelDOWN.prototype._close=function(e){this.binding.close(e)},LevelDOWN.prototype._put=function(e,t,r,n){this.binding.put(e,t,r,n)},LevelDOWN.prototype._get=function(e,t,r){this.binding.get(e,t,r)},LevelDOWN.prototype._del=function(e,t,r){this.binding.del(e,t,r)},LevelDOWN.prototype._chainedBatch=function(){return new chainedBatch(this)},LevelDOWN.prototype._batch=function(e,t,r){return this.binding.batch(e,t,r)},LevelDOWN.prototype._approximateSize=function(e,t,r){this.binding.approximateSize(e,t,r)},LevelDOWN.prototype.compactRange=function(e,t,r){this.binding.compactRange(e,t,r)},LevelDOWN.prototype.getProperty=function(e){if("string"!=typeof e)throw new Error("getProperty() requires a valid `property` argument");return this.binding.getProperty(e)},LevelDOWN.prototype._iterator=function(e){return new iterator(this,e)},LevelDOWN.destroy=function(e,t){if(arguments.length<2)throw new Error("destroy() requires `location` and `callback` arguments");if("string"!=typeof e)throw new Error("destroy() requires a location string argument");if("function"!=typeof t)throw new Error("destroy() requires a callback function argument");binding$1.destroy(e,t)},LevelDOWN.repair=function(e,t){if(arguments.length<2)throw new Error("repair() requires `location` and `callback` arguments");if("string"!=typeof e)throw new Error("repair() requires a location string argument");if("function"!=typeof t)throw new Error("repair() requires a callback function argument");binding$1.repair(e,t)};var leveldown=LevelDOWN.default=LevelDOWN,level=levelPackager(leveldown),array$3=toArray;function toArray(e,t){return"function"==typeof e&&(t=e,e=[]),writeStream(function(t){e.push(t)},function(){t(e),this.emit("end")})}var writeStream=WriteStream$1;function WriteStream$1(e,t){var r=new require$$0$5,n=!1;return t=t||defaultEnd,r.write=function(t){return!1!==e.call(r,t)},r.end=function(e){if(n)return;n=!0,arguments.length&&r.write(e);t.call(r)},r.writable=!0,r}function defaultEnd(){this.emit("finish")}WriteStream$1.toArray=array$3;var endStream=EndStream;function EndStream(e,t){var r=0,n=!1;t=t||noop$5;var i=writeStream(function(t){r++,e(t,function(e){if(e)return i.emit("error",e);0===--r&&n&&i.emit("finish")})},function(){n=!0,0===r&&this.emit("finish")});return i}function noop$5(){}var levelWriteStream=LevelWriteStream;function LevelWriteStream(e){return function(t){t=t||{};var r=[],n=endStream(function(e,t){0===r.length&&process.nextTick(i);r.push(e),n.once("_drain",t)});return n;function i(){if(1===r.length){var n=r[0];e.put(n.key,n.value,t,o)}else{var i=r.map(function(e){return e.type="put",e});e.batch(i,t,o)}r.length=0}function o(e){n.emit("_drain",e)}}}var PouchPromise="function"==typeof Promise?Promise:lib;function isBinaryObject(e){return e instanceof Buffer}var funcToString=Function.prototype.toString,objectCtorString=funcToString.call(Object),ExportedSet,ExportedMap;function isPlainObject(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=t.constructor;return"function"==typeof r&&r instanceof r&&funcToString.call(r)==objectCtorString}function clone(e){var t,r,n;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],r=0,n=e.length;r<n;r++)t[r]=clone(e[r]);return t}if(e instanceof Date)return e.toISOString();if(isBinaryObject(e))return cloneBuffer_1(e);if(!isPlainObject(e))return e;t={};for(r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=clone(e[r]);void 0!==i&&(t[r]=i)}return t}function once(e){var t=!1;return argsarray(function(r){if(t)throw new Error("once called more than once");t=!0,e.apply(this,r)})}function toPromise(e){return argsarray(function(t){var r=this,n="function"==typeof(t=clone(t))[t.length-1]&&t.pop(),i=new PouchPromise(function(n,i){var o;try{var a=once(function(e,t){e?i(e):n(t)});t.push(a),(o=e.apply(r,t))&&"function"==typeof o.then&&n(o)}catch(e){i(e)}});return n&&i.then(function(e){n(null,e)},n),i})}function logApiCall(e,t,r){if(e.constructor.listeners("debug").length){for(var n=["api",e.name,t],i=0;i<r.length-1;i++)n.push(r[i]);e.constructor.emit("debug",n);var o=r[r.length-1];r[r.length-1]=function(r,n){var i=["api",e.name,t];i=i.concat(r?["error",r]:["success",n]),e.constructor.emit("debug",i),o(r,n)}}}function adapterFun(e,t){return toPromise(argsarray(function(r){if(this._closed)return PouchPromise.reject(new Error("database is closed"));if(this._destroyed)return PouchPromise.reject(new Error("database is destroyed"));var n=this;return logApiCall(n,e,r),this.taskqueue.isReady?t.apply(this,r):new PouchPromise(function(t,i){n.taskqueue.addTask(function(o){o?i(o):t(n[e].apply(n,r))})})}))}function mangle(e){return"$"+e}function unmangle(e){return e.substring(1)}function Map$1$1(){this._store={}}function Set$1$1(e){if(this._store=new Map$1$1,e&&Array.isArray(e))for(var t=0,r=e.length;t<r;t++)this.add(e[t])}function supportsMapAndSet(){if("undefined"==typeof Symbol||"undefined"==typeof Map||"undefined"==typeof Set)return!1;var e=Object.getOwnPropertyDescriptor(Map,Symbol.species);return e&&"get"in e&&Map[Symbol.species]===Map}function pick(e,t){for(var r={},n=0,i=t.length;n<i;n++){var o=t[n];o in e&&(r[o]=e[o])}return r}Map$1$1.prototype.get=function(e){var t=mangle(e);return this._store[t]},Map$1$1.prototype.set=function(e,t){var r=mangle(e);return this._store[r]=t,!0},Map$1$1.prototype.has=function(e){return mangle(e)in this._store},Map$1$1.prototype.delete=function(e){var t=mangle(e),r=t in this._store;return delete this._store[t],r},Map$1$1.prototype.forEach=function(e){for(var t=Object.keys(this._store),r=0,n=t.length;r<n;r++){var i=t[r];e(this._store[i],i=unmangle(i))}},Object.defineProperty(Map$1$1.prototype,"size",{get:function(){return Object.keys(this._store).length}}),Set$1$1.prototype.add=function(e){return this._store.set(e,!0)},Set$1$1.prototype.has=function(e){return this._store.has(e)},Set$1$1.prototype.forEach=function(e){this._store.forEach(function(t,r){e(r)})},Object.defineProperty(Set$1$1.prototype,"size",{get:function(){return this._store.size}}),supportsMapAndSet()?(ExportedSet=Set,ExportedMap=Map):(ExportedSet=Set$1$1,ExportedMap=Map$1$1);var MAX_NUM_CONCURRENT_REQUESTS=6;function identityFunction(e){return e}function formatResultForOpenRevsGet(e){return[{ok:e}]}function bulkGet(e,t,r){var n=t.docs,i=new ExportedMap;n.forEach(function(e){i.has(e.id)?i.get(e.id).push(e):i.set(e.id,[e])});var o=i.size,a=0,s=new Array(o);function u(){var e;++a===o&&(e=[],s.forEach(function(t){t.docs.forEach(function(r){e.push({id:t.id,docs:[r]})})}),r(null,{results:e}))}var c=[];i.forEach(function(e,t){c.push(t)});var l=0;function f(){if(!(l>=c.length)){var r,n=Math.min(l+MAX_NUM_CONCURRENT_REQUESTS,c.length),o=c.slice(l,n);r=l,o.forEach(function(n,o){var a=r+o,c=i.get(n),l=pick(c[0],["atts_since","attachments"]);l.open_revs=c.map(function(e){return e.rev}),l.open_revs=l.open_revs.filter(identityFunction);var d=identityFunction;0===l.open_revs.length&&(delete l.open_revs,d=formatResultForOpenRevsGet),["revs","attachments","binary","ajax","latest"].forEach(function(e){e in t&&(l[e]=t[e])}),e.get(n,l,function(e,t){var r,i,o;r=e?[{error:e}]:d(t),i=n,o=r,s[a]={id:i,docs:o},u(),f()})}),l+=o.length}}f()}function isChromeApp(){return!1}function hasLocalStorage(){return!1}function nextTick(e){process.nextTick(e)}function attachBrowserEvents(e){isChromeApp()?chrome.storage.onChanged.addListener(function(t){null!=t.db_name&&e.emit(t.dbName.newValue)}):hasLocalStorage()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(t){e.emit(t.key)}):window.attachEvent("storage",function(t){e.emit(t.key)}))}function Changes(){EventEmitter.call(this),this._listeners={},attachBrowserEvents(this)}function guardedConsole(e){if("undefined"!=typeof console&&"function"==typeof console[e]){var t=Array.prototype.slice.call(arguments,1);console[e].apply(console,t)}}function randomNumber(e,t){return e=parseInt(e,10)||0,(t=parseInt(t,10))!=t||t<=e?t=(e||1)<<1:t+=1,t>6e5&&(e=3e5,t=6e5),~~((t-e)*Math.random()+e)}function defaultBackOff(e){var t=0;return e||(t=2e3),randomNumber(e,t)}inherits(Changes,EventEmitter),Changes.prototype.addListener=function(e,t,r,n){if(!this._listeners[t]){var i=this,o=!1;this._listeners[t]=a,this.on(e,a)}function a(){if(i._listeners[t])if(o)o="waiting";else{o=!0;var e=pick(n,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);r.changes(e).on("change",function(e){e.seq>n.since&&!n.cancelled&&(n.since=e.seq,n.onChange(e))}).on("complete",function(){"waiting"===o&&nextTick(a),o=!1}).on("error",function(){o=!1})}}},Changes.prototype.removeListener=function(e,t){t in this._listeners&&(EventEmitter.prototype.removeListener.call(this,e,this._listeners[t]),delete this._listeners[t])},Changes.prototype.notifyLocalWindows=function(e){isChromeApp()?chrome.storage.local.set({dbName:e}):hasLocalStorage()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},Changes.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)};var res=function(){},assign;assign="function"==typeof Object.assign?Object.assign:function(e){for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};var $inject_Object_assign=assign;function PouchError(e,t,r){Error.call(this,r),this.status=e,this.name=t,this.message=r,this.error=!0}inherits(PouchError,Error),PouchError.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var UNAUTHORIZED=new PouchError(401,"unauthorized","Name or password is incorrect."),MISSING_BULK_DOCS=new PouchError(400,"bad_request","Missing JSON list of 'docs'"),MISSING_DOC=new PouchError(404,"not_found","missing"),REV_CONFLICT=new PouchError(409,"conflict","Document update conflict"),INVALID_ID=new PouchError(400,"bad_request","_id field must contain a string"),MISSING_ID=new PouchError(412,"missing_id","_id is required for puts"),RESERVED_ID=new PouchError(400,"bad_request","Only reserved document ids may start with underscore."),NOT_OPEN=new PouchError(412,"precondition_failed","Database not open"),UNKNOWN_ERROR=new PouchError(500,"unknown_error","Database encountered an unknown error"),BAD_ARG=new PouchError(500,"badarg","Some query argument is invalid"),INVALID_REQUEST=new PouchError(400,"invalid_request","Request was invalid"),QUERY_PARSE_ERROR=new PouchError(400,"query_parse_error","Some query parameter is invalid"),DOC_VALIDATION=new PouchError(500,"doc_validation","Bad special document member"),BAD_REQUEST=new PouchError(400,"bad_request","Something wrong with the request"),NOT_AN_OBJECT=new PouchError(400,"bad_request","Document must be a JSON object"),DB_MISSING=new PouchError(404,"not_found","Database not found"),IDB_ERROR=new PouchError(500,"indexed_db_went_bad","unknown"),WSQ_ERROR=new PouchError(500,"web_sql_went_bad","unknown"),LDB_ERROR=new PouchError(500,"levelDB_went_went_bad","unknown"),FORBIDDEN=new PouchError(403,"forbidden","Forbidden by design doc validate_doc_update function"),INVALID_REV=new PouchError(400,"bad_request","Invalid rev format"),FILE_EXISTS=new PouchError(412,"file_exists","The database could not be created, the file already exists."),MISSING_STUB=new PouchError(412,"missing_stub","A pre-existing attachment stub wasn't found"),INVALID_URL=new PouchError(413,"invalid_url","Provided URL is invalid");function createError(e,t){function r(t){for(var r in e)"function"!=typeof e[r]&&(this[r]=e[r]);void 0!==t&&(this.reason=t)}return r.prototype=PouchError.prototype,new r(t)}function generateErrorFromResponse(e){if("object"!=typeof e){var t=e;(e=UNKNOWN_ERROR).data=t}return"error"in e&&"conflict"===e.error&&(e.name="conflict",e.status=409),"name"in e||(e.name=e.error||"unknown"),"status"in e||(e.status=500),"message"in e||(e.message=e.message||e.reason),e}function tryFilter(e,t,r){try{return!e(t,r)}catch(e){var n="Filter function threw: "+e.toString();return createError(BAD_REQUEST,n)}}function filterChange(e){var t={},r=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(n){n.doc||(n.doc={});var i=r&&tryFilter(e.filter,n.doc,t);if("object"==typeof i)return i;if(i)return!1;if(e.include_docs){if(!e.attachments)for(var o in n.doc._attachments)n.doc._attachments.hasOwnProperty(o)&&(n.doc._attachments[o].stub=!0)}else delete n.doc;return!0}}function flatten(e){for(var t=[],r=0,n=e.length;r<n;r++)t=t.concat(e[r]);return t}function f(){}var hasName=f.name,res$1;res$1=hasName?function(e){return e.name}:function(e){return e.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]};var functionName=res$1;function invalidIdError(e){var t;if(e?"string"!=typeof e?t=createError(INVALID_ID):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=createError(RESERVED_ID)):t=createError(MISSING_ID),t)throw t}function isRemote(e){return"boolean"==typeof e._remote?e._remote:"function"==typeof e.type&&(guardedConsole("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===e.type())}function listenerCount(e,t){return"listenerCount"in e?e.listenerCount(t):EventEmitter.listenerCount(e,t)}function parseDesignDocFunctionName(e){if(!e)return null;var t=e.split("/");return 2===t.length?t:1===t.length?[e,e]:null}function normalizeDesignDocFunctionName(e){var t=parseDesignDocFunctionName(e);return t?t.join("/"):null}var keys$1=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],qName="queryKey",qParser=/(?:^|&)([^&=]*)=?([^&]*)/g,parser=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function parseUri(e){for(var t=parser.exec(e),r={},n=14;n--;){var i=keys$1[n],o=t[n]||"",a=-1!==["user","password"].indexOf(i);r[i]=a?decodeURIComponent(o):o}return r[qName]={},r[keys$1[12]].replace(qParser,function(e,t,n){t&&(r[qName][t]=n)}),r}function upsert(e,t,r){return new PouchPromise(function(n,i){e.get(t,function(o,a){if(o){if(404!==o.status)return i(o);a={}}var s=a._rev,u=r(a);if(!u)return n({updated:!1,rev:s});u._id=t,u._rev=s,n(tryAndPut(e,u,r))})})}function tryAndPut(e,t,r){return e.put(t).then(function(e){return{updated:!0,rev:e.rev}},function(n){if(409!==n.status)throw n;return upsert(e,t._id,r)})}function rev(){return uuid_1.v4().replace(/-/g,"").toLowerCase()}var uuid=uuid_1.v4;function winningRev(e){for(var t,r,n,i,o=e.rev_tree.slice();i=o.pop();){var a=i.ids,s=a[2],u=i.pos;if(s.length)for(var c=0,l=s.length;c<l;c++)o.push({pos:u+1,ids:s[c]});else{var f=!!a[1].deleted,d=a[0];t&&!(n!==f?n:r!==u?r<u:t<d)||(t=d,r=u,n=f)}}return r+"-"+t}function traverseRevTree(e,t){for(var r,n=e.slice();r=n.pop();)for(var i=r.pos,o=r.ids,a=o[2],s=t(0===a.length,i,o[0],r.ctx,o[1]),u=0,c=a.length;u<c;u++)n.push({pos:i+1,ids:a[u],ctx:s})}function sortByPos(e,t){return e.pos-t.pos}function collectLeaves(e){var t=[];traverseRevTree(e,function(e,r,n,i,o){e&&t.push({rev:r+"-"+n,pos:r,opts:o})}),t.sort(sortByPos).reverse();for(var r=0,n=t.length;r<n;r++)delete t[r].pos;return t}function collectConflicts(e){for(var t=winningRev(e),r=collectLeaves(e.rev_tree),n=[],i=0,o=r.length;i<o;i++){var a=r[i];a.rev===t||a.opts.deleted||n.push(a.rev)}return n}function compactTree(e){var t=[];return traverseRevTree(e.rev_tree,function(e,r,n,i,o){"available"!==o.status||e||(t.push(r+"-"+n),o.status="missing")}),t}function rootToLeaf(e){for(var t,r=[],n=e.slice();t=n.pop();){var i=t.pos,o=t.ids,a=o[0],s=o[1],u=o[2],c=0===u.length,l=t.history?t.history.slice():[];l.push({id:a,opts:s}),c&&r.push({pos:i+1-l.length,ids:l});for(var f=0,d=u.length;f<d;f++)n.push({pos:i+1,ids:u[f],history:l})}return r.reverse()}function sortByPos$1(e,t){return e.pos-t.pos}function binarySearch(e,t,r){for(var n,i=0,o=e.length;i<o;)r(e[n=i+o>>>1],t)<0?i=n+1:o=n;return i}function insertSorted(e,t,r){var n=binarySearch(e,t,r);e.splice(n,0,t)}function pathToTree(e,t){for(var r,n,i=t,o=e.length;i<o;i++){var a=e[i],s=[a.id,a.opts,[]];n?(n[2].push(s),n=s):r=n=s}return r}function compareTree(e,t){return e[0]<t[0]?-1:1}function mergeTree(e,t){for(var r=[{tree1:e,tree2:t}],n=!1;r.length>0;){var i=r.pop(),o=i.tree1,a=i.tree2;(o[1].status||a[1].status)&&(o[1].status="available"===o[1].status||"available"===a[1].status?"available":"missing");for(var s=0;s<a[2].length;s++)if(o[2][0]){for(var u=!1,c=0;c<o[2].length;c++)o[2][c][0]===a[2][s][0]&&(r.push({tree1:o[2][c],tree2:a[2][s]}),u=!0);u||(n="new_branch",insertSorted(o[2],a[2][s],compareTree))}else n="new_leaf",o[2][0]=a[2][s]}return{conflicts:n,tree:e}}function doMerge(e,t,r){var n,i=[],o=!1,a=!1;if(!e.length)return{tree:[t],conflicts:"new_leaf"};for(var s=0,u=e.length;s<u;s++){var c=e[s];if(c.pos===t.pos&&c.ids[0]===t.ids[0])n=mergeTree(c.ids,t.ids),i.push({pos:c.pos,ids:n.tree}),o=o||n.conflicts,a=!0;else if(!0!==r){var l=c.pos<t.pos?c:t,f=c.pos<t.pos?t:c,d=f.pos-l.pos,h=[],p=[];for(p.push({ids:l.ids,diff:d,parent:null,parentIdx:null});p.length>0;){var m=p.pop();if(0!==m.diff)for(var g=m.ids[2],y=0,b=g.length;y<b;y++)p.push({ids:g[y],diff:m.diff-1,parent:m.ids,parentIdx:y});else m.ids[0]===f.ids[0]&&h.push(m)}var v=h[0];v?(n=mergeTree(v.ids,f.ids),v.parent[2][v.parentIdx]=n.tree,i.push({pos:l.pos,ids:l.ids}),o=o||n.conflicts,a=!0):i.push(c)}else i.push(c)}return a||i.push(t),i.sort(sortByPos$1),{tree:i,conflicts:o||"internal_node"}}function stem(e,t){for(var r,n,i=rootToLeaf(e),o=0,a=i.length;o<a;o++){var s,u=i[o],c=u.ids;if(c.length>t){r||(r={});var l=c.length-t;s={pos:u.pos+l,ids:pathToTree(c,l)};for(var f=0;f<l;f++){var d=u.pos+f+"-"+c[f].id;r[d]=!0}}else s={pos:u.pos,ids:pathToTree(c,0)};n=n?doMerge(n,s,!0).tree:[s]}return r&&traverseRevTree(n,function(e,t,n){delete r[t+"-"+n]}),{tree:n,revs:r?Object.keys(r):[]}}function merge$1(e,t,r){var n=doMerge(e,t),i=stem(n.tree,r);return{tree:i.tree,stemmedRevs:i.revs,conflicts:n.conflicts}}function revExists(e,t){for(var r,n=e.slice(),i=t.split("-"),o=parseInt(i[0],10),a=i[1];r=n.pop();){if(r.pos===o&&r.ids[0]===a)return!0;for(var s=r.ids[2],u=0,c=s.length;u<c;u++)n.push({pos:r.pos+1,ids:s[u]})}return!1}function getTrees(e){return e.ids}function isDeleted(e,t){t||(t=winningRev(e));for(var r,n=t.substring(t.indexOf("-")+1),i=e.rev_tree.map(getTrees);r=i.pop();){if(r[0]===n)return!!r[1].deleted;i=i.concat(r[2])}}function isLocalId(e){return/^_local/.test(e)}function latest(e,t){for(var r,n=t.rev_tree.slice();r=n.pop();){var i=r.pos,o=r.ids,a=o[0],s=o[1],u=o[2],c=0===u.length,l=r.history?r.history.slice():[];if(l.push({id:a,pos:i,opts:s}),c)for(var f=0,d=l.length;f<d;f++){var h=l[f];if(h.pos+"-"+h.id===e)return i+"-"+a}for(var p=0,m=u.length;p<m;p++)n.push({pos:i+1,ids:u[p],history:l})}throw new Error("Unable to resolve latest revision for id "+t.id+", rev "+e)}function tryCatchInChangeListener(e,t,r,n){try{e.emit("change",t,r,n)}catch(e){guardedConsole("error",'Error in .on("change", function):',e)}}function Changes$2(e,t,r){EventEmitter.call(this);var n=this;this.db=e;var i=(t=t?clone(t):{}).complete=once(function(t,r){t?listenerCount(n,"error")>0&&n.emit("error",t):n.emit("complete",r),n.removeAllListeners(),e.removeListener("destroyed",o)});function o(){n.cancel()}r&&(n.on("complete",function(e){r(null,e)}),n.on("error",r)),e.once("destroyed",o),t.onChange=function(e,t,r){n.isCancelled||tryCatchInChangeListener(n,e,t,r)};var a=new PouchPromise(function(e,r){t.complete=function(t,n){t?r(t):e(n)}});n.once("cancel",function(){e.removeListener("destroyed",o),t.complete(null,{status:"cancelled"})}),this.then=a.then.bind(a),this.catch=a.catch.bind(a),this.then(function(e){i(null,e)},i),e.taskqueue.isReady?n.validateChanges(t):e.taskqueue.addTask(function(e){e?t.complete(e):n.isCancelled?n.emit("cancel"):n.validateChanges(t)})}function processChange(e,t,r){var n=[{rev:e._rev}];"all_docs"===r.style&&(n=collectLeaves(t.rev_tree).map(function(e){return{rev:e.rev}}));var i={id:t.id,changes:n,doc:e};return isDeleted(t,e._rev)&&(i.deleted=!0),r.conflicts&&(i.doc._conflicts=collectConflicts(t),i.doc._conflicts.length||delete i.doc._conflicts),i}function compare(e,t){return e<t?-1:e>t?1:0}function yankError(e,t){return function(r,n){r||n[0]&&n[0].error?((r=r||n[0]).docId=t,e(r)):e(null,n.length?n[0]:n)}}function cleanDocs(e){for(var t=0;t<e.length;t++){var r=e[t];if(r._deleted)delete r._attachments;else if(r._attachments)for(var n=Object.keys(r._attachments),i=0;i<n.length;i++){var o=n[i];r._attachments[o]=pick(r._attachments[o],["data","digest","content_type","length","revpos","stub"])}}}function compareByIdThenRev(e,t){var r=compare(e._id,t._id);return 0!==r?r:compare(e._revisions?e._revisions.start:0,t._revisions?t._revisions.start:0)}function computeHeight$1(e){var t={},r=[];return traverseRevTree(e,function(e,n,i,o){var a=n+"-"+i;return e&&(t[a]=0),void 0!==o&&r.push({from:o,to:a}),a}),r.reverse(),r.forEach(function(e){void 0===t[e.from]?t[e.from]=1+t[e.to]:t[e.from]=Math.min(t[e.from],1+t[e.to])}),t}function allDocsKeysParse(e){var t="limit"in e?e.keys.slice(e.skip,e.limit+e.skip):e.skip>0?e.keys.slice(e.skip):e.keys;e.keys=t,e.skip=0,e.descending&&(t.reverse(),e.descending=!1)}function doNextCompaction(e){var t=e._compactionQueue[0],r=t.opts,n=t.callback;e.get("_local/compaction").catch(function(){return!1}).then(function(t){t&&t.last_seq&&(r.last_seq=t.last_seq),e._compact(r,function(t,r){t?n(t):n(null,r),nextTick(function(){e._compactionQueue.shift(),e._compactionQueue.length&&doNextCompaction(e)})})})}function attachmentNameError(e){return"_"===e.charAt(0)&&e+" is not a valid attachment name, attachment names cannot start with '_'"}function AbstractPouchDB(){EventEmitter.call(this)}function TaskQueue$1(){this.isReady=!1,this.failed=!1,this.queue=[]}function parseAdapter(e,t){var r=e.match(/([a-z-]*):\/\/(.*)/);if(r)return{name:/https?/.test(r[1])?r[1]+"://"+r[2]:r[2],adapter:r[1]};var n=PouchDB$5.adapters,i=PouchDB$5.preferredAdapters,o=PouchDB$5.prefix,a=t.adapter;if(!a)for(var s=0;s<i.length&&("idb"===(a=i[s])&&"websql"in n&&hasLocalStorage()&&localStorage["_pouch__websqldb_"+o+e]);++s)guardedConsole("log",'PouchDB is downgrading "'+e+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');var u=n[a];return{name:!(u&&"use_prefix"in u)||u.use_prefix?o+e:e,adapter:a}}function prepareForDestruction(e){function t(t){e.removeListener("closed",r),t||e.constructor.emit("destroyed",e.name)}function r(){e.removeListener("destroyed",t),e.constructor.emit("unref",e)}e.once("destroyed",t),e.once("closed",r),e.constructor.emit("ref",e)}function PouchDB$5(e,t){if(!(this instanceof PouchDB$5))return new PouchDB$5(e,t);var r=this;if(t=t||{},e&&"object"==typeof e&&(e=(t=e).name,delete t.name),this.__opts=t=clone(t),r.auto_compaction=t.auto_compaction,r.prefix=PouchDB$5.prefix,"string"!=typeof e)throw new Error("Missing/invalid DB name");var n=parseAdapter((t.prefix||"")+e,t);if(t.name=n.name,t.adapter=t.adapter||n.adapter,r.name=e,r._adapter=t.adapter,PouchDB$5.emit("debug",["adapter","Picked adapter: ",t.adapter]),!PouchDB$5.adapters[t.adapter]||!PouchDB$5.adapters[t.adapter].valid())throw new Error("Invalid Adapter: "+t.adapter);AbstractPouchDB.call(r),r.taskqueue=new TaskQueue$1,r.adapter=t.adapter,PouchDB$5.adapters[t.adapter].call(r,t,function(e){if(e)return r.taskqueue.fail(e);prepareForDestruction(r),r.emit("created",r),PouchDB$5.emit("created",r.name),r.taskqueue.ready(r)})}inherits(Changes$2,EventEmitter),Changes$2.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},Changes$2.prototype.validateChanges=function(e){var t=e.complete,r=this;PouchDB$5._changesFilterPlugin?PouchDB$5._changesFilterPlugin.validate(e,function(n){if(n)return t(n);r.doChanges(e)}):r.doChanges(e)},Changes$2.prototype.doChanges=function(e){var t=this,r=e.complete;if("live"in(e=clone(e))&&!("continuous"in e)&&(e.continuous=e.live),e.processChange=processChange,"latest"===e.since&&(e.since="now"),e.since||(e.since=0),"now"!==e.since){if(PouchDB$5._changesFilterPlugin){if(PouchDB$5._changesFilterPlugin.normalize(e),PouchDB$5._changesFilterPlugin.shouldFilter(this,e))return PouchDB$5._changesFilterPlugin.filter(this,e)}else["doc_ids","filter","selector","view"].forEach(function(t){t in e&&guardedConsole("warn",'The "'+t+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')});"descending"in e||(e.descending=!1),e.limit=0===e.limit?1:e.limit,e.complete=r;var n=this.db._changes(e);if(n&&"function"==typeof n.cancel){var i=t.cancel;t.cancel=argsarray(function(e){n.cancel(),i.apply(this,e)})}}else this.db.info().then(function(n){t.isCancelled?r(null,{status:"cancelled"}):(e.since=n.update_seq,t.doChanges(e))},r)},inherits(AbstractPouchDB,EventEmitter),AbstractPouchDB.prototype.post=adapterFun("post",function(e,t,r){if("function"==typeof t&&(r=t,t={}),"object"!=typeof e||Array.isArray(e))return r(createError(NOT_AN_OBJECT));this.bulkDocs({docs:[e]},t,yankError(r,e._id))}),AbstractPouchDB.prototype.put=adapterFun("put",function(e,t,r){if("function"==typeof t&&(r=t,t={}),"object"!=typeof e||Array.isArray(e))return r(createError(NOT_AN_OBJECT));if(invalidIdError(e._id),isLocalId(e._id)&&"function"==typeof this._putLocal)return e._deleted?this._removeLocal(e,r):this._putLocal(e,r);var n,i,o,a,s=this;function u(r){"function"==typeof s._put&&!1!==t.new_edits?s._put(e,t,r):s.bulkDocs({docs:[e]},t,yankError(r,e._id))}t.force&&e._rev?(n=e._rev.split("-"),i=n[1],o=parseInt(n[0],10)+1,a=rev(),e._revisions={start:o,ids:[a,i]},e._rev=o+"-"+a,t.new_edits=!1,u(function(t){var n=t?null:{ok:!0,id:e._id,rev:e._rev};r(t,n)})):u(r)}),AbstractPouchDB.prototype.putAttachment=adapterFun("putAttachment",function(e,t,r,n,i){var o=this;function a(e){var r="_rev"in e?parseInt(e._rev,10):0;return e._attachments=e._attachments||{},e._attachments[t]={content_type:i,data:n,revpos:++r},o.put(e)}return"function"==typeof i&&(i=n,n=r,r=null),void 0===i&&(i=n,n=r,r=null),i||guardedConsole("warn","Attachment",t,"on document",e,"is missing content_type"),o.get(e).then(function(e){if(e._rev!==r)throw createError(REV_CONFLICT);return a(e)},function(t){if(t.reason===MISSING_DOC.message)return a({_id:e});throw t})}),AbstractPouchDB.prototype.removeAttachment=adapterFun("removeAttachment",function(e,t,r,n){var i=this;i.get(e,function(e,o){if(e)n(e);else if(o._rev===r){if(!o._attachments)return n();delete o._attachments[t],0===Object.keys(o._attachments).length&&delete o._attachments,i.put(o,n)}else n(createError(REV_CONFLICT))})}),AbstractPouchDB.prototype.remove=adapterFun("remove",function(e,t,r,n){var i;"string"==typeof t?(i={_id:e,_rev:t},"function"==typeof r&&(n=r,r={})):(i=e,"function"==typeof t?(n=t,r={}):(n=r,r=t)),(r=r||{}).was_delete=!0;var o={_id:i._id,_rev:i._rev||r.rev};if(o._deleted=!0,isLocalId(o._id)&&"function"==typeof this._removeLocal)return this._removeLocal(i,n);this.bulkDocs({docs:[o]},r,yankError(n,o._id))}),AbstractPouchDB.prototype.revsDiff=adapterFun("revsDiff",function(e,t,r){"function"==typeof t&&(r=t,t={});var n=Object.keys(e);if(!n.length)return r(null,{});var i=0,o=new ExportedMap;function a(e,t){o.has(e)||o.set(e,{missing:[]}),o.get(e).missing.push(t)}n.map(function(t){this._getRevisionTree(t,function(s,u){if(s&&404===s.status&&"missing"===s.message)o.set(t,{missing:e[t]});else{if(s)return r(s);l=u,f=e[c=t].slice(0),traverseRevTree(l,function(e,t,r,n,i){var o=t+"-"+r,s=f.indexOf(o);-1!==s&&(f.splice(s,1),"available"!==i.status&&a(c,o))}),f.forEach(function(e){a(c,e)})}var c,l,f;if(++i===n.length){var d={};return o.forEach(function(e,t){d[t]=e}),r(null,d)}})},this)}),AbstractPouchDB.prototype.bulkGet=adapterFun("bulkGet",function(e,t){bulkGet(this,e,t)}),AbstractPouchDB.prototype.compactDocument=adapterFun("compactDocument",function(e,t,r){var n=this;this._getRevisionTree(e,function(i,o){if(i)return r(i);var a=computeHeight$1(o),s=[],u=[];Object.keys(a).forEach(function(e){a[e]>t&&s.push(e)}),traverseRevTree(o,function(e,t,r,n,i){var o=t+"-"+r;"available"===i.status&&-1!==s.indexOf(o)&&u.push(o)}),n._doCompaction(e,u,r)})}),AbstractPouchDB.prototype.compact=adapterFun("compact",function(e,t){"function"==typeof e&&(t=e,e={});e=e||{},this._compactionQueue=this._compactionQueue||[],this._compactionQueue.push({opts:e,callback:t}),1===this._compactionQueue.length&&doNextCompaction(this)}),AbstractPouchDB.prototype._compact=function(e,t){var r=this,n={return_docs:!1,last_seq:e.last_seq||0},i=[];r.changes(n).on("change",function(e){i.push(r.compactDocument(e.id,0))}).on("complete",function(e){var n=e.last_seq;PouchPromise.all(i).then(function(){return upsert(r,"_local/compaction",function(e){return(!e.last_seq||e.last_seq<n)&&(e.last_seq=n,e)})}).then(function(){t(null,{ok:!0})}).catch(t)}).on("error",t)},AbstractPouchDB.prototype.get=adapterFun("get",function(e,t,r){if("function"==typeof t&&(r=t,t={}),"string"!=typeof e)return r(createError(INVALID_ID));if(isLocalId(e)&&"function"==typeof this._getLocal)return this._getLocal(e,r);var n=[],i=this;function o(){var o=[],a=n.length;if(!a)return r(null,o);n.forEach(function(n){i.get(e,{rev:n,revs:t.revs,latest:t.latest,attachments:t.attachments,binary:t.binary},function(e,t){if(e)o.push({missing:n});else{for(var i,s=0,u=o.length;s<u;s++)if(o[s].ok&&o[s].ok._rev===t._rev){i=!0;break}i||o.push({ok:t})}--a||r(null,o)})})}if(!t.open_revs)return this._get(e,t,function(n,o){if(n)return n.docId=e,r(n);var a=o.doc,s=o.metadata,u=o.ctx;if(t.conflicts){var c=collectConflicts(s);c.length&&(a._conflicts=c)}if(isDeleted(s,a._rev)&&(a._deleted=!0),t.revs||t.revs_info){for(var l=a._rev.split("-"),f=parseInt(l[0],10),d=l[1],h=rootToLeaf(s.rev_tree),p=null,m=0;m<h.length;m++){var g=h[m],y=g.ids.map(function(e){return e.id}).indexOf(d);(y===f-1||!p&&-1!==y)&&(p=g)}var b=p.ids.map(function(e){return e.id}).indexOf(a._rev.split("-")[1])+1,v=p.ids.length-b;if(p.ids.splice(b,v),p.ids.reverse(),t.revs&&(a._revisions={start:p.pos+p.ids.length-1,ids:p.ids.map(function(e){return e.id})}),t.revs_info){var _=p.pos+p.ids.length;a._revs_info=p.ids.map(function(e){return{rev:--_+"-"+e.id,status:e.opts.status}})}}if(t.attachments&&a._attachments){var w=a._attachments,E=Object.keys(w).length;if(0===E)return r(null,a);Object.keys(w).forEach(function(e){this._getAttachment(a._id,e,w[e],{rev:a._rev,binary:t.binary,ctx:u},function(t,n){var i=a._attachments[e];i.data=n,delete i.stub,delete i.length,--E||r(null,a)})},i)}else{if(a._attachments)for(var $ in a._attachments)a._attachments.hasOwnProperty($)&&(a._attachments[$].stub=!0);r(null,a)}});if("all"===t.open_revs)this._getRevisionTree(e,function(e,t){if(e)return r(e);n=collectLeaves(t).map(function(e){return e.rev}),o()});else{if(!Array.isArray(t.open_revs))return r(createError(UNKNOWN_ERROR,"function_clause"));n=t.open_revs;for(var a=0;a<n.length;a++){var s=n[a];if("string"!=typeof s||!/^\d+-/.test(s))return r(createError(INVALID_REV))}o()}}),AbstractPouchDB.prototype.getAttachment=adapterFun("getAttachment",function(e,t,r,n){var i=this;r instanceof Function&&(n=r,r={}),this._get(e,r,function(o,a){return o?n(o):a.doc._attachments&&a.doc._attachments[t]?(r.ctx=a.ctx,r.binary=!0,void i._getAttachment(e,t,a.doc._attachments[t],r,n)):n(createError(MISSING_DOC))})}),AbstractPouchDB.prototype.allDocs=adapterFun("allDocs",function(e,t){if("function"==typeof e&&(t=e,e={}),e.skip=void 0!==e.skip?e.skip:0,e.start_key&&(e.startkey=e.start_key),e.end_key&&(e.endkey=e.end_key),"keys"in e){if(!Array.isArray(e.keys))return t(new TypeError("options.keys must be an array"));var r=["startkey","endkey","key"].filter(function(t){return t in e})[0];if(r)return void t(createError(QUERY_PARSE_ERROR,"Query parameter `"+r+"` is not compatible with multi-get"));if(!isRemote(this)&&(allDocsKeysParse(e),0===e.keys.length))return this._allDocs({limit:0},t)}return this._allDocs(e,t)}),AbstractPouchDB.prototype.changes=function(e,t){return"function"==typeof e&&(t=e,e={}),new Changes$2(this,e,t)},AbstractPouchDB.prototype.close=adapterFun("close",function(e){return this._closed=!0,this.emit("closed"),this._close(e)}),AbstractPouchDB.prototype.info=adapterFun("info",function(e){var t=this;this._info(function(r,n){if(r)return e(r);n.db_name=n.db_name||t.name,n.auto_compaction=!(!t.auto_compaction||isRemote(t)),n.adapter=t.adapter,e(null,n)})}),AbstractPouchDB.prototype.id=adapterFun("id",function(e){return this._id(e)}),AbstractPouchDB.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},AbstractPouchDB.prototype.bulkDocs=adapterFun("bulkDocs",function(e,t,r){if("function"==typeof t&&(r=t,t={}),t=t||{},Array.isArray(e)&&(e={docs:e}),!e||!e.docs||!Array.isArray(e.docs))return r(createError(MISSING_BULK_DOCS));for(var n=0;n<e.docs.length;++n)if("object"!=typeof e.docs[n]||Array.isArray(e.docs[n]))return r(createError(NOT_AN_OBJECT));var i;if(e.docs.forEach(function(e){e._attachments&&Object.keys(e._attachments).forEach(function(t){i=i||attachmentNameError(t),e._attachments[t].content_type||guardedConsole("warn","Attachment",t,"on document",e._id,"is missing content_type")})}),i)return r(createError(BAD_REQUEST,i));"new_edits"in t||(t.new_edits=!("new_edits"in e)||e.new_edits);var o=this;t.new_edits||isRemote(o)||e.docs.sort(compareByIdThenRev),cleanDocs(e.docs);var a=e.docs.map(function(e){return e._id});return this._bulkDocs(e,t,function(e,n){if(e)return r(e);if(t.new_edits||(n=n.filter(function(e){return e.error})),!isRemote(o))for(var i=0,s=n.length;i<s;i++)n[i].id=n[i].id||a[i];r(null,n)})}),AbstractPouchDB.prototype.registerDependentDatabase=adapterFun("registerDependentDatabase",function(e,t){var r=new this.constructor(e,this.__opts);upsert(this,"_local/_pouch_dependentDbs",function(t){return t.dependentDbs=t.dependentDbs||{},!t.dependentDbs[e]&&(t.dependentDbs[e]=!0,t)}).then(function(){t(null,{db:r})}).catch(t)}),AbstractPouchDB.prototype.destroy=adapterFun("destroy",function(e,t){"function"==typeof e&&(t=e,e={});var r=this,n=!("use_prefix"in r)||r.use_prefix;function i(){r._destroy(e,function(e,n){if(e)return t(e);r._destroyed=!0,r.emit("destroyed"),t(null,n||{ok:!0})})}if(isRemote(r))return i();r.get("_local/_pouch_dependentDbs",function(e,o){if(e)return 404!==e.status?t(e):i();var a=o.dependentDbs,s=r.constructor,u=Object.keys(a).map(function(e){var t=n?e.replace(new RegExp("^"+s.prefix),""):e;return new s(t,r.__opts).destroy()});PouchPromise.all(u).then(i,t)})}),TaskQueue$1.prototype.execute=function(){var e;if(this.failed)for(;e=this.queue.shift();)e(this.failed);else for(;e=this.queue.shift();)e()},TaskQueue$1.prototype.fail=function(e){this.failed=e,this.execute()},TaskQueue$1.prototype.ready=function(e){this.isReady=!0,this.db=e,this.execute()},TaskQueue$1.prototype.addTask=function(e){this.queue.push(e),this.failed&&this.execute()},inherits(PouchDB$5,AbstractPouchDB),PouchDB$5.adapters={},PouchDB$5.preferredAdapters=[],PouchDB$5.prefix="_pouch_";var eventEmitter=new EventEmitter;function setUpEventEmitter(e){Object.keys(EventEmitter.prototype).forEach(function(t){"function"==typeof EventEmitter.prototype[t]&&(e[t]=eventEmitter[t].bind(eventEmitter))});var t=e._destructionListeners=new ExportedMap;e.on("ref",function(e){t.has(e.name)||t.set(e.name,[]),t.get(e.name).push(e)}),e.on("unref",function(e){if(t.has(e.name)){var r=t.get(e.name),n=r.indexOf(e);n<0||(r.splice(n,1),r.length>1?t.set(e.name,r):t.delete(e.name))}}),e.on("destroyed",function(e){if(t.has(e)){var r=t.get(e);t.delete(e),r.forEach(function(e){e.emit("destroyed",!0)})}})}setUpEventEmitter(PouchDB$5),PouchDB$5.adapter=function(e,t,r){t.valid()&&(PouchDB$5.adapters[e]=t,r&&PouchDB$5.preferredAdapters.push(e))},PouchDB$5.plugin=function(e){if("function"==typeof e)e(PouchDB$5);else{if("object"!=typeof e||0===Object.keys(e).length)throw new Error('Invalid plugin: got "'+e+'", expected an object or a function');Object.keys(e).forEach(function(t){PouchDB$5.prototype[t]=e[t]})}return this.__defaults&&(PouchDB$5.__defaults=$inject_Object_assign({},this.__defaults)),PouchDB$5},PouchDB$5.defaults=function(e){function t(e,r){if(!(this instanceof t))return new t(e,r);r=r||{},e&&"object"==typeof e&&(e=(r=e).name,delete r.name),r=$inject_Object_assign({},t.__defaults,r),PouchDB$5.call(this,e,r)}return inherits(t,PouchDB$5),t.preferredAdapters=PouchDB$5.preferredAdapters.slice(),Object.keys(PouchDB$5).forEach(function(e){e in t||(t[e]=PouchDB$5[e])}),t.__defaults=$inject_Object_assign({},this.__defaults,e),t};var version$1="6.4.1";function debugPouch(e){e.debug=src;var t={};e.on("debug",function(e){var r=e[0],n=e.slice(1);t[r]||(t[r]=src("pouchdb:"+r)),t[r].apply(null,n)})}function getFieldFromDoc(e,t){for(var r=e,n=0,i=t.length;n<i;n++){if(!(r=r[t[n]]))break}return r}function compare$1(e,t){return e<t?-1:e>t?1:0}function parseField(e){for(var t=[],r="",n=0,i=e.length;n<i;n++){var o=e[n];"."===o?n>0&&"\\"===e[n-1]?r=r.substring(0,r.length-1)+".":(t.push(r),r=""):r+=o}return t.push(r),t}var combinationFields=["$or","$nor","$not"];function isCombinationalField(e){return combinationFields.indexOf(e)>-1}function getKey(e){return Object.keys(e)[0]}function getValue(e){return e[getKey(e)]}function mergeAndedSelectors(e){var t={};return e.forEach(function(e){Object.keys(e).forEach(function(r){var n=e[r];if("object"!=typeof n&&(n={$eq:n}),isCombinationalField(r))n instanceof Array?t[r]=n.map(function(e){return mergeAndedSelectors([e])}):t[r]=mergeAndedSelectors([n]);else{var i=t[r]=t[r]||{};Object.keys(n).forEach(function(e){var t=n[e];return"$gt"===e||"$gte"===e?mergeGtGte(e,t,i):"$lt"===e||"$lte"===e?mergeLtLte(e,t,i):"$ne"===e?mergeNe(t,i):"$eq"===e?mergeEq(t,i):void(i[e]=t)})}})}),t}function mergeGtGte(e,t,r){void 0===r.$eq&&(void 0!==r.$gte?"$gte"===e?t>r.$gte&&(r.$gte=t):t>=r.$gte&&(delete r.$gte,r.$gt=t):void 0!==r.$gt?"$gte"===e?t>r.$gt&&(delete r.$gt,r.$gte=t):t>r.$gt&&(r.$gt=t):r[e]=t)}function mergeLtLte(e,t,r){void 0===r.$eq&&(void 0!==r.$lte?"$lte"===e?t<r.$lte&&(r.$lte=t):t<=r.$lte&&(delete r.$lte,r.$lt=t):void 0!==r.$lt?"$lte"===e?t<r.$lt&&(delete r.$lt,r.$lte=t):t<r.$lt&&(r.$lt=t):r[e]=t)}function mergeNe(e,t){"$ne"in t?t.$ne.push(e):t.$ne=[e]}function mergeEq(e,t){delete t.$gt,delete t.$gte,delete t.$lt,delete t.$lte,delete t.$ne,t.$eq=e}function massageSelector(e){var t=clone(e),r=!1;"$and"in t&&(t=mergeAndedSelectors(t.$and),r=!0),["$or","$nor"].forEach(function(e){e in t&&t[e].forEach(function(e){for(var t=Object.keys(e),r=0;r<t.length;r++){var n=t[r],i=e[n];"object"==typeof i&&null!==i||(e[n]={$eq:i})}})}),"$not"in t&&(t.$not=mergeAndedSelectors([t.$not]));for(var n=Object.keys(t),i=0;i<n.length;i++){var o=n[i],a=t[o];"object"!=typeof a||null===a?a={$eq:a}:"$ne"in a&&!r&&(a.$ne=[a.$ne]),t[o]=a}return t}function pad$1(e,t,r){for(var n="",i=r-e.length;n.length<i;)n+=t;return n}function padLeft(e,t,r){return pad$1(e,t,r)+e}var MIN_MAGNITUDE=-324,MAGNITUDE_DIGITS=3,SEP="";function collate(e,t){if(e===t)return 0;e=normalizeKey(e),t=normalizeKey(t);var r=collationIndex(e),n=collationIndex(t);if(r-n!=0)return r-n;switch(typeof e){case"number":return e-t;case"boolean":return e<t?-1:1;case"string":return stringCollate(e,t)}return Array.isArray(e)?arrayCollate(e,t):objectCollate(e,t)}function normalizeKey(e){switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-1/0||isNaN(e)?null:e;case"object":var t=e;if(Array.isArray(e)){var r=e.length;e=new Array(r);for(var n=0;n<r;n++)e[n]=normalizeKey(t[n])}else{if(e instanceof Date)return e.toJSON();if(null!==e){e={};for(var i in t)if(t.hasOwnProperty(i)){var o=t[i];void 0!==o&&(e[i]=normalizeKey(o))}}}}return e}function indexify(e){if(null!==e)switch(typeof e){case"boolean":return e?1:0;case"number":return numToIndexableString(e);case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var t=Array.isArray(e),r=t?e:Object.keys(e),n=-1,i=r.length,o="";if(t)for(;++n<i;)o+=toIndexableString(r[n]);else for(;++n<i;){var a=r[n];o+=toIndexableString(a)+toIndexableString(e[a])}return o}return""}function toIndexableString(e){return collationIndex(e=normalizeKey(e))+SEP+indexify(e)+"\0"}function parseNumber(e,t){var r,n=t;if("1"===e[t])r=0,t++;else{var i="0"===e[t];t++;var o="",a=e.substring(t,t+MAGNITUDE_DIGITS),s=parseInt(a,10)+MIN_MAGNITUDE;for(i&&(s=-s),t+=MAGNITUDE_DIGITS;;){var u=e[t];if("\0"===u)break;o+=u,t++}r=1===(o=o.split(".")).length?parseInt(o,10):parseFloat(o[0]+"."+o[1]),i&&(r-=10),0!==s&&(r=parseFloat(r+"e"+s))}return{num:r,length:t-n}}function pop(e,t){var r=e.pop();if(t.length){var n=t[t.length-1];r===n.element&&(t.pop(),n=t[t.length-1]);var i=n.element,o=n.index;if(Array.isArray(i))i.push(r);else if(o===e.length-2){i[e.pop()]=r}else e.push(r)}}function parseIndexableString(e){for(var t=[],r=[],n=0;;){var i=e[n++];if("\0"!==i)switch(i){case"1":t.push(null);break;case"2":t.push("1"===e[n]),n++;break;case"3":var o=parseNumber(e,n);t.push(o.num),n+=o.length;break;case"4":for(var a="";;){var s=e[n];if("\0"===s)break;a+=s,n++}a=a.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),t.push(a);break;case"5":var u={element:[],index:t.length};t.push(u.element),r.push(u);break;case"6":var c={element:{},index:t.length};t.push(c.element),r.push(c);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+i)}else{if(1===t.length)return t.pop();pop(t,r)}}}function arrayCollate(e,t){for(var r=Math.min(e.length,t.length),n=0;n<r;n++){var i=collate(e[n],t[n]);if(0!==i)return i}return e.length===t.length?0:e.length>t.length?1:-1}function stringCollate(e,t){return e===t?0:e>t?1:-1}function objectCollate(e,t){for(var r=Object.keys(e),n=Object.keys(t),i=Math.min(r.length,n.length),o=0;o<i;o++){var a=collate(r[o],n[o]);if(0!==a)return a;if(0!==(a=collate(e[r[o]],t[n[o]])))return a}return r.length===n.length?0:r.length>n.length?1:-1}function collationIndex(e){var t=["boolean","number","string","object"].indexOf(typeof e);return~t?null===e?1:Array.isArray(e)?5:t<3?t+2:t+3:Array.isArray(e)?5:void 0}function numToIndexableString(e){if(0===e)return"1";var t=e.toExponential().split(/e\+?/),r=parseInt(t[1],10),n=e<0,i=n?"0":"2",o=padLeft(((n?-r:r)-MIN_MAGNITUDE).toString(),"0",MAGNITUDE_DIGITS);i+=SEP+o;var a=Math.abs(parseFloat(t[0]));n&&(a=10-a);var s=a.toFixed(20);return s=s.replace(/\.?0+$/,""),i+=SEP+s}function createFieldSorter(e){function t(t){return e.map(function(e){var r=parseField(getKey(e));return getFieldFromDoc(t,r)})}return function(e,r){var n=collate(t(e.doc),t(r.doc));return 0!==n?n:compare$1(e.doc._id,r.doc._id)}}function filterInMemoryFields(e,t,r){if(e=e.filter(function(e){return rowFilter(e.doc,t.selector,r)}),t.sort){var n=createFieldSorter(t.sort);e=e.sort(n),"string"!=typeof t.sort[0]&&"desc"===getValue(t.sort[0])&&(e=e.reverse())}if("limit"in t||"skip"in t){var i=t.skip||0,o=("limit"in t?t.limit:e.length)+i;e=e.slice(i,o)}return e}function rowFilter(e,t,r){return r.every(function(r){var n=t[r],i=parseField(r),o=getFieldFromDoc(e,i);return isCombinationalField(r)?matchCominationalSelector(r,n,e):matchSelector(n,e,i,o)})}function matchSelector(e,t,r,n){return!e||Object.keys(e).every(function(i){var o=e[i];return match(i,t,o,r,n)})}function matchCominationalSelector(e,t,r){return"$or"===e?t.some(function(e){return rowFilter(r,e,Object.keys(e))}):"$not"===e?!rowFilter(r,t,Object.keys(t)):!t.find(function(e){return rowFilter(r,e,Object.keys(e))})}function match(e,t,r,n,i){if(!matchers[e])throw new Error('unknown operator "'+e+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return matchers[e](t,r,n,i)}function fieldExists(e){return void 0!==e&&null!==e}function fieldIsNotUndefined(e){return void 0!==e}function modField(e,t){var r=t[0],n=t[1];if(0===r)throw new Error("Bad divisor, cannot divide by zero");if(parseInt(r,10)!==r)throw new Error("Divisor is not an integer");if(parseInt(n,10)!==n)throw new Error("Modulus is not an integer");return parseInt(e,10)===e&&e%r===n}function arrayContainsValue(e,t){return t.some(function(t){return e instanceof Array?e.indexOf(t)>-1:e===t})}function arrayContainsAllValues(e,t){return t.every(function(t){return e.indexOf(t)>-1})}function arraySize(e,t){return e.length===t}function regexMatch(e,t){return new RegExp(t).test(e)}function typeMatch(e,t){switch(t){case"null":return null===e;case"boolean":return"boolean"==typeof e;case"number":return"number"==typeof e;case"string":return"string"==typeof e;case"array":return e instanceof Array;case"object":return"[object Object]"==={}.toString.call(e)}throw new Error(t+" not supported as a type.Please use one of object, string, array, number, boolean or null.")}var matchers={$elemMatch:function(e,t,r,n){return!!Array.isArray(n)&&(0!==n.length&&("object"==typeof n[0]?n.some(function(e){return rowFilter(e,t,Object.keys(t))}):n.some(function(n){return matchSelector(t,e,r,n)})))},$allMatch:function(e,t,r,n){return!!Array.isArray(n)&&(0!==n.length&&("object"==typeof n[0]?n.every(function(e){return rowFilter(e,t,Object.keys(t))}):n.every(function(n){return matchSelector(t,e,r,n)})))},$eq:function(e,t,r,n){return fieldIsNotUndefined(n)&&0===collate(n,t)},$gte:function(e,t,r,n){return fieldIsNotUndefined(n)&&collate(n,t)>=0},$gt:function(e,t,r,n){return fieldIsNotUndefined(n)&&collate(n,t)>0},$lte:function(e,t,r,n){return fieldIsNotUndefined(n)&&collate(n,t)<=0},$lt:function(e,t,r,n){return fieldIsNotUndefined(n)&&collate(n,t)<0},$exists:function(e,t,r,n){return t?fieldIsNotUndefined(n):!fieldIsNotUndefined(n)},$mod:function(e,t,r,n){return fieldExists(n)&&modField(n,t)},$ne:function(e,t,r,n){return t.every(function(e){return 0!==collate(n,e)})},$in:function(e,t,r,n){return fieldExists(n)&&arrayContainsValue(n,t)},$nin:function(e,t,r,n){return fieldExists(n)&&!arrayContainsValue(n,t)},$size:function(e,t,r,n){return fieldExists(n)&&arraySize(n,t)},$all:function(e,t,r,n){return Array.isArray(n)&&arrayContainsAllValues(n,t)},$regex:function(e,t,r,n){return fieldExists(n)&&regexMatch(n,t)},$type:function(e,t,r,n){return typeMatch(n,t)}};function matchesSelector(e,t){if("object"!=typeof t)throw new Error("Selector error: expected a JSON object");var r=filterInMemoryFields([{doc:e}],{selector:t=massageSelector(t)},Object.keys(t));return r&&1===r.length}function evalFilter(e){var t='(function() {\n"use strict";\nreturn '+e+"\n})()";return vm.runInNewContext(t)}function evalView(e){var t=['"use strict";',"var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+e+";","view(doc);","if (emitted) {","  return true;","}"].join("\n");return vm.runInNewContext("(function(doc) {\n"+t+"\n})")}function validate(e,t){if(e.selector&&e.filter&&"_selector"!==e.filter){var r="string"==typeof e.filter?e.filter:"function";return t(new Error('selector invalid for filter "'+r+'"'))}t()}function normalize(e){e.view&&!e.filter&&(e.filter="_view"),e.selector&&!e.filter&&(e.filter="_selector"),e.filter&&"string"==typeof e.filter&&("_view"===e.filter?e.view=normalizeDesignDocFunctionName(e.view):e.filter=normalizeDesignDocFunctionName(e.filter))}function shouldFilter(e,t){return t.filter&&"string"==typeof t.filter&&!t.doc_ids&&!isRemote(e.db)}function filter(e,t){var r=t.complete;if("_view"===t.filter){if(!t.view||"string"!=typeof t.view){var n=createError(BAD_REQUEST,"`view` filter parameter not found or invalid.");return r(n)}var i=parseDesignDocFunctionName(t.view);e.db.get("_design/"+i[0],function(n,o){if(e.isCancelled)return r(null,{status:"cancelled"});if(n)return r(generateErrorFromResponse(n));var a=o&&o.views&&o.views[i[1]]&&o.views[i[1]].map;if(!a)return r(createError(MISSING_DOC,o.views?"missing json key: "+i[1]:"missing json key: views"));t.filter=evalView(a),e.doChanges(t)})}else if(t.selector)t.filter=function(e){return matchesSelector(e,t.selector)},e.doChanges(t);else{var o=parseDesignDocFunctionName(t.filter);e.db.get("_design/"+o[0],function(n,i){if(e.isCancelled)return r(null,{status:"cancelled"});if(n)return r(generateErrorFromResponse(n));var a=i&&i.filters&&i.filters[o[1]];if(!a)return r(createError(MISSING_DOC,i&&i.filters?"missing json key: "+o[1]:"missing json key: filters"));t.filter=evalFilter(a),e.doChanges(t)})}}function applyChangesFilterPlugin(e){e._changesFilterPlugin={validate:validate,normalize:normalize,shouldFilter:shouldFilter,filter:filter}}function isFunction(e){return"function"==typeof e}function getPrefix(e){return isFunction(e.prefix)?e.prefix():e}function clone$2(e){var t={};for(var r in e)t[r]=e[r];return t}function nut(e,t,r){function n(e,n,i,o){return t.encode([e,r.encodeKey(n,i,o)])}return e.open(function(){}),{apply:function(t,i,o){i=i||{};for(var a,s,u=[],c=-1,l=t.length;++c<l;){var f=t[c];a=f,(s=f.prefix)&&s.options&&(a.keyEncoding=a.keyEncoding||s.options.keyEncoding,a.valueEncoding=a.valueEncoding||s.options.valueEncoding),f.prefix=getPrefix(f.prefix),u.push({key:n(f.prefix,f.key,i,f),value:"del"!==f.type&&r.encodeValue(f.value,i,f),type:f.type})}e.db.batch(u,i,o)},get:function(t,i,o,a){return o.asBuffer=r.valueAsBuffer(o),e.db.get(n(i,t,o),o,function(e,t){e?a(e):a(null,r.decodeValue(t,o))})},createDecoder:function(e){return function(n,i){return{key:r.decodeKey(t.decode(n)[1],e),value:r.decodeValue(i,e)}}},isClosed:function(){return e.isClosed()},close:function(t){return e.close(t)},iterator:function(i){var o,a=clone$2(i||{}),s=i.prefix||[];return ltgt.toLtgt(i,a,function(e){return n(s,e,a,{})},t.lowerBound,t.upperBound),a.prefix=null,a.keyAsBuffer=a.valueAsBuffer=!1,"number"!=typeof a.limit&&(a.limit=-1),a.keyAsBuffer=t.buffer,a.valueAsBuffer=r.valueAsBuffer(a),o=e.db.iterator(a),{next:function(e){return o.next(e)},end:function(e){o.end(e)}}}}}function NotFoundError(){Error.call(this)}PouchDB$5.plugin(debugPouch),PouchDB$5.plugin(applyChangesFilterPlugin),PouchDB$5.version=version$1,inherits(NotFoundError,Error),NotFoundError.prototype.name="NotFoundError";var EventEmitter$1=EventEmitter.EventEmitter,version$1$1="6.5.4",NOT_FOUND_ERROR=new NotFoundError,sublevel$1=function(e,t,r,n){var i=new EventEmitter$1;function o(e){var t,r={};if(n)for(t in n)void 0!==n[t]&&(r[t]=n[t]);if(e)for(t in e)void 0!==e[t]&&(r[t]=e[t]);return r}return i.sublevels={},i.options=n,i.version=version$1$1,i.methods={},t=t||[],i.put=function(r,n,a,s){"function"==typeof a&&(s=a,a={}),e.apply([{key:r,value:n,prefix:t.slice(),type:"put"}],o(a),function(e){if(e)return s(e);i.emit("put",r,n),s(null)})},i.prefix=function(){return t.slice()},i.batch=function(r,n,a){"function"==typeof n&&(a=n,n={}),r=r.map(function(e){return{key:e.key,value:e.value,prefix:e.prefix||t,keyEncoding:e.keyEncoding,valueEncoding:e.valueEncoding,type:e.type}}),e.apply(r,o(n),function(e){if(e)return a(e);i.emit("batch",r),a(null)})},i.get=function(r,n,i){"function"==typeof n&&(i=n,n={}),e.get(r,t,o(n),function(e,t){e?i(NOT_FOUND_ERROR):i(null,t)})},i.sublevel=function(n,a){return i.sublevels[n]=i.sublevels[n]||sublevel$1(e,t.concat(n),r,o(a))},i.readStream=i.createReadStream=function(n){var i;(n=o(n)).prefix=t;var a=e.iterator(n);return(i=r(n,e.createDecoder(n))).setIterator(a),i},i.close=function(t){e.close(t)},i.isOpen=e.isOpen,i.isClosed=e.isClosed,i},Readable=readable$2.Readable;function ReadStream(e,t){if(!(this instanceof ReadStream))return new ReadStream(e,t);Readable.call(this,{objectMode:!0,highWaterMark:e.highWaterMark}),this._waiting=!1,this._options=e,this._makeData=t}inherits(ReadStream,Readable),ReadStream.prototype.setIterator=function(e){return this._iterator=e,this._destroyed?e.end(function(){}):this._waiting?(this._waiting=!1,this._read()):this},ReadStream.prototype._read=function(){var e=this;if(!e._destroyed)return e._iterator?void e._iterator.next(function(t,r,n){if(t||void 0===r&&void 0===n)return t||e._destroyed||e.push(null),e._cleanup(t);n=e._makeData(r,n),e._destroyed||e.push(n)}):this._waiting=!0},ReadStream.prototype._cleanup=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;e&&"iterator has ended"!==e.message&&t.emit("error",e),t._iterator?t._iterator.end(function(){t._iterator=null,t.emit("close")}):t.emit("close")}},ReadStream.prototype.destroy=function(){this._cleanup()};var precodec={encode:function(e){return""+e[0]+""+e[1]},decode:function(e){var t=e.toString(),r=t.indexOf("",1);return[t.substring(1,r),t.substring(r+1)]},lowerBound:"\0",upperBound:""},codec=new levelCodec;function sublevelPouch(e){return sublevel$1(nut(e,precodec,codec),[],ReadStream,e.options)}function allDocsKeysQuery(e,t){var r=t.keys,n={offset:t.skip};return PouchPromise.all(r.map(function(r){var i=$inject_Object_assign({key:r,deleted:"ok"},t);return["limit","skip","keys"].forEach(function(e){delete i[e]}),new PouchPromise(function(o,a){e._allDocs(i,function(e,i){if(e)return a(e);t.update_seq&&void 0!==i.update_seq&&(n.update_seq=i.update_seq),n.total_rows=i.total_rows,o(i.rows[0]||{key:r,error:"not_found"})})})})).then(function(e){return n.rows=e,n})}function toObject(e){return e.reduce(function(e,t){return e[t]=!0,e},{})}var reservedWords=toObject(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),dataWords=toObject(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);function parseRevisionInfo(e){if(!/^\d+-./.test(e))return createError(INVALID_REV);var t=e.indexOf("-"),r=e.substring(0,t),n=e.substring(t+1);return{prefix:parseInt(r,10),id:n}}function makeRevTreeFromRevisions(e,t){for(var r=e.start-e.ids.length+1,n=e.ids,i=[n[0],t,[]],o=1,a=n.length;o<a;o++)i=[n[o],{status:"missing"},[i]];return[{pos:r,ids:i}]}function parseDoc(e,t){var r,n,i,o={status:"available"};if(e._deleted&&(o.deleted=!0),t)if(e._id||(e._id=uuid()),n=rev(),e._rev){if((i=parseRevisionInfo(e._rev)).error)return i;e._rev_tree=[{pos:i.prefix,ids:[i.id,{status:"missing"},[[n,o,[]]]]}],r=i.prefix+1}else e._rev_tree=[{pos:1,ids:[n,o,[]]}],r=1;else if(e._revisions&&(e._rev_tree=makeRevTreeFromRevisions(e._revisions,o),r=e._revisions.start,n=e._revisions.ids[0]),!e._rev_tree){if((i=parseRevisionInfo(e._rev)).error)return i;r=i.prefix,n=i.id,e._rev_tree=[{pos:r,ids:[n,o,[]]}]}invalidIdError(e._id),e._rev=r+"-"+n;var a={metadata:{},data:{}};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var u="_"===s[0];if(u&&!reservedWords[s]){var c=createError(DOC_VALIDATION,s);throw c.message=DOC_VALIDATION.message+": "+s,c}u&&!dataWords[s]?a.metadata[s.slice(1)]=e[s]:a.data[s]=e[s]}return a}function thisAtob(e){var t=new Buffer(e,"base64");if(t.toString("base64")!==e)throw new Error("attachment is not a valid base64 string");return t.toString("binary")}function thisBtoa(e){return bufferFrom_1(e,"binary").toString("base64")}function typedBuffer(e,t,r){var n=bufferFrom_1(e,t);return n.type=r,n}function b64ToBluffer(e,t){return typedBuffer(e,"base64",t)}function binStringToBluffer(e,t){return typedBuffer(e,"binary",t)}function blobToBase64(e,t){t(e.toString("base64"))}function binaryMd5(e,t){t(fs.createHash("md5").update(e,"binary").digest("base64"))}function stringMd5(e){return fs.createHash("md5").update(e,"binary").digest("hex")}function updateDoc(e,t,r,n,i,o,a,s){if(revExists(t.rev_tree,r.metadata.rev))return n[i]=r,o();var u=t.winningRev||winningRev(t),c="deleted"in t?t.deleted:isDeleted(t,u),l="deleted"in r.metadata?r.metadata.deleted:isDeleted(r.metadata),f=/^1-/.test(r.metadata.rev);if(c&&!l&&s&&f){var d=r.data;d._rev=u,d._id=r.metadata.id,r=parseDoc(d,s)}var h=merge$1(t.rev_tree,r.metadata.rev_tree[0],e);if(s&&(c&&l&&"new_leaf"!==h.conflicts||!c&&"new_leaf"!==h.conflicts||c&&!l&&"new_branch"===h.conflicts)){var p=createError(REV_CONFLICT);return n[i]=p,o()}var m=r.metadata.rev;r.metadata.rev_tree=h.tree,r.stemmedRevs=h.stemmedRevs||[],t.rev_map&&(r.metadata.rev_map=t.rev_map);var g=winningRev(r.metadata),y=isDeleted(r.metadata,g),b=c===y?0:c<y?-1:1;a(r,g,y,m===g?y:isDeleted(r.metadata,m),!0,b,i,o)}function rootIsMissing(e){return"missing"===e.metadata.rev_tree[0].ids[1].status}function processDocs(e,t,r,n,i,o,a,s,u){e=e||1e3;var c=s.new_edits,l=new ExportedMap,f=0,d=t.length;function h(){++f===d&&u&&u()}t.forEach(function(e,t){if(e._id&&isLocalId(e._id)){var n=e._deleted?"_removeLocal":"_putLocal";r[n](e,{ctx:i},function(e,r){o[t]=e||r,h()})}else{var a=e.metadata.id;l.has(a)?(d--,l.get(a).push([e,t])):l.set(a,[[e,t]])}}),l.forEach(function(t,r){var i=0;function u(){++i<t.length?l():h()}function l(){var l=t[i],f=l[0],d=l[1];if(n.has(r))updateDoc(e,n.get(r),f,o,d,u,a,c);else{var h=merge$1([],f.metadata.rev_tree[0],e);f.metadata.rev_tree=h.tree,f.stemmedRevs=h.stemmedRevs||[],function(e,t,r){var n=winningRev(e.metadata),i=isDeleted(e.metadata,n);if("was_delete"in s&&i)return o[t]=createError(MISSING_DOC,"deleted"),r();if(c&&rootIsMissing(e)){var u=createError(REV_CONFLICT);return o[t]=u,r()}a(e,n,i,i,!1,i?0:1,t,r)}(f,d,u)}}l()})}function safeJsonParse(e){try{return JSON.parse(e)}catch(t){return vuvuzela.parse(e)}}function safeJsonStringify(e){try{return JSON.stringify(e)}catch(t){return vuvuzela.stringify(e)}}function readAsBlobOrBuffer(e,t){return e.type=t,e}function prepareAttachmentForStorage(e,t){t(e)}function createEmptyBlobOrBuffer(e){return typedBuffer("","binary",e)}function getCacheFor(e,t){var r=t.prefix()[0],n=e._cache,i=n.get(r);return i||(i=new ExportedMap,n.set(r,i)),i}function LevelTransaction(){this._batch=[],this._cache=new ExportedMap}LevelTransaction.prototype.get=function(e,t,r){var n=getCacheFor(this,e),i=n.get(t);return i?nextTick(function(){r(null,i)}):null===i?nextTick(function(){r({name:"NotFoundError"})}):void e.get(t,function(e,i){if(e)return"NotFoundError"===e.name&&n.set(t,null),r(e);n.set(t,i),r(null,i)})},LevelTransaction.prototype.batch=function(e){for(var t=0,r=e.length;t<r;t++){var n=e[t],i=getCacheFor(this,n.prefix);"put"===n.type?i.set(n.key,n.value):i.set(n.key,null)}this._batch=this._batch.concat(e)},LevelTransaction.prototype.execute=function(e,t){for(var r=new ExportedSet,n=[],i=this._batch.length-1;i>=0;i--){var o=this._batch[i],a=o.prefix.prefix()[0]+""+o.key;r.has(a)||(r.add(a),n.push(o))}e.batch(n,t)};var DOC_STORE="document-store",BY_SEQ_STORE="by-sequence",ATTACHMENT_STORE="attach-store",BINARY_STORE="attach-binary-store",LOCAL_STORE="local-store",META_STORE="meta-store",dbStores=new ExportedMap,UPDATE_SEQ_KEY="_local_last_update_seq",DOC_COUNT_KEY="_local_doc_count",UUID_KEY="_local_uuid",MD5_PREFIX="md5-",safeJsonEncoding={encode:safeJsonStringify,decode:safeJsonParse,buffer:!1,type:"cheap-json"},levelChanges=new Changes;function getWinningRev(e){return"winningRev"in e?e.winningRev:winningRev(e)}function getIsDeleted(e,t){return"deleted"in e?e.deleted:isDeleted(e,t)}function fetchAttachment(e,t,r){var n=e.content_type;return new PouchPromise(function(i,o){t.binaryStore.get(e.digest,function(t,a){var s;if(t){if("NotFoundError"!==t.name)return o(t);s=r.binary?binStringToBluffer("",n):""}else s=r.binary?readAsBlobOrBuffer(a,n):a.toString("base64");delete e.stub,delete e.length,e.data=s,i()})})}function fetchAttachments(e,t,r){var n=[];return e.forEach(function(e){e.doc&&e.doc._attachments&&Object.keys(e.doc._attachments).forEach(function(t){var r=e.doc._attachments[t];"data"in r||n.push(r)})}),PouchPromise.all(n.map(function(e){return fetchAttachment(e,t,r)}))}function LevelPouch$1(e,t){var r,n,i=this,o={},a=(e=clone(e)).revs_limit,s=e.name;void 0===e.createIfMissing&&(e.createIfMissing=!0);var u,c=e.db,l=functionName(c);function f(){o.docStore=n.sublevel(DOC_STORE,{valueEncoding:safeJsonEncoding}),o.bySeqStore=n.sublevel(BY_SEQ_STORE,{valueEncoding:"json"}),o.attachmentStore=n.sublevel(ATTACHMENT_STORE,{valueEncoding:"json"}),o.binaryStore=n.sublevel(BINARY_STORE,{valueEncoding:"binary"}),o.localStore=n.sublevel(LOCAL_STORE,{valueEncoding:"json"}),o.metaStore=n.sublevel(META_STORE,{valueEncoding:"json"}),"object"==typeof e.migrate?e.migrate.doMigrationTwo(n,o,d):d()}function d(){o.metaStore.get(UPDATE_SEQ_KEY,function(e,a){void 0===n._updateSeq&&(n._updateSeq=a||0),o.metaStore.get(DOC_COUNT_KEY,function(e,a){n._docCount=e?0:a,o.metaStore.get(UUID_KEY,function(e,n){r=e?uuid():n,o.metaStore.put(UUID_KEY,r,function(){nextTick(function(){t(null,i)})})})})})}function h(e,t){try{e.apply(null,t)}catch(e){t[t.length-1](e)}}function p(){var e,t,r,i=n._queue.peekFront();"read"===i.type?function(e){var t=[e],r=1,i=n._queue.get(r);for(;void 0!==i&&"read"===i.type;)t.push(i),r++,i=n._queue.get(r);var o=0;t.forEach(function(e){var r=e.args,i=r[r.length-1];r[r.length-1]=argsarray(function(e){i.apply(null,e),++o===t.length&&nextTick(function(){t.forEach(function(){n._queue.shift()}),n._queue.length&&p()})}),h(e.fun,r)})}(i):(t=(e=i).args,r=t[t.length-1],t[t.length-1]=argsarray(function(e){r.apply(null,e),nextTick(function(){n._queue.shift(),n._queue.length&&p()})}),h(e.fun,t))}function m(e){return argsarray(function(t){n._queue.push({fun:e,args:t,type:"write"}),1===n._queue.length&&nextTick(p)})}function g(e){return argsarray(function(t){n._queue.push({fun:e,args:t,type:"read"}),1===n._queue.length&&nextTick(p)})}function y(e){return("0000000000000000"+e).slice(-16)}function b(e,t){c.destroy(e,t)}dbStores.has(l)?u=dbStores.get(l):(u=new ExportedMap,dbStores.set(l,u)),u.has(s)?(n=u.get(s),f()):u.set(s,sublevelPouch(levelup(c(s),e,function(r){if(r)return u.delete(s),t(r);(n=u.get(s))._docCount=-1,n._queue=new deque,"object"==typeof e.migrate?e.migrate.doMigrationOne(s,n,f):f()}))),i._remote=!1,i.type=function(){return"leveldb"},i._id=function(e){e(null,r)},i._info=function(e){var t={doc_count:n._docCount,update_seq:n._updateSeq,backend_adapter:functionName(c)};return nextTick(function(){e(null,t)})},i._get=g(function(e,t,r){t=clone(t),o.docStore.get(e,function(e,n){if(e||!n)return r(createError(MISSING_DOC,"missing"));var i;if(t.rev)i=t.latest?latest(t.rev,n):t.rev;else if(i=getWinningRev(n),getIsDeleted(n,i))return r(createError(MISSING_DOC,"deleted"));var a=n.rev_map[i];o.bySeqStore.get(y(a),function(e,t){if(!t)return r(createError(MISSING_DOC));if("_id"in t&&t._id!==n.id)return r(new Error("wrong doc returned"));if(t._id=n.id,"_rev"in t){if(t._rev!==i)return r(new Error("wrong doc returned"))}else t._rev=i;return r(null,{doc:t,metadata:n})})})}),i._getAttachment=function(e,t,r,n,i){var a=r.digest,s=r.content_type;o.binaryStore.get(a,function(e,t){if(e)return"NotFoundError"!==e.name?i(e):i(null,n.binary?createEmptyBlobOrBuffer(s):"");n.binary?i(null,readAsBlobOrBuffer(t,s)):i(null,t.toString("base64"))})},i._bulkDocs=m(function(e,t,r){var u=t.new_edits,c=new Array(e.docs.length),l=new ExportedMap,f=new ExportedMap,d=new LevelTransaction,h=0,p=n._updateSeq,m=e.docs,g=m.map(function(e){if(e._id&&isLocalId(e._id))return e;var t=parseDoc(e,u);return t.metadata&&!t.metadata.rev_map&&(t.metadata.rev_map={}),t}),b=g.filter(function(e){return e.error});if(b.length)return r(b[0]);function v(e,t){var r=PouchPromise.resolve();e.forEach(function(e,t){r=r.then(function(){return new PouchPromise(function(r,n){i._doCompactionNoLock(t,e,{ctx:d},function(e){if(e)return n(e);r()})})})}),r.then(function(){t()},t)}function _(){v(f,function(e){if(e&&S(e),i.auto_compaction)return t=S,r=new ExportedMap,l.forEach(function(e,t){r.set(t,compactTree(e))}),void v(r,t);var t,r;S()})}function w(e,t,n,i,a,s,u,m){h+=s;var g=null,b=0;e.metadata.winningRev=t,e.metadata.deleted=n,e.data._id=e.metadata.id,e.data._rev=e.metadata.rev,i&&(e.data._deleted=!0),e.stemmedRevs.length&&f.set(e.metadata.id,e.stemmedRevs);var v=e.data._attachments?Object.keys(e.data._attachments):[];function _(e){b++,g||(e?m(g=e):b===v.length&&k())}function w(e,t,r,n){return function(i){!function(e,t,r,n,i){var a=e.data._attachments[r];delete a.data,a.digest=t,a.length=n.length;var s=e.metadata.id,u=e.metadata.rev;a.revpos=parseInt(u,10),$(s,u,t,function(e,r){return e?i(e):0===n.length?i(e):r?(d.batch([{type:"put",prefix:o.binaryStore,key:t,value:bufferFrom_1(n,"binary")}]),void i()):i(e)})}(e,MD5_PREFIX+i,t,r,n)}}function E(e,t,r){return function(n){binaryMd5(n,w(e,t,n,r))}}for(var S=0;S<v.length;S++){var T,x=v[S],C=e.data._attachments[x];if(C.stub)$(e.data._id,e.data._rev,C.digest,_);else if("string"==typeof C.data){try{T=thisAtob(C.data)}catch(e){return void r(createError(BAD_ARG,"Attachment is not a valid base64 string"))}E(e,x,_)(T)}else prepareAttachmentForStorage(C.data,E(e,x,_))}function k(){var t=e.metadata.rev_map[e.metadata.rev];if(t)return m();t=++p,e.metadata.rev_map[e.metadata.rev]=e.metadata.seq=t;var r=[{key:y(t),value:e.data,prefix:o.bySeqStore,type:"put"},{key:e.metadata.id,value:e.metadata,prefix:o.docStore,type:"put"}];d.batch(r),c[u]={ok:!0,id:e.metadata.id,rev:e.metadata.rev},l.set(e.metadata.id,e.metadata),m()}v.length||k()}var E={};function $(e,t,r,n){function i(n){var i=[e,t].join("@"),a={};return n?n.refs&&(a.refs=n.refs,a.refs[i]=!0):(a.refs={},a.refs[i]=!0),new PouchPromise(function(e){d.batch([{type:"put",prefix:o.attachmentStore,key:r,value:a}]),e(!n)})}var a=E[r]||PouchPromise.resolve();E[r]=a.then(function(){return new PouchPromise(function(e,t){d.get(o.attachmentStore,r,function(r,n){if(r&&"NotFoundError"!==r.name)return t(r);e(n)})}).then(i).then(function(e){n(null,e)},n)})}function S(e){if(e)return nextTick(function(){r(e)});d.batch([{prefix:o.metaStore,type:"put",key:UPDATE_SEQ_KEY,value:p},{prefix:o.metaStore,type:"put",key:DOC_COUNT_KEY,value:n._docCount+h}]),d.execute(n,function(e){if(e)return r(e);n._docCount+=h,n._updateSeq=p,levelChanges.notify(s),nextTick(function(){r(null,c)})})}if(!g.length)return r(null,[]);!function(e){var t=[];if(m.forEach(function(e){e&&e._attachments&&Object.keys(e._attachments).forEach(function(r){var n=e._attachments[r];n.stub&&t.push(n.digest)})}),!t.length)return e();var r,n=0;t.forEach(function(i){var a,s;a=i,s=function(i){i&&!r&&(r=i),++n===t.length&&e(r)},d.get(o.attachmentStore,a,function(e){if(e){var t=createError(MISSING_STUB,"unknown stub attachment with digest "+a);s(t)}else s()})})}(function(e){if(e)return r(e);!function(e){var t,r=0;function n(){if(++r===m.length)return e(t)}m.forEach(function(e){if(e._id&&isLocalId(e._id))return n();d.get(o.docStore,e._id,function(r,i){r?"NotFoundError"!==r.name&&(t=r):l.set(e._id,i),n()})})}(function(e){if(e)return r(e);processDocs(a,g,i,l,d,c,w,t,_)})})}),i._allDocs=function(e,t){return"keys"in e?allDocsKeysQuery(this,e):g(function(e,t){var r;e=clone(e),r=function(r,i){if(r)return t(r);var a,s={},u=e.skip||0;if(e.startkey&&(s.gte=e.startkey),e.endkey&&(s.lte=e.endkey),e.key&&(s.gte=s.lte=e.key),e.descending){s.reverse=!0;var c=s.lte;s.lte=s.gte,s.gte=c}if("number"==typeof e.limit&&(a=e.limit),0===a||"gte"in s&&"lte"in s&&s.gte>s.lte){var l={total_rows:i,offset:e.skip,rows:[]};return e.update_seq&&(l.update_seq=n._updateSeq),t(null,l)}var f=[],d=o.docStore.readStream(s),h=obj(function(t,r,n){var i=t.value,s=getWinningRev(i),c=getIsDeleted(i,s);if(c){if("ok"!==e.deleted)return void n()}else{if(u-- >0)return void n();if("number"==typeof a&&a--<=0)return d.unpipe(),d.destroy(),void n()}function l(t){var r={id:i.id,key:i.id,value:{rev:s}};if(e.include_docs){if(r.doc=t,r.doc._rev=r.value.rev,e.conflicts){var o=collectConflicts(i);o.length&&(r.doc._conflicts=o)}for(var a in r.doc._attachments)r.doc._attachments.hasOwnProperty(a)&&(r.doc._attachments[a].stub=!0)}if(!1===e.inclusive_end&&i.id===e.endkey)return n();if(c){if("ok"!==e.deleted)return n();r.value.deleted=!0,r.doc=null}f.push(r),n()}if(e.include_docs){var h=i.rev_map[s];o.bySeqStore.get(y(h),function(e,t){l(t)})}else l()},function(r){PouchPromise.resolve().then(function(){if(e.include_docs&&e.attachments)return fetchAttachments(f,o,e)}).then(function(){var r={total_rows:i,offset:e.skip,rows:f};e.update_seq&&(r.update_seq=n._updateSeq),t(null,r)},t),r()}).on("unpipe",function(){h.end()});d.on("error",t),d.pipe(h)},n.isClosed()?r(new Error("database is closed")):r(null,n._docCount)})(e,t)},i._changes=function(e){if((e=clone(e)).continuous){var t=s+":"+uuid();return levelChanges.addListener(s,t,i,e),levelChanges.notify(s),{cancel:function(){levelChanges.removeListener(s,t)}}}var r,a=e.descending,u=[],c=e.since||0,l=0,f={reverse:a};"limit"in e&&e.limit>0&&(r=e.limit),f.reverse||(f.start=y(e.since||0));var d,h=e.doc_ids&&new ExportedSet(e.doc_ids),p=filterChange(e),m=new ExportedMap;function g(){e.done=!0,d&&e.limit&&e.limit<u.length&&(u.length=e.limit),b.unpipe(v),b.destroy(),e.continuous||e.cancelled||(e.include_docs&&e.attachments?fetchAttachments(u,o,e).then(function(){e.complete(null,{results:u,last_seq:c})}):e.complete(null,{results:u,last_seq:c}))}d="return_docs"in e?e.return_docs:!("returnDocs"in e)||e.returnDocs;var b=o.bySeqStore.readStream(f),v=obj(function(t,i,s){if(r&&l>=r)return g(),s();if(e.cancelled||e.done)return s();var f,b,v=(f=t.key,parseInt(f,10)),_=t.value;if(v===e.since&&!a)return s();if(h&&!h.has(_._id))return s();function w(t){var r=getWinningRev(t);function n(r){var n=e.processChange(r,t,e);n.seq=t.seq;var i=p(n);if("object"==typeof i)return e.complete(i);i&&(l++,e.attachments&&e.include_docs?fetchAttachments([n],o,e).then(function(){e.onChange(n)}):e.onChange(n),d&&u.push(n)),s()}if(t.seq!==v)return s();if(c=v,r===_._rev)return n(_);var i=t.rev_map[r];o.bySeqStore.get(y(i),function(e,t){n(t)})}if(b=m.get(_._id))return w(b);o.docStore.get(_._id,function(t,r){if(e.cancelled||e.done||n.isClosed()||isLocalId(r.id))return s();m.set(_._id,r),w(r)})},function(t){if(e.cancelled)return t();d&&e.limit&&e.limit<u.length&&(u.length=e.limit),t()}).on("unpipe",function(){v.end(),g()});return b.pipe(v),{cancel:function(){e.cancelled=!0,g()}}},i._close=function(e){if(n.isClosed())return e(createError(NOT_OPEN));n.close(function(t){t?e(t):(u.delete(s),e())})},i._getRevisionTree=function(e,t){o.docStore.get(e,function(e,r){e?t(createError(MISSING_DOC)):t(null,r.rev_tree)})},i._doCompaction=m(function(e,t,r,n){i._doCompactionNoLock(e,t,r,n)}),i._doCompactionNoLock=function(e,t,r,i){if("function"==typeof r&&(i=r,r={}),!t.length)return i();var a=r.ctx||new LevelTransaction;a.get(o.docStore,e,function(s,u){if(s)return i(s);var c=t.map(function(e){var t=u.rev_map[e];return delete u.rev_map[e],t});traverseRevTree(u.rev_tree,function(e,r,n,i,o){var a=r+"-"+n;-1!==t.indexOf(a)&&(o.status="missing")});var l=[];l.push({key:u.id,value:u,type:"put",prefix:o.docStore});var f,d={},h=0;function p(r){if(r&&(f=r),++h===t.length){if(f)return i(f);!function(){var r=Object.keys(d);if(!r.length)return m();var n,i=0;function s(e){e&&(n=e),++i===r.length&&m(n)}var u=new ExportedMap;t.forEach(function(t){u.set(e+"@"+t,!0)}),r.forEach(function(e){a.get(o.attachmentStore,e,function(t,r){if(t)return"NotFoundError"===t.name?s():s(t);var n=Object.keys(r.refs||{}).filter(function(e){return!u.has(e)}),i={};n.forEach(function(e){i[e]=!0}),n.length?l.push({key:e,type:"put",value:{refs:i},prefix:o.attachmentStore}):l=l.concat([{key:e,type:"del",prefix:o.attachmentStore},{key:e,type:"del",prefix:o.binaryStore}]),s()})})}()}}function m(e){return e?i(e):(a.batch(l),r.ctx?i():void a.execute(n,i))}c.forEach(function(e){l.push({key:y(e),type:"del",prefix:o.bySeqStore}),a.get(o.bySeqStore,y(e),function(e,t){if(e)return"NotFoundError"===e.name?p():p(e);Object.keys(t._attachments||{}).forEach(function(e){var r=t._attachments[e].digest;d[r]=!0}),p()})})})},i._getLocal=function(e,t){o.localStore.get(e,function(e,r){e?t(createError(MISSING_DOC)):t(null,r)})},i._putLocal=function(e,t,r){"function"==typeof t&&(r=t,t={}),t.ctx?i._putLocalNoLock(e,t,r):i._putLocalWithLock(e,t,r)},i._putLocalWithLock=m(function(e,t,r){i._putLocalNoLock(e,t,r)}),i._putLocalNoLock=function(e,t,r){delete e._revisions;var i=e._rev,a=e._id,s=t.ctx||new LevelTransaction;s.get(o.localStore,a,function(u,c){if(u&&i)return r(createError(REV_CONFLICT));if(c&&c._rev!==i)return r(createError(REV_CONFLICT));e._rev=i?"0-"+(parseInt(i.split("-")[1],10)+1):"0-1";var l=[{type:"put",prefix:o.localStore,key:a,value:e}];s.batch(l);var f={ok:!0,id:e._id,rev:e._rev};if(t.ctx)return r(null,f);s.execute(n,function(e){if(e)return r(e);r(null,f)})})},i._removeLocal=function(e,t,r){"function"==typeof t&&(r=t,t={}),t.ctx?i._removeLocalNoLock(e,t,r):i._removeLocalWithLock(e,t,r)},i._removeLocalWithLock=m(function(e,t,r){i._removeLocalNoLock(e,t,r)}),i._removeLocalNoLock=function(e,t,r){var i=t.ctx||new LevelTransaction;i.get(o.localStore,e._id,function(a,s){if(a)return"NotFoundError"!==a.name?r(a):r(createError(MISSING_DOC));if(s._rev!==e._rev)return r(createError(REV_CONFLICT));i.batch([{prefix:o.localStore,type:"del",key:e._id}]);var u={ok:!0,id:e._id,rev:"0-0"};if(t.ctx)return r(null,u);i.execute(n,function(e){if(e)return r(e);r(null,u)})})},i._destroy=function(e,t){var r,n=functionName(c);if(!dbStores.has(n))return b(s,t);(r=dbStores.get(n)).has(s)?(levelChanges.removeAllListeners(s),r.get(s).close(function(){r.delete(s),b(s,t)})):b(s,t)}}var requireLeveldown=function(){try{return require("leveldown")}catch(e){return"MODULE_NOT_FOUND"===(e=e||"leveldown import error").code?new Error(["the 'leveldown' package is not available. install it, or,","specify another storage backend using the 'db' option"].join(" ")):e.message&&e.message.match("Module version mismatch")?new Error([e.message,"This generally implies that leveldown was built with a different","version of node than that which is running now.  You may try","fully removing and reinstalling PouchDB or leveldown to resolve."].join(" ")):new Error(e.toString()+": unable to import leveldown")}},stores=["document-store","by-sequence","attach-store","attach-binary-store"];function formatSeq(e){return("0000000000000000"+e).slice(-16)}var UPDATE_SEQ_KEY$1="_local_last_update_seq",DOC_COUNT_KEY$1="_local_doc_count",UUID_KEY$1="_local_uuid",doMigrationOne=function(e,t,r){var n=require("leveldown"),i=path$2.resolve(e);fs.unlink(i+".uuid",function(e){if(e)return r();var o=4,a=[];stores.forEach(function(e,s){!function(e,r,n){var o,a=path$2.join(i,e);o=3===r?{valueEncoding:"binary"}:{valueEncoding:"json"};var s=t.sublevel(e,o),u=level(a,o),c=u.createReadStream(),l=new levelWriteStream(s)();c.on("end",function(){u.close(function(e){n(e,a)})}),c.pipe(l)}(e,s,function(e,t){if(e)return r(e);a.push(t),--o||a.forEach(function(e){n.destroy(e,function(){++o===a.length&&fs.rmdir(i,r)})})})})})},doMigrationTwo=function(e,t,r){var n=[];t.bySeqStore.get(UUID_KEY$1,function(i,o){if(i)return r();n.push({key:UUID_KEY$1,value:o,prefix:t.metaStore,type:"put",valueEncoding:"json"}),n.push({key:UUID_KEY$1,prefix:t.bySeqStore,type:"del"}),t.bySeqStore.get(DOC_COUNT_KEY$1,function(i,o){o&&(n.push({key:DOC_COUNT_KEY$1,value:o,prefix:t.metaStore,type:"put",valueEncoding:"json"}),n.push({key:DOC_COUNT_KEY$1,prefix:t.bySeqStore,type:"del"})),t.bySeqStore.get(UPDATE_SEQ_KEY$1,function(i,o){o&&(n.push({key:UPDATE_SEQ_KEY$1,value:o,prefix:t.metaStore,type:"put",valueEncoding:"json"}),n.push({key:UPDATE_SEQ_KEY$1,prefix:t.bySeqStore,type:"del"}));var a={};t.docStore.createReadStream({startKey:"_",endKey:"_"}).pipe(obj(function(e,r,i){if(!isLocalId(e.key))return i();n.push({key:e.key,prefix:t.docStore,type:"del"});var o=winningRev(e.value);Object.keys(e.value.rev_map).forEach(function(t){"winner"!==t&&this.push(formatSeq(e.value.rev_map[t]))},this);var a=e.value.rev_map[o];t.bySeqStore.get(formatSeq(a),function(r,o){r||n.push({key:e.key,value:o,prefix:t.localStore,type:"put",valueEncoding:"json"}),i()})})).pipe(obj(function(e,r,i){if(a[e])return i();a[e]=!0,t.bySeqStore.get(e,function(r,o){if(r||!isLocalId(o._id))return i();n.push({key:e,prefix:t.bySeqStore,type:"del"}),i()})},function(){e.batch(n,r)}))})})})},migrate={doMigrationOne:doMigrationOne,doMigrationTwo:doMigrationTwo};function LevelDownPouch(e,t){var r=e.db;if(!r&&(r=requireLeveldown())instanceof Error)return t(r);var n=$inject_Object_assign({db:r,migrate:migrate},e);LevelPouch$1.call(this,n,t)}function LevelPouch(e){e.adapter("leveldb",LevelDownPouch,!0)}LevelDownPouch.valid=function(){return!0},LevelDownPouch.use_prefix=!1;var request$1=require("request").defaults({jar:!0});function applyTypeToBuffer(e,t){e.type=t.headers["content-type"]}function defaultBody(){return bufferFrom_1("","binary")}function ajaxCore$1(e,t){e=clone(e);return(e=$inject_Object_assign({method:"GET",headers:{},json:!0,processData:!0,timeout:1e4,cache:!1},e)).json&&(e.binary||(e.headers.Accept="application/json"),e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json"),e.binary&&(e.encoding=null,e.json=!1),e.processData||(e.json=!1),request$1(e,function(r,n,i){if(r)return t(generateErrorFromResponse(r));var o,a=n.headers&&n.headers["content-type"],s=i||defaultBody();if(!e.binary&&(e.json||!e.processData)&&"object"!=typeof s&&(/json/.test(a)||/^[\s]*\{/.test(s)&&/\}[\s]*$/.test(s)))try{s=JSON.parse(s.toString())}catch(e){}n.statusCode>=200&&n.statusCode<300?function(t,r,n){if(!e.binary&&e.json&&"string"==typeof t)try{t=JSON.parse(t)}catch(e){return n(e)}Array.isArray(t)&&(t=t.map(function(e){return e.error||e.missing?generateErrorFromResponse(e):e})),e.binary&&applyTypeToBuffer(t,r),n(null,t,r)}(s,n,t):((o=generateErrorFromResponse(s)).status=n.statusCode,t(o))})}function ajax(e,t){return ajaxCore$1(e,t)}function pool(e,t){return new PouchPromise(function(r,n){var i,o=0,a=0,s=0,u=e.length;function c(){++s===u?i?n(i):r():d()}function l(){o--,c()}function f(e){o--,i=i||e,c()}function d(){for(;o<t&&a<u;)o++,e[a++]().then(l,f)}d()})}var CHANGES_BATCH_SIZE=25,MAX_SIMULTANEOUS_REVS=50,CHANGES_TIMEOUT_BUFFER=5e3,DEFAULT_HEARTBEAT=1e4,supportsBulkGetMap={};function readAttachmentsAsBlobOrBuffer(e){var t=(e.doc||e.ok)._attachments;t&&Object.keys(t).forEach(function(e){var r=t[e];r.data=b64ToBluffer(r.data,r.content_type)})}function encodeDocId(e){return/^_design/.test(e)?"_design/"+encodeURIComponent(e.slice(8)):/^_local/.test(e)?"_local/"+encodeURIComponent(e.slice(7)):encodeURIComponent(e)}function preprocessAttachments$2(e){return e._attachments&&Object.keys(e._attachments)?PouchPromise.all(Object.keys(e._attachments).map(function(t){var r=e._attachments[t];if(r.data&&"string"!=typeof r.data)return new PouchPromise(function(e){blobToBase64(r.data,e)}).then(function(e){r.data=e})})):PouchPromise.resolve()}function hasUrlPrefix(e){if(!e.prefix)return!1;var t=parseUri(e.prefix).protocol;return"http"===t||"https"===t}function getHost(e,t){if(hasUrlPrefix(t)){var r=t.name.substr(t.prefix.length);e=t.prefix+encodeURIComponent(r)}var n=parseUri(e);(n.user||n.password)&&(n.auth={username:n.user,password:n.password});var i=n.path.replace(/(^\/|\/$)/g,"").split("/");return n.db=i.pop(),-1===n.db.indexOf("%")&&(n.db=encodeURIComponent(n.db)),n.path=i.join("/"),n}function genDBUrl(e,t){return genUrl(e,e.db+"/"+t)}function genUrl(e,t){var r=e.path?"/":"";return e.protocol+"://"+e.host+(e.port?":"+e.port:"")+"/"+e.path+r+t}function paramsToStr(e){return"?"+Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&")}function HttpPouch(e,t){var r,n=this,i=getHost(e.name,e),o=genDBUrl(i,""),a=(e=clone(e)).ajax||{};if(e.auth||i.auth){var s=e.auth||i.auth,u=s.username+":"+s.password,c=thisBtoa(unescape(encodeURIComponent(u)));a.headers=a.headers||{},a.headers.Authorization="Basic "+c}function l(e,t,r){var i=(e||{}).ajax||{},o=$inject_Object_assign(clone(a),i,t),s=clone(a.headers||{});return o.headers=$inject_Object_assign(s,i.headers,t.headers||{}),n.constructor.listeners("debug").length&&n.constructor.emit("debug",["http",o.method,o.url]),n._ajax(o,r)}function f(e,t){return new PouchPromise(function(r,n){l(e,t,function(e,t){if(e)return n(e);r(t)})})}function d(e,t){return adapterFun(e,argsarray(function(e){h().then(function(){return t.apply(this,e)}).catch(function(t){e.pop()(t)})}))}function h(){return e.skipSetup||e.skip_setup?PouchPromise.resolve():r||((r=f({},{method:"GET",url:o}).catch(function(e){return e&&e.status&&404===e.status?f({},{method:"PUT",url:o}):PouchPromise.reject(e)}).catch(function(e){return!(!e||!e.status||412!==e.status)||PouchPromise.reject(e)})).catch(function(){r=null}),r)}function p(e){return e.split("/").map(encodeURIComponent).join("/")}n._ajax=ajax,nextTick(function(){t(null,n)}),n._remote=!0,n.type=function(){return"http"},n.id=d("id",function(e){l({},{method:"GET",url:genUrl(i,"")},function(t,r){var n=r&&r.uuid?r.uuid+i.db:genDBUrl(i,"");e(null,n)})}),n.request=d("request",function(e,t){e.url=genDBUrl(i,e.url),l({},e,t)}),n.compact=d("compact",function(e,t){"function"==typeof e&&(t=e,e={}),l(e=clone(e),{url:genDBUrl(i,"_compact"),method:"POST"},function(){!function r(){n.info(function(n,i){i&&!i.compact_running?t(null,{ok:!0}):setTimeout(r,e.interval||200)})}()})}),n.bulkGet=adapterFun("bulkGet",function(e,t){var r=this;function n(t){var r={};e.revs&&(r.revs=!0),e.attachments&&(r.attachments=!0),e.latest&&(r.latest=!0),l(e,{url:genDBUrl(i,"_bulk_get"+paramsToStr(r)),method:"POST",body:{docs:e.docs}},function(r,n){!r&&e.attachments&&e.binary&&n.results.forEach(function(e){e.docs.forEach(readAttachmentsAsBlobOrBuffer)}),t(r,n)})}function o(){var n=MAX_SIMULTANEOUS_REVS,i=Math.ceil(e.docs.length/n),o=0,s=new Array(i);function u(e){return function(r,n){s[e]=n.results,++o===i&&t(null,{results:flatten(s)})}}for(var c=0;c<i;c++){var l=pick(e,["revs","attachments","binary","latest"]);l.ajax=a,l.docs=e.docs.slice(c*n,Math.min(e.docs.length,(c+1)*n)),bulkGet(r,l,u(c))}}var s=genUrl(i,""),u=supportsBulkGetMap[s];"boolean"!=typeof u?n(function(e,r){e?(supportsBulkGetMap[s]=!1,res(e.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),o()):(supportsBulkGetMap[s]=!0,t(null,r))}):u?n(t):o()}),n._info=function(e){h().then(function(){l({},{method:"GET",url:genDBUrl(i,"")},function(t,r){if(t)return e(t);r.host=genDBUrl(i,""),e(null,r)})}).catch(e)},n.get=d("get",function(e,t,r){"function"==typeof t&&(r=t,t={});var n={};(t=clone(t)).revs&&(n.revs=!0),t.revs_info&&(n.revs_info=!0),t.latest&&(n.latest=!0),t.open_revs&&("all"!==t.open_revs&&(t.open_revs=JSON.stringify(t.open_revs)),n.open_revs=t.open_revs),t.rev&&(n.rev=t.rev),t.conflicts&&(n.conflicts=t.conflicts),t.update_seq&&(n.update_seq=t.update_seq),e=encodeDocId(e);var o={method:"GET",url:genDBUrl(i,e+paramsToStr(n))};function a(e){var r=e._attachments,n=r&&Object.keys(r);if(r&&n.length)return pool(n.map(function(n){return function(){return a=r[o=n],s=encodeDocId(e._id)+"/"+p(o)+"?rev="+e._rev,f(t,{method:"GET",url:genDBUrl(i,s),binary:!0}).then(function(e){return t.binary?e:new PouchPromise(function(t){blobToBase64(e,t)})}).then(function(e){delete a.stub,delete a.length,a.data=e});var o,a,s}}),5)}f(t,o).then(function(e){return PouchPromise.resolve().then(function(){if(t.attachments)return r=e,Array.isArray(r)?PouchPromise.all(r.map(function(e){if(e.ok)return a(e.ok)})):a(r);var r}).then(function(){r(null,e)})}).catch(function(t){t.docId=e,r(t)})}),n.remove=d("remove",function(e,t,r,n){var o;"string"==typeof t?(o={_id:e,_rev:t},"function"==typeof r&&(n=r,r={})):(o=e,"function"==typeof t?(n=t,r={}):(n=r,r=t));var a=o._rev||r.rev;l(r,{method:"DELETE",url:genDBUrl(i,encodeDocId(o._id))+"?rev="+a},n)}),n.getAttachment=d("getAttachment",function(e,t,r,n){"function"==typeof r&&(n=r,r={});var o=r.rev?"?rev="+r.rev:"";l(r,{method:"GET",url:genDBUrl(i,encodeDocId(e))+"/"+p(t)+o,binary:!0},n)}),n.removeAttachment=d("removeAttachment",function(e,t,r,n){l({},{method:"DELETE",url:genDBUrl(i,encodeDocId(e)+"/"+p(t))+"?rev="+r},n)}),n.putAttachment=d("putAttachment",function(e,t,r,n,o,s){"function"==typeof o&&(s=o,o=n,n=r,r=null);var u=encodeDocId(e)+"/"+p(t),c=genDBUrl(i,u);if(r&&(c+="?rev="+r),"string"==typeof n){var f;try{f=thisAtob(n)}catch(e){return s(createError(BAD_ARG,"Attachment is not a valid base64 string"))}n=f?binStringToBluffer(f,o):""}l({},{headers:{"Content-Type":o},method:"PUT",url:c,processData:!1,body:n,timeout:a.timeout||6e4},s)}),n._bulkDocs=function(e,t,r){e.new_edits=t.new_edits,h().then(function(){return PouchPromise.all(e.docs.map(preprocessAttachments$2))}).then(function(){l(t,{method:"POST",url:genDBUrl(i,"_bulk_docs"),timeout:t.timeout,body:e},function(e,t){if(e)return r(e);t.forEach(function(e){e.ok=!0}),r(null,t)})}).catch(r)},n._put=function(e,t,r){h().then(function(){return preprocessAttachments$2(e)}).then(function(){l(t,{method:"PUT",url:genDBUrl(i,encodeDocId(e._id)),body:e},function(t,n){if(t)return t.docId=e&&e._id,r(t);r(null,n)})}).catch(r)},n.allDocs=d("allDocs",function(e,t){"function"==typeof e&&(t=e,e={});var r,n={},o="GET";(e=clone(e)).conflicts&&(n.conflicts=!0),e.update_seq&&(n.update_seq=!0),e.descending&&(n.descending=!0),e.include_docs&&(n.include_docs=!0),e.attachments&&(n.attachments=!0),e.key&&(n.key=JSON.stringify(e.key)),e.start_key&&(e.startkey=e.start_key),e.startkey&&(n.startkey=JSON.stringify(e.startkey)),e.end_key&&(e.endkey=e.end_key),e.endkey&&(n.endkey=JSON.stringify(e.endkey)),void 0!==e.inclusive_end&&(n.inclusive_end=!!e.inclusive_end),void 0!==e.limit&&(n.limit=e.limit),void 0!==e.skip&&(n.skip=e.skip);var a=paramsToStr(n);void 0!==e.keys&&(o="POST",r={keys:e.keys}),f(e,{method:o,url:genDBUrl(i,"_all_docs"+a),body:r}).then(function(r){e.include_docs&&e.attachments&&e.binary&&r.rows.forEach(readAttachmentsAsBlobOrBuffer),t(null,r)}).catch(t)}),n._changes=function(e){var t="batch_size"in e?e.batch_size:CHANGES_BATCH_SIZE;!(e=clone(e)).continuous||"heartbeat"in e||(e.heartbeat=DEFAULT_HEARTBEAT);var r="timeout"in e?e.timeout:"timeout"in a?a.timeout:3e4;"timeout"in e&&e.timeout&&r-e.timeout<CHANGES_TIMEOUT_BUFFER&&(r=e.timeout+CHANGES_TIMEOUT_BUFFER),"heartbeat"in e&&e.heartbeat&&r-e.heartbeat<CHANGES_TIMEOUT_BUFFER&&(r=e.heartbeat+CHANGES_TIMEOUT_BUFFER);var n={};"timeout"in e&&e.timeout&&(n.timeout=e.timeout);var o,s=void 0!==e.limit&&e.limit;o="return_docs"in e?e.return_docs:!("returnDocs"in e)||e.returnDocs;var u=s;if(e.style&&(n.style=e.style),(e.include_docs||e.filter&&"function"==typeof e.filter)&&(n.include_docs=!0),e.attachments&&(n.attachments=!0),e.continuous&&(n.feed="longpoll"),e.seq_interval&&(n.seq_interval=e.seq_interval),e.conflicts&&(n.conflicts=!0),e.descending&&(n.descending=!0),e.update_seq&&(n.update_seq=!0),"heartbeat"in e&&e.heartbeat&&(n.heartbeat=e.heartbeat),e.filter&&"string"==typeof e.filter&&(n.filter=e.filter),e.view&&"string"==typeof e.view&&(n.filter="_view",n.view=e.view),e.query_params&&"object"==typeof e.query_params)for(var c in e.query_params)e.query_params.hasOwnProperty(c)&&(n[c]=e.query_params[c]);var f,d,p,m="GET";e.doc_ids?(n.filter="_doc_ids",m="POST",f={doc_ids:e.doc_ids}):e.selector&&(n.filter="_selector",m="POST",f={selector:e.selector});var g=function(o,a){if(!e.aborted){n.since=o,"object"==typeof n.since&&(n.since=JSON.stringify(n.since)),e.descending?s&&(n.limit=u):n.limit=!s||u>t?t:u;var c={method:m,url:genDBUrl(i,"_changes"+paramsToStr(n)),timeout:r,body:f};p=o,e.aborted||h().then(function(){d=l(e,c,a)}).catch(a)}},y={results:[]},b=function(r,n){if(!e.aborted){var i=0;if(n&&n.results){i=n.results.length,y.last_seq=n.last_seq;var a=null,c=null;"number"==typeof n.pending&&(a=n.pending),"string"!=typeof y.last_seq&&"number"!=typeof y.last_seq||(c=y.last_seq);e.query_params,n.results=n.results.filter(function(t){u--;var r=filterChange(e)(t);return r&&(e.include_docs&&e.attachments&&e.binary&&readAttachmentsAsBlobOrBuffer(t),o&&y.results.push(t),e.onChange(t,a,c)),r})}else if(r)return e.aborted=!0,void e.complete(r);n&&n.last_seq&&(p=n.last_seq);var l=s&&u<=0||n&&i<t||e.descending;(!e.continuous||s&&u<=0)&&l?e.complete(null,y):nextTick(function(){g(p,b)})}};return g(e.since||0,b),{cancel:function(){e.aborted=!0,d&&d.abort()}}},n.revsDiff=d("revsDiff",function(e,t,r){"function"==typeof t&&(r=t,t={}),l(t,{method:"POST",url:genDBUrl(i,"_revs_diff"),body:e},r)}),n._close=function(e){e()},n._destroy=function(e,t){l(e,{url:genDBUrl(i,""),method:"DELETE"},function(e,r){if(e&&e.status&&404!==e.status)return t(e);t(null,r)})}}function HttpPouch$1(e){e.adapter("http",HttpPouch,!1),e.adapter("https",HttpPouch,!1)}function QueryParseError(e){this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,QueryParseError)}catch(e){}}function NotFoundError$2(e){this.status=404,this.name="not_found",this.message=e,this.error=!0;try{Error.captureStackTrace(this,NotFoundError$2)}catch(e){}}function BuiltInError(e){this.status=500,this.name="invalid_value",this.message=e,this.error=!0;try{Error.captureStackTrace(this,BuiltInError)}catch(e){}}function promisedCallback(e,t){return t&&e.then(function(e){nextTick(function(){t(null,e)})},function(e){nextTick(function(){t(e)})}),e}function callbackify(e){return argsarray(function(t){var r=t.pop(),n=e.apply(this,t);return"function"==typeof r&&promisedCallback(n,r),n})}function fin(e,t){return e.then(function(e){return t().then(function(){return e})},function(e){return t().then(function(){throw e})})}function sequentialize(e,t){return function(){var r=arguments,n=this;return e.add(function(){return t.apply(n,r)})}}function uniq(e){var t=new ExportedSet(e),r=new Array(t.size),n=-1;return t.forEach(function(e){r[++n]=e}),r}function mapToKeysArray(e){var t=new Array(e.size),r=-1;return e.forEach(function(e,n){t[++r]=n}),t}function createBuiltInError(e){return new BuiltInError("builtin "+e+" function requires map values to be numbers or number arrays")}function sum$3(e){for(var t=0,r=0,n=e.length;r<n;r++){var i=e[r];if("number"!=typeof i){if(!Array.isArray(i))throw createBuiltInError("_sum");t="number"==typeof t?[t]:t;for(var o=0,a=i.length;o<a;o++){var s=i[o];if("number"!=typeof s)throw createBuiltInError("_sum");void 0===t[o]?t.push(s):t[o]+=s}}else"number"==typeof t?t+=i:t[0]+=i}return t}function createBuiltInErrorInVm(e){return{builtInError:!0,name:e}}function convertToTrueError(e){return createBuiltInError(e.name)}function isBuiltInError(e){return e&&e.builtInError}function evalFunctionInVm(e,t){return function(r,n,i){var o='(function() {"use strict";var createBuiltInError = '+createBuiltInErrorInVm.toString()+";var sum = "+sum$3.toString()+";var log = function () {};var isArray = Array.isArray;var toJSON = JSON.parse;var __emitteds__ = [];var emit = function (key, value) {__emitteds__.push([key, value]);};var __result__ = ("+e.replace(/;\s*$/,"")+")("+JSON.stringify(r)+","+JSON.stringify(n)+","+JSON.stringify(i)+");return {result: __result__, emitteds: __emitteds__};})()",a=vm.runInNewContext(o);return a.emitteds.forEach(function(e){t(e[0],e[1])}),isBuiltInError(a.result)&&(a.result=convertToTrueError(a.result)),a.result}}HttpPouch.valid=function(){return!0},inherits(QueryParseError,Error),inherits(NotFoundError$2,Error),inherits(BuiltInError,Error);var log$2=guardedConsole.bind(null,"log"),toJSON=JSON.parse,evalFunc;evalFunc=evalFunctionInVm;var evalFunction=evalFunc;function TaskQueue$2(){this.promise=new PouchPromise(function(e){e()})}function stringify(e){if(!e)return"undefined";switch(typeof e){case"function":case"string":return e.toString();default:return JSON.stringify(e)}}function createViewSignature(e,t){return stringify(e)+stringify(t)+"undefined"}function createView(e,t,r,n,i,o){var a,s=createViewSignature(r,n);if(!i&&(a=e._cachedViews=e._cachedViews||{})[s])return a[s];var u=e.info().then(function(u){var c=u.db_name+"-mrview-"+(i?"temp":stringMd5(s));return upsert(e,"_local/"+o,function(e){e.views=e.views||{};var r=t;-1===r.indexOf("/")&&(r=t+"/"+t);var n=e.views[r]=e.views[r]||{};if(!n[c])return n[c]=!0,e}).then(function(){return e.registerDependentDatabase(c).then(function(t){var i=t.db;i.auto_compaction=!0;var o={name:c,db:i,sourceDB:e,adapter:e.adapter,mapFun:r,reduceFun:n};return o.db.get("_local/lastSeq").catch(function(e){if(404!==e.status)throw e}).then(function(e){return o.seq=e?e.seq:0,a&&o.db.once("destroyed",function(){delete a[s]}),o})})})});return a&&(a[s]=u),u}TaskQueue$2.prototype.add=function(e){return this.promise=this.promise.catch(function(){}).then(function(){return e()}),this.promise},TaskQueue$2.prototype.finish=function(){return this.promise};var persistentQueues={},tempViewQueue=new TaskQueue$2,CHANGES_BATCH_SIZE$1=50;function parseViewName(e){return-1===e.indexOf("/")?[e,e]:e.split("/")}function isGenOne(e){return 1===e.length&&/^1-/.test(e[0].rev)}function emitError(e,t){try{e.emit("error",t)}catch(e){guardedConsole("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),guardedConsole("error",t)}}function createAbstractMapReduce(e,t,r,n){function i(e,t,r){try{t(r)}catch(t){emitError(e,t)}}function o(e,t,r,n,i){try{return{output:t(r,n,i)}}catch(t){return emitError(e,t),{error:t}}}function a(e,t){var r=collate(e.key,t.key);return 0!==r?r:collate(e.value,t.value)}function s(e){var t=e.value;return t&&"object"==typeof t&&t._id||e.id}function u(e){return function(t){return e.include_docs&&e.attachments&&e.binary&&t.rows.forEach(function(e){var t=e.doc&&e.doc._attachments;t&&Object.keys(t).forEach(function(e){var r=t[e];t[e].data=b64ToBluffer(r.data,r.content_type)})}),t}}function c(e,t,r,n){var i=t[e];void 0!==i&&(n&&(i=encodeURIComponent(JSON.stringify(i))),r.push(e+"="+i))}function l(e){if(void 0!==e){var t=Number(e);return isNaN(t)||t!==parseInt(e,10)?e:t}}function f(e,t){var r=e.descending?"endkey":"startkey",n=e.descending?"startkey":"endkey";if(void 0!==e[r]&&void 0!==e[n]&&collate(e[r],e[n])>0)throw new QueryParseError("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(t.reduce&&!1!==e.reduce){if(e.include_docs)throw new QueryParseError("{include_docs:true} is invalid for reduce");if(e.keys&&e.keys.length>1&&!e.group&&!e.group_level)throw new QueryParseError("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(t){var r=function(e){if(e){if("number"!=typeof e)return new QueryParseError('Invalid value for integer: "'+e+'"');if(e<0)return new QueryParseError('Invalid value for positive integer: "'+e+'"')}}(e[t]);if(r)throw r})}function d(e){return function(t){if(404===t.status)return e;throw t}}function h(e,t,r){var n="_local/doc_"+e,i={_id:n,keys:[]},o=r.get(e),a=o[0];return(isGenOne(o[1])?PouchPromise.resolve(i):t.db.get(n).catch(d(i))).then(function(e){return(r=e,r.keys.length?t.db.allDocs({keys:r.keys,include_docs:!0}):PouchPromise.resolve({rows:[]})).then(function(t){return function(e,t){for(var r=[],n=new ExportedSet,i=0,o=t.rows.length;i<o;i++){var s=t.rows[i].doc;if(s&&(r.push(s),n.add(s._id),s._deleted=!a.has(s._id),!s._deleted)){var u=a.get(s._id);"value"in u&&(s.value=u.value)}}var c=mapToKeysArray(a);return c.forEach(function(e){if(!n.has(e)){var t={_id:e},i=a.get(e);"value"in i&&(t.value=i.value),r.push(t)}}),e.keys=uniq(c.concat(e.keys)),r.push(e),r}(e,t)});var r})}function p(e){var t="string"==typeof e?e:e.name,r=persistentQueues[t];return r||(r=persistentQueues[t]=new TaskQueue$2),r}function m(e){return sequentialize(p(e),function(){return function(e){var r,n;var o=t(e.mapFun,function(e,t){var i={id:n._id,key:normalizeKey(e)};void 0!==t&&null!==t&&(i.value=normalizeKey(t));r.push(i)}),s=e.seq||0;function u(t,r){return function(){return i=t,o=r,(n=e).db.get("_local/lastSeq").catch(d({_id:"_local/lastSeq",seq:0})).then(function(e){var t=mapToKeysArray(i);return PouchPromise.all(t.map(function(e){return h(e,n,i)})).then(function(t){var r=flatten(t);return e.seq=o,r.push(e),n.db.bulkDocs({docs:r})})});var n,i,o}}var c=new TaskQueue$2;function l(){return e.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:s,limit:CHANGES_BATCH_SIZE$1}).then(f)}function f(t){var f=t.results;if(f.length){var d=function(t){for(var u=new ExportedMap,c=0,l=t.length;c<l;c++){var f=t[c];if("_"!==f.doc._id[0]){r=[],(n=f.doc)._deleted||i(e.sourceDB,o,n),r.sort(a);var d=p(r);u.set(f.doc._id,[d,f.changes])}s=f.seq}return u}(f);if(c.add(u(d,s)),!(f.length<CHANGES_BATCH_SIZE$1))return l()}}function p(e){for(var t,r=new ExportedMap,n=0,i=e.length;n<i;n++){var o=e[n],a=[o.key,o.id];n>0&&0===collate(o.key,t)&&a.push(n),r.set(toIndexableString(a),o),t=o.key}return r}return l().then(function(){return c.finish()}).then(function(){e.seq=s})}(e)})()}function g(e,t){return sequentialize(p(e),function(){return function(e,t){var n,i=e.reduceFun&&!1!==t.reduce,a=t.skip||0;void 0===t.keys||t.keys.length||(t.limit=0,delete t.keys);function u(t){return t.include_docs=!0,e.db.allDocs(t).then(function(e){return n=e.total_rows,e.rows.map(function(e){if("value"in e.doc&&"object"==typeof e.doc.value&&null!==e.doc.value){var t=Object.keys(e.doc.value).sort(),r=["id","key","value"];if(!(t<r||t>r))return e.doc.value}var n=parseIndexableString(e.doc._id);return{key:n[0],id:n[1],value:"value"in e.doc?e.doc.value:null}})})}function c(u){var c;if(c=i?function(e,t,n){0===n.group_level&&delete n.group_level;var i,a,s,u=n.group||n.group_level,c=r(e.reduceFun),l=[],f=isNaN(n.group_level)?Number.POSITIVE_INFINITY:n.group_level;t.forEach(function(e){var t=l[l.length-1],r=u?e.key:null;if(u&&Array.isArray(r)&&(r=r.slice(0,f)),t&&0===collate(t.groupKey,r))return t.keys.push([e.key,e.id]),void t.values.push(e.value);l.push({keys:[[e.key,e.id]],values:[e.value],groupKey:r})}),t=[];for(var d=0,h=l.length;d<h;d++){var p=l[d],m=o(e.sourceDB,c,p.keys,p.values,!1);if(m.error&&m.error instanceof BuiltInError)throw m.error;t.push({value:m.error?null:m.output,key:p.groupKey})}return{rows:(i=t,a=n.limit,s=n.skip,s=s||0,"number"==typeof a?i.slice(s,a+s):s>0?i.slice(s):i)}}(e,u,t):{total_rows:n,offset:a,rows:u},t.update_seq&&(c.update_seq=e.seq),t.include_docs){var l=uniq(u.map(s));return e.sourceDB.allDocs({keys:l,include_docs:!0,conflicts:t.conflicts,attachments:t.attachments,binary:t.binary}).then(function(e){var t=new ExportedMap;return e.rows.forEach(function(e){t.set(e.id,e.doc)}),u.forEach(function(e){var r=s(e),n=t.get(r);n&&(e.doc=n)}),c})}return c}if(void 0!==t.keys){var l=t.keys,f=l.map(function(e){var r={startkey:toIndexableString([e]),endkey:toIndexableString([e,{}])};return t.update_seq&&(r.update_seq=!0),u(r)});return PouchPromise.all(f).then(flatten).then(c)}var d,h,p={descending:t.descending};if(t.update_seq&&(p.update_seq=!0),"start_key"in t&&(d=t.start_key),"startkey"in t&&(d=t.startkey),"end_key"in t&&(h=t.end_key),"endkey"in t&&(h=t.endkey),void 0!==d&&(p.startkey=t.descending?toIndexableString([d,{}]):toIndexableString([d])),void 0!==h){var m=!1!==t.inclusive_end;t.descending&&(m=!m),p.endkey=toIndexableString(m?[h,{}]:[h])}if(void 0!==t.key){var g=toIndexableString([t.key]),y=toIndexableString([t.key,{}]);p.descending?(p.endkey=g,p.startkey=y):(p.startkey=g,p.endkey=y)}return i||("number"==typeof t.limit&&(p.limit=t.limit),p.skip=a),u(p).then(c)}(e,t)})()}function y(t,r,i){if("function"==typeof t._query)return o=t,a=r,s=i,new PouchPromise(function(e,t){o._query(a,s,function(r,n){if(r)return t(r);e(n)})});var o,a,s;if(isRemote(t))return function(e,t,r){var n,i=[],o="GET";if(c("reduce",r,i),c("include_docs",r,i),c("attachments",r,i),c("limit",r,i),c("descending",r,i),c("group",r,i),c("group_level",r,i),c("skip",r,i),c("stale",r,i),c("conflicts",r,i),c("startkey",r,i,!0),c("start_key",r,i,!0),c("endkey",r,i,!0),c("end_key",r,i,!0),c("inclusive_end",r,i),c("key",r,i,!0),c("update_seq",r,i),i=""===(i=i.join("&"))?"":"?"+i,void 0!==r.keys){var a="keys="+encodeURIComponent(JSON.stringify(r.keys));a.length+i.length+1<=2e3?i+=("?"===i[0]?"&":"?")+a:(o="POST","string"==typeof t?n={keys:r.keys}:t.keys=r.keys)}if("string"==typeof t){var s=parseViewName(t);return e.request({method:o,url:"_design/"+s[0]+"/_view/"+s[1]+i,body:n}).then(function(e){return e.rows.forEach(function(e){if(e.value&&e.value.error&&"builtin_reduce_error"===e.value.error)throw new Error(e.reason)}),e}).then(u(r))}return n=n||{},Object.keys(t).forEach(function(e){Array.isArray(t[e])?n[e]=t[e]:n[e]=t[e].toString()}),e.request({method:"POST",url:"_temp_view"+i,body:n}).then(u(r))}(t,r,i);if("string"!=typeof r)return f(i,r),tempViewQueue.add(function(){return createView(t,"temp_view/temp_view",r.map,r.reduce,!0,e).then(function(e){return fin(m(e).then(function(){return g(e,i)}),function(){return e.db.destroy()})})}),tempViewQueue.finish();var l=r,d=parseViewName(l),h=d[0],p=d[1];return t.get("_design/"+h).then(function(r){var o=r.views&&r.views[p];if(!o)throw new NotFoundError$2("ddoc "+r._id+" has no view named "+p);return n(r,p),f(i,o),createView(t,l,o.map,o.reduce,!1,e).then(function(e){return"ok"===i.stale||"update_after"===i.stale?("update_after"===i.stale&&nextTick(function(){m(e)}),g(e,i)):m(e).then(function(){return g(e,i)})})})}return{query:function(e,t,r){var n,i=this;"function"==typeof t&&(r=t,t={}),t=t?((n=t).group_level=l(n.group_level),n.limit=l(n.limit),n.skip=l(n.skip),n):{},"function"==typeof e&&(e={map:e});var o=PouchPromise.resolve().then(function(){return y(i,e,t)});return promisedCallback(o,r),o},viewCleanup:callbackify(function(){var t,r;return"function"==typeof this._viewCleanup?(t=this,new PouchPromise(function(e,r){t._viewCleanup(function(t,n){if(t)return r(t);e(n)})})):isRemote(this)?this.request({method:"POST",url:"_view_cleanup"}):(r=this).get("_local/"+e).then(function(e){var t=new ExportedMap;Object.keys(e.views).forEach(function(e){var r=parseViewName(e),n="_design/"+r[0],i=r[1],o=t.get(n);o||(o=new ExportedSet,t.set(n,o)),o.add(i)});var n={keys:mapToKeysArray(t),include_docs:!0};return r.allDocs(n).then(function(n){var i={};n.rows.forEach(function(r){var n=r.key.substring(8);t.get(r.key).forEach(function(t){var o=n+"/"+t;e.views[o]||(o=t);var a=Object.keys(e.views[o]),s=r.doc&&r.doc.views&&r.doc.views[t];a.forEach(function(e){i[e]=i[e]||s})})});var o=Object.keys(i).filter(function(e){return!i[e]}).map(function(e){return sequentialize(p(e),function(){return new r.constructor(e,r.__opts).destroy()})()});return PouchPromise.all(o).then(function(){return{ok:!0}})})},d({ok:!0}))})}}var builtInReduce={_sum:function(e,t){return sum$3(t)},_count:function(e,t){return t.length},_stats:function(e,t){return{sum:sum$3(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:function(e){for(var t=0,r=0,n=e.length;r<n;r++){var i=e[r];t+=i*i}return t}(t)}}};function getBuiltIn(e){if(/^_sum/.test(e))return builtInReduce._sum;if(/^_count/.test(e))return builtInReduce._count;if(/^_stats/.test(e))return builtInReduce._stats;if(/^_/.test(e))throw new Error(e+" is not a supported reduce function.")}function mapper(e,t){if("function"==typeof e&&2===e.length){var r=e;return function(e){return r(e,t)}}return evalFunction(e.toString(),t)}function reducer(e){var t=e.toString(),r=getBuiltIn(t);return r||evalFunction(t)}function ddocValidator(e,t){var r=e.views&&e.views[t];if("string"!=typeof r.map)throw new NotFoundError$2("ddoc "+e._id+" has no string view named "+t+", instead found object of type: "+typeof r.map)}var localDocName="mrviews",abstract=createAbstractMapReduce(localDocName,mapper,reducer,ddocValidator);function query(e,t,r){return abstract.query.call(this,e,t,r)}function viewCleanup(e){return abstract.viewCleanup.call(this,e)}var mapreduce={query:query,viewCleanup:viewCleanup};function isGenOne$1(e){return/^1-/.test(e)}function fileHasChanged(e,t,r){return!e._attachments||!e._attachments[r]||e._attachments[r].digest!==t._attachments[r].digest}function getDocAttachments(e,t){var r=Object.keys(t._attachments);return PouchPromise.all(r.map(function(r){return e.getAttachment(t._id,r,{rev:t._rev})}))}function getDocAttachmentsFromTargetOrSource(e,t,r){var n=isRemote(t)&&!isRemote(e),i=Object.keys(r._attachments);return n?e.get(r._id).then(function(n){return PouchPromise.all(i.map(function(i){return fileHasChanged(n,r,i)?t.getAttachment(r._id,i):e.getAttachment(n._id,i)}))}).catch(function(e){if(404!==e.status)throw e;return getDocAttachments(t,r)}):getDocAttachments(t,r)}function createBulkGetOpts(e){var t=[];return Object.keys(e).forEach(function(r){e[r].missing.forEach(function(e){t.push({id:r,rev:e})})}),{docs:t,revs:!0,latest:!0}}function getDocs(e,t,r,n){r=clone(r);var i=[],o=!0;function a(t){return e.allDocs({keys:t,include_docs:!0,conflicts:!0}).then(function(e){if(n.cancelled)throw new Error("cancelled");e.rows.forEach(function(e){var t,n;e.deleted||!e.doc||!isGenOne$1(e.value.rev)||(n=e.doc,n._attachments&&Object.keys(n._attachments).length>0)||(t=e.doc,t._conflicts&&t._conflicts.length>0)||(e.doc._conflicts&&delete e.doc._conflicts,i.push(e.doc),delete r[e.id])})})}return PouchPromise.resolve().then(function(){var e=Object.keys(r).filter(function(e){var t=r[e].missing;return 1===t.length&&isGenOne$1(t[0])});if(e.length>0)return a(e)}).then(function(){var a=createBulkGetOpts(r);if(a.docs.length)return e.bulkGet(a).then(function(r){if(n.cancelled)throw new Error("cancelled");return PouchPromise.all(r.results.map(function(r){return PouchPromise.all(r.docs.map(function(r){var n=r.ok;return r.error&&(o=!1),n&&n._attachments?getDocAttachmentsFromTargetOrSource(t,e,n).then(function(e){var t=Object.keys(n._attachments);return e.forEach(function(e,r){var i=n._attachments[t[r]];delete i.stub,delete i.length,i.data=e}),n}):n}))})).then(function(e){i=i.concat(flatten(e).filter(Boolean))})})}).then(function(){return{ok:o,docs:i}})}var CHECKPOINT_VERSION=1,REPLICATOR="pouchdb",CHECKPOINT_HISTORY_SIZE=5,LOWEST_SEQ=0;function updateCheckpoint(e,t,r,n,i){return e.get(t).catch(function(r){if(404===r.status)return"http"===e.adapter||e.adapter,{session_id:n,_id:t,history:[],replicator:REPLICATOR,version:CHECKPOINT_VERSION};throw r}).then(function(o){if(!i.cancelled&&o.last_seq!==r)return o.history=(o.history||[]).filter(function(e){return e.session_id!==n}),o.history.unshift({last_seq:r,session_id:n}),o.history=o.history.slice(0,CHECKPOINT_HISTORY_SIZE),o.version=CHECKPOINT_VERSION,o.replicator=REPLICATOR,o.session_id=n,o.last_seq=r,e.put(o).catch(function(o){if(409===o.status)return updateCheckpoint(e,t,r,n,i);throw o})})}function Checkpointer(e,t,r,n,i){this.src=e,this.target=t,this.id=r,this.returnValue=n,this.opts=i||{}}Checkpointer.prototype.writeCheckpoint=function(e,t){var r=this;return this.updateTarget(e,t).then(function(){return r.updateSource(e,t)})},Checkpointer.prototype.updateTarget=function(e,t){return this.opts.writeTargetCheckpoint?updateCheckpoint(this.target,this.id,e,t,this.returnValue):PouchPromise.resolve(!0)},Checkpointer.prototype.updateSource=function(e,t){if(this.opts.writeSourceCheckpoint){var r=this;return updateCheckpoint(this.src,this.id,e,t,this.returnValue).catch(function(e){if(isForbiddenError(e))return r.opts.writeSourceCheckpoint=!1,!0;throw e})}return PouchPromise.resolve(!0)};var comparisons={undefined:function(e,t){return 0===collate(e.last_seq,t.last_seq)?t.last_seq:0},1:function(e,t){return compareReplicationLogs(t,e).last_seq}};function compareReplicationLogs(e,t){return e.session_id===t.session_id?{last_seq:e.last_seq,history:e.history}:compareReplicationHistory(e.history,t.history)}function compareReplicationHistory(e,t){var r=e[0],n=e.slice(1),i=t[0],o=t.slice(1);return r&&0!==t.length?hasSessionId(r.session_id,t)?{last_seq:r.last_seq,history:e}:hasSessionId(i.session_id,n)?{last_seq:i.last_seq,history:o}:compareReplicationHistory(n,o):{last_seq:LOWEST_SEQ,history:[]}}function hasSessionId(e,t){var r=t[0],n=t.slice(1);return!(!e||0===t.length)&&(e===r.session_id||hasSessionId(e,n))}function isForbiddenError(e){return"number"==typeof e.status&&4===Math.floor(e.status/100)}Checkpointer.prototype.getCheckpoint=function(){var e=this;return e.opts&&e.opts.writeSourceCheckpoint&&!e.opts.writeTargetCheckpoint?e.src.get(e.id).then(function(e){return e.last_seq||LOWEST_SEQ}).catch(function(e){if(404!==e.status)throw e;return LOWEST_SEQ}):e.target.get(e.id).then(function(t){return e.opts&&e.opts.writeTargetCheckpoint&&!e.opts.writeSourceCheckpoint?t.last_seq||LOWEST_SEQ:e.src.get(e.id).then(function(e){return t.version!==e.version?LOWEST_SEQ:(r=t.version?t.version.toString():"undefined")in comparisons?comparisons[r](t,e):LOWEST_SEQ;var r},function(r){if(404===r.status&&t.last_seq)return e.src.put({_id:e.id,last_seq:LOWEST_SEQ}).then(function(){return LOWEST_SEQ},function(r){return isForbiddenError(r)?(e.opts.writeSourceCheckpoint=!1,t.last_seq):LOWEST_SEQ});throw r})}).catch(function(e){if(404!==e.status)throw e;return LOWEST_SEQ})};var STARTING_BACK_OFF=0;function backOff(e,t,r,n){if(!1===e.retry)return t.emit("error",r),void t.removeAllListeners();if("function"!=typeof e.back_off_function&&(e.back_off_function=defaultBackOff),t.emit("requestError",r),"active"===t.state||"pending"===t.state){t.emit("paused",r),t.state="stopped";var i=function(){e.current_back_off=STARTING_BACK_OFF};t.once("paused",function(){t.removeListener("active",i)}),t.once("active",i)}e.current_back_off=e.current_back_off||STARTING_BACK_OFF,e.current_back_off=e.back_off_function(e.current_back_off),setTimeout(n,e.current_back_off)}function sortObjectPropertiesByKey(e){return Object.keys(e).sort(collate).reduce(function(t,r){return t[r]=e[r],t},{})}function generateReplicationId(e,t,r){var n=r.doc_ids?r.doc_ids.sort(collate):"",i=r.filter?r.filter.toString():"",o="",a="",s="";return r.selector&&(s=JSON.stringify(r.selector)),r.filter&&r.query_params&&(o=JSON.stringify(sortObjectPropertiesByKey(r.query_params))),r.filter&&"_view"===r.filter&&(a=r.view.toString()),PouchPromise.all([e.id(),t.id()]).then(function(e){var t=e[0]+e[1]+i+a+o+n+s;return new PouchPromise(function(e){binaryMd5(t,e)})}).then(function(e){return"_local/"+(e=e.replace(/\//g,".").replace(/\+/g,"_"))})}function replicate(e,t,r,n,i){var o,a,s,u=[],c={seq:0,changes:[],docs:[]},l=!1,f=!1,d=!1,h=0,p=r.continuous||r.live||!1,m=r.batch_size||100,g=r.batches_limit||10,y=!1,b=r.doc_ids,v=r.selector,_=[],w=uuid(),E=r.seq_interval;i=i||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var $={};function S(){return s?PouchPromise.resolve():generateReplicationId(e,t,r).then(function(i){a=i;var o={};o=!1===r.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:"source"===r.checkpoint?{writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:"target"===r.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:{writeSourceCheckpoint:!0,writeTargetCheckpoint:!0},s=new Checkpointer(e,t,a,n,o)})}function T(){if(_=[],0!==o.docs.length){var e=o.docs,a={timeout:r.timeout};return t.bulkDocs({docs:e,new_edits:!1},a).then(function(t){if(n.cancelled)throw I(),new Error("cancelled");var r=Object.create(null);t.forEach(function(e){e.error&&(r[e.id]=e)});var o=Object.keys(r).length;i.doc_write_failures+=o,i.docs_written+=e.length-o,e.forEach(function(e){var t=r[e._id];if(t){i.errors.push(t);var o=(t.name||"").toLowerCase();if("unauthorized"!==o&&"forbidden"!==o)throw t;n.emit("denied",clone(t))}else _.push(e)})},function(t){throw i.doc_write_failures+=e.length,t})}}function x(){if(o.error)throw new Error("There was a problem getting docs.");i.last_seq=h=o.seq;var e=clone(i);return _.length&&(e.docs=_,"number"==typeof o.pending&&(e.pending=o.pending,delete o.pending),n.emit("change",e)),l=!0,s.writeCheckpoint(o.seq,w).then(function(){if(l=!1,n.cancelled)throw I(),new Error("cancelled");o=void 0,L()}).catch(function(e){throw B(e),e})}function C(){return getDocs(e,t,o.diffs,n).then(function(e){o.error=!e.ok,e.docs.forEach(function(e){delete o.diffs[e._id],i.docs_read++,o.docs.push(e)})})}function k(){var e;n.cancelled||o||(0!==u.length?(o=u.shift(),(e={},o.changes.forEach(function(t){"_user/"!==t.id&&(e[t.id]=t.changes.map(function(e){return e.rev}))}),t.revsDiff(e).then(function(e){if(n.cancelled)throw I(),new Error("cancelled");o.diffs=e})).then(C).then(T).then(x).then(k).catch(function(e){D("batch processing terminated with error",e)})):N(!0))}function N(e){0!==c.changes.length?(e||f||c.changes.length>=m)&&(u.push(c),c={seq:0,changes:[],docs:[]},"pending"!==n.state&&"stopped"!==n.state||(n.state="active",n.emit("active")),k()):0!==u.length||o||((p&&$.live||f)&&(n.state="pending",n.emit("paused")),f&&I())}function D(e,t){d||(t.message||(t.message=e),i.ok=!1,i.status="aborting",u=[],c={seq:0,changes:[],docs:[]},I(t))}function I(o){if(!(d||n.cancelled&&(i.status="cancelled",l)))if(i.status=i.status||"complete",i.end_time=new Date,i.last_seq=h,d=!0,o){(o=createError(o)).result=i;var a=(o.name||"").toLowerCase();"unauthorized"===a||"forbidden"===a?(n.emit("error",o),n.removeAllListeners()):backOff(r,n,o,function(){replicate(e,t,r,n)})}else n.emit("complete",i),n.removeAllListeners()}function A(e,t,i){if(n.cancelled)return I();"number"==typeof t&&(c.pending=t),filterChange(r)(e)&&(c.seq=e.seq||i,c.changes.push(e),N(0===u.length&&$.live))}function O(e){if(y=!1,n.cancelled)return I();if(e.results.length>0)$.since=e.last_seq,L(),N(!0);else{var t=function(){p?($.live=!0,L()):f=!0,N(!0)};o||0!==e.results.length?t():(l=!0,s.writeCheckpoint(e.last_seq,w).then(function(){l=!1,i.last_seq=h=e.last_seq,t()}).catch(B))}}function M(e){if(y=!1,n.cancelled)return I();D("changes rejected",e)}function L(){if(!y&&!f&&u.length<g){y=!0,n._changes&&(n.removeListener("cancel",n._abortChanges),n._changes.cancel()),n.once("cancel",i);var t=e.changes($).on("change",A);t.then(o,o),t.then(O).catch(M),r.retry&&(n._changes=t,n._abortChanges=i)}function i(){t.cancel()}function o(){n.removeListener("cancel",i)}}function R(){S().then(function(){if(!n.cancelled)return s.getCheckpoint().then(function(e){$={since:h=e,limit:m,batch_size:m,style:"all_docs",doc_ids:b,selector:v,return_docs:!0},!1!==E&&($.seq_interval=E||m),r.filter&&("string"!=typeof r.filter?$.include_docs=!0:$.filter=r.filter),"heartbeat"in r&&($.heartbeat=r.heartbeat),"timeout"in r&&($.timeout=r.timeout),r.query_params&&($.query_params=r.query_params),r.view&&($.view=r.view),L()});I()}).catch(function(e){D("getCheckpoint rejected with ",e)})}function B(e){l=!1,D("writeCheckpoint completed with error",e)}n.ready(e,t),n.cancelled?I():(n._addedListeners||(n.once("cancel",I),"function"==typeof r.complete&&(n.once("error",r.complete),n.once("complete",function(e){r.complete(null,e)})),n._addedListeners=!0),void 0===r.since?R():S().then(function(){return l=!0,s.writeCheckpoint(r.since,w)}).then(function(){l=!1,n.cancelled?I():(h=r.since,R())}).catch(B))}function Replication(){EventEmitter.call(this),this.cancelled=!1,this.state="pending";var e=this,t=new PouchPromise(function(t,r){e.once("complete",t),e.once("error",r)});e.then=function(e,r){return t.then(e,r)},e.catch=function(e){return t.catch(e)},e.catch(function(){})}function toPouch(e,t){var r=t.PouchConstructor;return"string"==typeof e?new r(e,t):e}function replicateWrapper(e,t,r,n){if("function"==typeof r&&(n=r,r={}),void 0===r&&(r={}),r.doc_ids&&!Array.isArray(r.doc_ids))throw createError(BAD_REQUEST,"`doc_ids` filter parameter is not a list.");r.complete=n,(r=clone(r)).continuous=r.continuous||r.live,r.retry="retry"in r&&r.retry,r.PouchConstructor=r.PouchConstructor||this;var i=new Replication(r);return replicate(toPouch(e,r),toPouch(t,r),r,i),i}function sync$1(e,t,r,n){return"function"==typeof r&&(n=r,r={}),void 0===r&&(r={}),(r=clone(r)).PouchConstructor=r.PouchConstructor||this,new Sync(e=toPouch(e,r),t=toPouch(t,r),r,n)}function Sync(e,t,r,n){var i=this;this.canceled=!1;var o=r.push?$inject_Object_assign({},r,r.push):r,a=r.pull?$inject_Object_assign({},r,r.pull):r;function s(e){i.emit("change",{direction:"pull",change:e})}function u(e){i.emit("change",{direction:"push",change:e})}function c(e){i.emit("denied",{direction:"push",doc:e})}function l(e){i.emit("denied",{direction:"pull",doc:e})}function f(){i.pushPaused=!0,i.pullPaused&&i.emit("paused")}function d(){i.pullPaused=!0,i.pushPaused&&i.emit("paused")}function h(){i.pushPaused=!1,i.pullPaused&&i.emit("active",{direction:"push"})}function p(){i.pullPaused=!1,i.pushPaused&&i.emit("active",{direction:"pull"})}this.push=replicateWrapper(e,t,o),this.pull=replicateWrapper(t,e,a),this.pushPaused=!0,this.pullPaused=!0;var m={};function g(e){return function(t,r){("change"===t&&(r===s||r===u)||"denied"===t&&(r===l||r===c)||"paused"===t&&(r===d||r===f)||"active"===t&&(r===p||r===h))&&(t in m||(m[t]={}),m[t][e]=!0,2===Object.keys(m[t]).length&&i.removeAllListeners(t))}}function y(e,t,r){-1==e.listeners(t).indexOf(r)&&e.on(t,r)}r.live&&(this.push.on("complete",i.pull.cancel.bind(i.pull)),this.pull.on("complete",i.push.cancel.bind(i.push))),this.on("newListener",function(e){"change"===e?(y(i.pull,"change",s),y(i.push,"change",u)):"denied"===e?(y(i.pull,"denied",l),y(i.push,"denied",c)):"active"===e?(y(i.pull,"active",p),y(i.push,"active",h)):"paused"===e&&(y(i.pull,"paused",d),y(i.push,"paused",f))}),this.on("removeListener",function(e){"change"===e?(i.pull.removeListener("change",s),i.push.removeListener("change",u)):"denied"===e?(i.pull.removeListener("denied",l),i.push.removeListener("denied",c)):"active"===e?(i.pull.removeListener("active",p),i.push.removeListener("active",h)):"paused"===e&&(i.pull.removeListener("paused",d),i.push.removeListener("paused",f))}),this.pull.on("removeListener",g("pull")),this.push.on("removeListener",g("push"));var b=PouchPromise.all([this.push,this.pull]).then(function(e){var t={push:e[0],pull:e[1]};return i.emit("complete",t),n&&n(null,t),i.removeAllListeners(),t},function(e){if(i.cancel(),n?n(e):i.emit("error",e),i.removeAllListeners(),n)throw e});this.then=function(e,t){return b.then(e,t)},this.catch=function(e){return b.catch(e)}}function replication(e){e.replicate=replicateWrapper,e.sync=sync$1,Object.defineProperty(e.prototype,"replicate",{get:function(){var e=this;return void 0===this.replicateMethods&&(this.replicateMethods={from:function(t,r,n){return e.constructor.replicate(t,e,r,n)},to:function(t,r,n){return e.constructor.replicate(e,t,r,n)}}),this.replicateMethods}}),e.prototype.sync=function(e,t,r){return this.constructor.sync(this,e,t,r)}}inherits(Replication,EventEmitter),Replication.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},Replication.prototype.ready=function(e,t){var r=this;function n(){r.cancel()}r._readyCalled||(r._readyCalled=!0,e.once("destroyed",n),t.once("destroyed",n),r.once("complete",function(){e.removeListener("destroyed",n),t.removeListener("destroyed",n)}))},inherits(Sync,EventEmitter),Sync.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},PouchDB$5.plugin(LevelPouch).plugin(HttpPouch$1).plugin(mapreduce).plugin(replication);var urlJoin=createCommonjsModule(function(e){var t,r;t=commonjsGlobal,r=function(){return function(){var e=arguments;"object"==typeof arguments[0]&&(e=arguments[0],arguments[1]);var t,r,n=[].slice.call(e,0).join("/");return r="file://",t=(t=(t=(t=n).substr(0,r.length)===r?t.replace(/(\/{0,3})\/*/g,"$1"):(t=t.replace(/:\//g,"://")).replace(/([^:\s\%\3\A])\/+/g,"$1/")).replace(/\/(\?|&|#[^!])/g,"$1")).replace(/(\?.+)\?/g,"$1&")}},e.exports?e.exports=r():t.urljoin=r()}),requiresPort=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e},has=Object.prototype.hasOwnProperty;function decode(e){return decodeURIComponent(e.replace(/\+/g," "))}function querystring(e){for(var t,r=/([^=?&]+)=?([^&]*)/g,n={};t=r.exec(e);n[decode(t[1])]=decode(t[2]));return n}function querystringify(e,t){var r=[];"string"!=typeof(t=t||"")&&(t="?");for(var n in e)has.call(e,n)&&r.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return r.length?t+r.join("&"):""}var stringify$2=querystringify,parse$2=querystring,querystringify_1={stringify:stringify$2,parse:parse$2},protocolre=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,slashes=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,rules=[["#","hash"],["?","query"],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],ignore={hash:1,query:1};function lolcation(e){var t,r={},n=typeof(e=e||commonjsGlobal.location||{});if("blob:"===e.protocol)r=new URL(unescape(e.pathname),{});else if("string"===n){r=new URL(e,{});for(t in ignore)delete r[t]}else if("object"===n){for(t in e)t in ignore||(r[t]=e[t]);void 0===r.slashes&&(r.slashes=slashes.test(e.href))}return r}function extractProtocol(e){var t=protocolre.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function resolve$2(e,t){for(var r=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=r.length,i=r[n-1],o=!1,a=0;n--;)"."===r[n]?r.splice(n,1):".."===r[n]?(r.splice(n,1),a++):a&&(0===n&&(o=!0),r.splice(n,1),a--);return o&&r.unshift(""),"."!==i&&".."!==i||r.push(""),r.join("/")}function URL(e,t,r){if(!(this instanceof URL))return new URL(e,t,r);var n,i,o,a,s,u,c=rules.slice(),l=typeof t,f=0;for("object"!==l&&"string"!==l&&(r=t,t=null),r&&"function"!=typeof r&&(r=querystringify_1.parse),t=lolcation(t),n=!(i=extractProtocol(e||"")).protocol&&!i.slashes,this.slashes=i.slashes||n&&t.slashes,this.protocol=i.protocol||t.protocol||"",e=i.rest,i.slashes||(c[2]=[/(.*)/,"pathname"]);f<c.length;f++)o=(a=c[f])[0],u=a[1],o!=o?this[u]=e:"string"==typeof o?~(s=e.indexOf(o))&&("number"==typeof a[2]?(this[u]=e.slice(0,s),e=e.slice(s+a[2])):(this[u]=e.slice(s),e=e.slice(0,s))):(s=o.exec(e))&&(this[u]=s[1],e=e.slice(0,s.index)),this[u]=this[u]||(n&&a[3]?t[u]||"":""),a[4]&&(this[u]=this[u].toLowerCase());r&&(this.query=r(this.query)),n&&t.slashes&&"/"!==this.pathname.charAt(0)&&(""!==this.pathname||""!==t.pathname)&&(this.pathname=resolve$2(this.pathname,t.pathname)),requiresPort(this.port,this.protocol)||(this.host=this.hostname,this.port=""),this.username=this.password="",this.auth&&(a=this.auth.split(":"),this.username=a[0]||"",this.password=a[1]||""),this.origin=this.protocol&&this.host&&"file:"!==this.protocol?this.protocol+"//"+this.host:"null",this.href=this.toString()}function set$4(e,t,r){switch(e){case"query":"string"==typeof t&&t.length&&(t=(r||querystringify_1.parse)(t)),this[e]=t;break;case"port":this[e]=t,requiresPort(t,this.protocol)?t&&(this.host=this.hostname+":"+t):(this.host=this.hostname,this[e]="");break;case"hostname":this[e]=t,this.port&&(t+=":"+this.port),this.host=t;break;case"host":this[e]=t,/:\d+$/.test(t)?(t=t.split(":"),this.port=t.pop(),this.hostname=t.join(":")):(this.hostname=t,this.port="");break;case"protocol":this.protocol=t.toLowerCase(),this.slashes=!r;break;case"pathname":case"hash":if(t){var n="pathname"===e?"/":"#";this[e]=t.charAt(0)!==n?n+t:t}else this[e]=t;break;default:this[e]=t}for(var i=0;i<rules.length;i++){var o=rules[i];o[4]&&(this[o[1]]=this[o[1]].toLowerCase())}return this.origin=this.protocol&&this.host&&"file:"!==this.protocol?this.protocol+"//"+this.host:"null",this.href=this.toString(),this}function toString$2(e){e&&"function"==typeof e||(e=querystringify_1.stringify);var t,r=this.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var n=r+(this.slashes?"//":"");return this.username&&(n+=this.username,this.password&&(n+=":"+this.password),n+="@"),n+=this.host+this.pathname,(t="object"==typeof this.query?e(this.query):this.query)&&(n+="?"!==t.charAt(0)?"?"+t:t),this.hash&&(n+=this.hash),n}URL.prototype={set:set$4,toString:toString$2},URL.extractProtocol=extractProtocol,URL.location=lolcation,URL.qs=querystringify_1;var urlParse=URL;function thisBtoa$1(e){return bufferFrom_1(e,"binary").toString("base64")}var PouchPromise$1="function"==typeof Promise?Promise:lib;function mangle$1(e){return"$"+e}function unmangle$1(e){return e.substring(1)}function Map$1$2(){this._store={}}function Set$1$2(e){if(this._store=new Map$1$2,e&&Array.isArray(e))for(var t=0,r=e.length;t<r;t++)this.add(e[t])}function PouchError$1(e,t,r){Error.call(this,r),this.status=e,this.name=t,this.message=r,this.error=!0}Map$1$2.prototype.get=function(e){var t=mangle$1(e);return this._store[t]},Map$1$2.prototype.set=function(e,t){var r=mangle$1(e);return this._store[r]=t,!0},Map$1$2.prototype.has=function(e){return mangle$1(e)in this._store},Map$1$2.prototype.delete=function(e){var t=mangle$1(e),r=t in this._store;return delete this._store[t],r},Map$1$2.prototype.forEach=function(e){for(var t=Object.keys(this._store),r=0,n=t.length;r<n;r++){var i=t[r];e(this._store[i],i=unmangle$1(i))}},Object.defineProperty(Map$1$2.prototype,"size",{get:function(){return Object.keys(this._store).length}}),Set$1$2.prototype.add=function(e){return this._store.set(e,!0)},Set$1$2.prototype.has=function(e){return this._store.has(e)},Set$1$2.prototype.forEach=function(e){this._store.forEach(function(t,r){e(r)})},Object.defineProperty(Set$1$2.prototype,"size",{get:function(){return this._store.size}}),inherits(PouchError$1,Error),PouchError$1.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var UNAUTHORIZED$1=new PouchError$1(401,"unauthorized","Name or password is incorrect."),MISSING_BULK_DOCS$1=new PouchError$1(400,"bad_request","Missing JSON list of 'docs'"),MISSING_DOC$1=new PouchError$1(404,"not_found","missing"),REV_CONFLICT$1=new PouchError$1(409,"conflict","Document update conflict"),INVALID_ID$1=new PouchError$1(400,"bad_request","_id field must contain a string"),MISSING_ID$1=new PouchError$1(412,"missing_id","_id is required for puts"),RESERVED_ID$1=new PouchError$1(400,"bad_request","Only reserved document ids may start with underscore."),NOT_OPEN$1=new PouchError$1(412,"precondition_failed","Database not open"),UNKNOWN_ERROR$1=new PouchError$1(500,"unknown_error","Database encountered an unknown error"),BAD_ARG$1=new PouchError$1(500,"badarg","Some query argument is invalid"),INVALID_REQUEST$1=new PouchError$1(400,"invalid_request","Request was invalid"),QUERY_PARSE_ERROR$1=new PouchError$1(400,"query_parse_error","Some query parameter is invalid"),DOC_VALIDATION$1=new PouchError$1(500,"doc_validation","Bad special document member"),BAD_REQUEST$1=new PouchError$1(400,"bad_request","Something wrong with the request"),NOT_AN_OBJECT$1=new PouchError$1(400,"bad_request","Document must be a JSON object"),DB_MISSING$1=new PouchError$1(404,"not_found","Database not found"),IDB_ERROR$1=new PouchError$1(500,"indexed_db_went_bad","unknown"),WSQ_ERROR$1=new PouchError$1(500,"web_sql_went_bad","unknown"),LDB_ERROR$1=new PouchError$1(500,"levelDB_went_went_bad","unknown"),FORBIDDEN$1=new PouchError$1(403,"forbidden","Forbidden by design doc validate_doc_update function"),INVALID_REV$1=new PouchError$1(400,"bad_request","Invalid rev format"),FILE_EXISTS$1=new PouchError$1(412,"file_exists","The database could not be created, the file already exists."),MISSING_STUB$1=new PouchError$1(412,"missing_stub","A pre-existing attachment stub wasn't found"),INVALID_URL$1=new PouchError$1(413,"invalid_url","Provided URL is invalid");function generateErrorFromResponse$1(e){if("object"!=typeof e){var t=e;(e=UNKNOWN_ERROR$1).data=t}return"error"in e&&"conflict"===e.error&&(e.name="conflict",e.status=409),"name"in e||(e.name=e.error||"unknown"),"status"in e||(e.status=500),"message"in e||(e.message=e.message||e.reason),e}function isBinaryObject$1(e){return e instanceof Buffer}var funcToString$1=Function.prototype.toString,objectCtorString$1=funcToString$1.call(Object),assign$1;function isPlainObject$1(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=t.constructor;return"function"==typeof r&&r instanceof r&&funcToString$1.call(r)==objectCtorString$1}function clone$1(e){var t,r,n;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],r=0,n=e.length;r<n;r++)t[r]=clone$1(e[r]);return t}if(e instanceof Date)return e.toISOString();if(isBinaryObject$1(e))return cloneBuffer_1(e);if(!isPlainObject$1(e))return e;t={};for(r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=clone$1(e[r]);void 0!==i&&(t[r]=i)}return t}function once$2(e){var t=!1;return argsarray(function(r){if(t)throw new Error("once called more than once");t=!0,e.apply(this,r)})}function toPromise$1(e){return argsarray(function(t){var r=this,n="function"==typeof(t=clone$1(t))[t.length-1]&&t.pop(),i=new PouchPromise$1(function(n,i){var o;try{var a=once$2(function(e,t){e?i(e):n(t)});t.push(a),(o=e.apply(r,t))&&"function"==typeof o.then&&n(o)}catch(e){i(e)}});return n&&i.then(function(e){n(null,e)},n),i})}function pick$1(e,t){for(var r={},n=0,i=t.length;n<i;n++){var o=t[n];o in e&&(r[o]=e[o])}return r}function isChromeApp$1(){return!1}function hasLocalStorage$1(){return!1}function nextTick$3(e){process.nextTick(e)}function attachBrowserEvents$1(e){isChromeApp$1()?chrome.storage.onChanged.addListener(function(t){null!=t.db_name&&e.emit(t.dbName.newValue)}):hasLocalStorage$1()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(t){e.emit(t.key)}):window.attachEvent("storage",function(t){e.emit(t.key)}))}function Changes$1(){EventEmitter.call(this),this._listeners={},attachBrowserEvents$1(this)}inherits(Changes$1,EventEmitter),Changes$1.prototype.addListener=function(e,t,r,n){if(!this._listeners[t]){var i=this,o=!1;this._listeners[t]=a,this.on(e,a)}function a(){if(i._listeners[t])if(o)o="waiting";else{o=!0;var e=pick$1(n,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);r.changes(e).on("change",function(e){e.seq>n.since&&!n.cancelled&&(n.since=e.seq,n.onChange(e))}).on("complete",function(){"waiting"===o&&nextTick$3(a),o=!1}).on("error",function(){o=!1})}}},Changes$1.prototype.removeListener=function(e,t){t in this._listeners&&(EventEmitter.prototype.removeListener.call(this,e,this._listeners[t]),delete this._listeners[t])},Changes$1.prototype.notifyLocalWindows=function(e){isChromeApp$1()?chrome.storage.local.set({dbName:e}):hasLocalStorage$1()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},Changes$1.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)},assign$1="function"==typeof Object.assign?Object.assign:function(e){for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};var assign$1$1=assign$1,request$2=require("request").defaults({jar:!0});function applyTypeToBuffer$1(e,t){e.type=t.headers["content-type"]}function defaultBody$1(){return bufferFrom_1("","binary")}function ajaxCore(e,t){e=clone$1(e);return(e=assign$1$1({method:"GET",headers:{},json:!0,processData:!0,timeout:1e4,cache:!1},e)).json&&(e.binary||(e.headers.Accept="application/json"),e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json"),e.binary&&(e.encoding=null,e.json=!1),e.processData||(e.json=!1),request$2(e,function(r,n,i){if(r)return t(generateErrorFromResponse$1(r));var o,a=n.headers&&n.headers["content-type"],s=i||defaultBody$1();if(!e.binary&&(e.json||!e.processData)&&"object"!=typeof s&&(/json/.test(a)||/^[\s]*\{/.test(s)&&/\}[\s]*$/.test(s)))try{s=JSON.parse(s.toString())}catch(e){}n.statusCode>=200&&n.statusCode<300?function(t,r,n){if(!e.binary&&e.json&&"string"==typeof t)try{t=JSON.parse(t)}catch(e){return n(e)}Array.isArray(t)&&(t=t.map(function(e){return e.error||e.missing?generateErrorFromResponse$1(e):e})),e.binary&&applyTypeToBuffer$1(t,r),n(null,t,r)}(s,n,t):((o=generateErrorFromResponse$1(s)).status=n.statusCode,t(o))})}function ajax$1(e,t){return ajaxCore(e,t)}function getBaseUrl(e){return"function"==typeof e.getUrl?urlParse(e.getUrl()).origin:e.__opts&&e.__opts.prefix?e.__opts.prefix:urlParse(e.name).origin}function getConfigUrl(e,t){return urlJoin(getBaseUrl(e),(t?"/_node/"+t:"")+"/_config")}function getUsersUrl(e){return urlJoin(getBaseUrl(e),"/_users")}function getSessionUrl(e){return urlJoin(getBaseUrl(e),"/_session")}function getBasicAuthHeaders(e){var t=urlParse(e.name);if(!t.auth)return{};var r=t.username+":"+t.password;return{Authorization:"Basic "+thisBtoa$1(unescape(encodeURIComponent(r)))}}function wrapError(e){return function(t,r){return t&&"unknown_error"===t.name&&(t.message=(t.message||"")+" Unknown error!  Did you remember to enable CORS?"),e(t,r)}}function AuthError(e){this.status=400,this.name="authentication_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,AuthError)}catch(e){}}inherits(AuthError,Error);var getMembership=toPromise$1(function(e,t){void 0===t&&(t=e,e={});var r=getBaseUrl(this)+"/_membership";ajax$1(assign$1$1({method:"GET",url:r,headers:getBasicAuthHeaders(this)},e.ajax||{}),wrapError(t))}),signUpAdmin=toPromise$1(function(e,t,r,n){var i=this;return void 0===n&&(n=void 0===r?void 0===t?e:t:r,r={}),-1===["http","https"].indexOf(i.type())?n(new AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.')):e?t?void i.getMembership(r,function(o,a){var s;if(o){if("illegal_database_name"!==o.error)return n(o);s=void 0}else s=a.all_nodes[0];var u=getConfigUrl(i,s),c=(r.configUrl||u)+"/admins/"+encodeURIComponent(e);ajax$1(assign$1$1({method:"PUT",url:c,processData:!1,headers:getBasicAuthHeaders(i),body:'"'+t+'"'},r.ajax||{}),wrapError(n))}):n(new AuthError("You must provide a password")):n(new AuthError("You must provide a username"))}),deleteAdmin=toPromise$1(function(e,t,r){var n=this;return void 0===r&&(r=void 0===t?e:t,t={}),-1===["http","https"].indexOf(n.type())?r(new AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.')):e?void n.getMembership(t,function(i,o){var a;if(i){if("illegal_database_name"!==i.error)return r(i);a=void 0}else a=o.all_nodes[0];var s=getConfigUrl(n,a),u=(t.configUrl||s)+"/admins/"+encodeURIComponent(e);ajax$1(assign$1$1({method:"DELETE",url:u,processData:!1,headers:getBasicAuthHeaders(n)},t.ajax||{}),wrapError(r))}):r(new AuthError("You must provide a username"))}),logIn=toPromise$1(function(e,t,r,n){return void 0===n&&(n=r,r={}),-1===["http","https"].indexOf(this.type())?n(new AuthError("this plugin only works for the http/https adapter")):e?t?void ajax$1(assign$1$1({method:"POST",url:getSessionUrl(this),headers:assign$1$1({"Content-Type":"application/json"},getBasicAuthHeaders(this)),body:{name:e,password:t}},r.ajax||{}),wrapError(n)):n(new AuthError("you must provide a password")):n(new AuthError("you must provide a username"))}),logOut=toPromise$1(function(e,t){void 0===t&&(t=e,e={}),ajax$1(assign$1$1({method:"DELETE",url:getSessionUrl(this),headers:getBasicAuthHeaders(this)},e.ajax||{}),wrapError(t))}),getSession=toPromise$1(function(e,t){void 0===t&&(t=e,e={});var r=getSessionUrl(this);ajax$1(assign$1$1({method:"GET",url:r,headers:getBasicAuthHeaders(this)},e.ajax||{}),wrapError(t))}),getUsersDatabaseUrl=function(){return getUsersUrl(this)};function updateUser(e,t,r,n){var i=["_id","_rev","name","type","roles","password","password_scheme","iterations","derived_key","salt"];if(r.metadata){for(var o in r.metadata)if(r.metadata.hasOwnProperty(o)&&-1!==i.indexOf(o))return n(new AuthError('cannot use reserved word in metadata: "'+o+'"'));t=assign$1$1(t,r.metadata)}r.roles&&(t=assign$1$1(t,{roles:r.roles}));var a=getUsersUrl(e)+"/"+encodeURIComponent(t._id);ajax$1(assign$1$1({method:"PUT",url:a,body:t,headers:getBasicAuthHeaders(e)},r.ajax||{}),wrapError(n))}var signUp=toPromise$1(function(e,t,r,n){return void 0===n&&(n=void 0===r?void 0===t?e:t:r,r={}),-1===["http","https"].indexOf(this.type())?n(new AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.')):e?t?void updateUser(this,{name:e,password:t,roles:[],type:"user",_id:"org.couchdb.user:"+e},r,n):n(new AuthError("You must provide a password")):n(new AuthError("You must provide a username"))}),getUser=toPromise$1(function(e,t,r){if(void 0===r&&(r=void 0===t?e:t,t={}),!e)return r(new AuthError("you must provide a username"));var n=getUsersUrl(this);ajax$1(assign$1$1({method:"GET",url:n+"/"+encodeURIComponent("org.couchdb.user:"+e),headers:getBasicAuthHeaders(this)},t.ajax||{}),wrapError(r))}),putUser=toPromise$1(function(e,t,r){var n=this;return void 0===r&&(r=void 0===t?e:t,t={}),-1===["http","https"].indexOf(n.type())?r(new AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.')):e?void n.getUser(e,t,function(e,i){if(e)return r(e);updateUser(n,i,t,r)}):r(new AuthError("You must provide a username"))}),deleteUser=toPromise$1(function(e,t,r){var n=this;return void 0===r&&(r=void 0===t?e:t,t={}),-1===["http","https"].indexOf(n.type())?r(new AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.')):e?void n.getUser(e,t,function(e,i){if(e)return r(e);var o=getUsersUrl(n)+"/"+encodeURIComponent(i._id)+"?rev="+i._rev;ajax$1(assign$1$1({method:"DELETE",url:o,headers:getBasicAuthHeaders(n)},t.ajax||{}),wrapError(r))}):r(new AuthError("You must provide a username"))}),changePassword=toPromise$1(function(e,t,r,n){var i=this;return void 0===n&&(n=void 0===r?void 0===t?e:t:r,r={}),-1===["http","https"].indexOf(i.type())?n(new AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.')):e?t?void i.getUser(e,r,function(e,o){if(e)return n(e);o.password=t;var a=getUsersUrl(i)+"/"+encodeURIComponent(o._id);ajax$1(assign$1$1({method:"PUT",url:a,headers:getBasicAuthHeaders(i),body:o},r.ajax||{}),wrapError(n))}):n(new AuthError("You must provide a password")):n(new AuthError("You must provide a username"))}),changeUsername=toPromise$1(function(e,t,r,n){var i=this,o=function(e,t){var r,n=getUsersUrl(i)+"/"+encodeURIComponent(e._id),o=assign$1$1({method:"PUT",url:n,headers:getBasicAuthHeaders(i),body:e},t.ajax);return r=o,new PouchPromise$1(function(e,t){ajax$1(r,wrapError(function(r,n){if(r)return t(r);e(n)}))})};return void 0===n&&(n=r,r={}),r.ajax=r.ajax||{},-1===["http","https"].indexOf(i.type())?n(new AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.')):t?e?void i.getUser(t,r).then(function(){var e=new AuthError("user already exists");throw e.taken=!0,e},function(){return i.getUser(e,r)}).then(function(e){var n=clone$1(e);return delete n._rev,n._id="org.couchdb.user:"+t,n.name=t,n.roles=r.roles||e.roles||{},o(n,r).then(function(){return e._deleted=!0,o(e,r)})}).then(function(e){n(null,e)}).catch(n):n(new AuthError("You must provide a username to rename")):n(new AuthError("You must provide a new username"))}),plugin={};plugin.login=logIn,plugin.logIn=logIn,plugin.logout=logOut,plugin.logOut=logOut,plugin.getSession=getSession,plugin.getMembership=getMembership,plugin.signUpAdmin=signUpAdmin,plugin.deleteAdmin=deleteAdmin,plugin.getUsersDatabaseUrl=getUsersDatabaseUrl,plugin.signup=signUp,plugin.signUp=signUp,plugin.getUser=getUser,plugin.putUser=putUser,plugin.deleteUser=deleteUser,plugin.changePassword=changePassword,plugin.changeUsername=changeUsername,"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(plugin),console.log(PouchDB$5),PouchDB$5.plugin(plugin);class AbstractClass{requireProperties(e){e.forEach(e=>{if(void 0===this[e])throw new TypeError(e+" is undefined for class "+this.constructor.name)})}}class Model extends AbstractClass{constructor(){super(),this.eventHandlers={}}on(e,t,r){this.eventHandlers[e]||(this.eventHandlers[e]=[]),(r||-1===this.eventHandlers[e].indexOf(t))&&this.eventHandlers[e].push(t)}off(e,t){if(this.eventHandlers[e])if(t){let r=this.eventHandlers[e].indexOf(t);r>=0&&this.eventHandlers[e].splice(r,1)}else delete this.eventHandlers[e]}trigger(){let e=arguments[0],t=Array.prototype.slice.call(arguments,1);this.eventHandlers[e]&&this.eventHandlers[e].forEach(e=>{window.setTimeout(()=>{e.apply(this,t)},0)})}}var appList=[{name:"docs",description:"The core app / landing page for Mure",author:"Alex Bigelow",icon:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIxLjAuMiwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MTIgNTEyOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+Cgkuc3Qwe2ZpbGw6I0U2QUIwMjt9Cgkuc3Qxe29wYWNpdHk6MC4zO2ZpbGw6Izc1NzBCMztlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgO30KCS5zdDJ7b3BhY2l0eTowLjQ1O2ZpbGw6I0U2QUIwMjtlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgO30KCS5zdDN7b3BhY2l0eTowLjU1O2ZpbGw6Izc1NzBCMztlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgO30KCS5zdDR7b3BhY2l0eTowLjI7ZmlsbDojRTZBQjAyO2VuYWJsZS1iYWNrZ3JvdW5kOm5ldyAgICA7fQoJLnN0NXtmaWxsOiM3NTcwQjM7fQo8L3N0eWxlPgo8cG9seWdvbiBjbGFzcz0ic3QwIiBwb2ludHM9IjMzOS4zLDQwNy4zIDI1Niw1MDYgMTcyLjcsNDA3LjMgIi8+Cjxwb2x5Z29uIGNsYXNzPSJzdDEiIHBvaW50cz0iMjE0LjEsMzcyLjIgMjk3LjUsMjczLjUgMzgwLjgsMzcyLjIgIi8+Cjxwb2x5Z29uIGNsYXNzPSJzdDIiIHBvaW50cz0iNTA2LDI3My41IDQyMi43LDM3Mi4yIDMzOS4zLDI3My41ICIvPgo8cG9seWdvbiBjbGFzcz0ic3QzIiBwb2ludHM9IjI1NiwyMzguNSAzMzkuMywxMzkuOCA0MjIuNywyMzguNSAiLz4KPHBvbHlnb24gY2xhc3M9InN0MiIgcG9pbnRzPSIyNTYsMjczLjUgMTcyLjcsMzcyLjIgODkuMywyNzMuNSAiLz4KPHBvbHlnb24gY2xhc3M9InN0MyIgcG9pbnRzPSI2LDIzOC41IDg5LjMsMTM5LjggMTcyLjcsMjM4LjUgIi8+Cjxwb2x5Z29uIGNsYXNzPSJzdDQiIHBvaW50cz0iMjk3LjUsMTM5LjggMjE0LjEsMjM4LjUgMTMwLjgsMTM5LjggIi8+Cjxwb2x5Z29uIGNsYXNzPSJzdDUiIHBvaW50cz0iMTcyLjcsMTA0LjcgMjU2LDYgMzM5LjMsMTA0LjcgIi8+Cjwvc3ZnPgo="},{name:"data-binder",description:"A Mure app that is responsible for (re)binding data to graphics",author:"Alex Bigelow",icon:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIxLjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MTIgNTEyOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+Cgkuc3Qwe29wYWNpdHk6MC42O2ZpbGw6I0U2QUIwMjt9Cgkuc3Qxe29wYWNpdHk6MC4zO2ZpbGw6I0U2QUIwMjt9Cgkuc3Qye29wYWNpdHk6MC42O2ZpbGw6Izc1NzBCMzt9Cgkuc3Qze2ZpbGw6Izc1NzBCMzt9Cgkuc3Q0e29wYWNpdHk6MC4zO2ZpbGw6Izc1NzBCMzt9Cgkuc3Q1e2ZpbGw6I0U2QUIwMjt9Cjwvc3R5bGU+CjxnPgoJPHBhdGggY2xhc3M9InN0MCIgZD0iTTExOS43LDI2Ny43di0yMy40YzU5LjYsMCw3Ny4zLTE5LjcsODMuMi0yNi4xYzE0LjEtMTUuNywxOS0zNy40LDI0LjItNjAuNGM1LjQtMjQsMTEtNDguOSwyNy45LTY4LjMKCQlDMjc0LjEsNjcuNiwzMDQuNiw1NywzNDguMyw1N3YyMy40Yy0zNi41LDAtNjEuMyw4LTc1LjgsMjQuNWMtMTMsMTQuOS0xNy43LDM1LjgtMjIuNyw1OGMtNS42LDI0LjktMTEuNCw1MC42LTI5LjYsNzAuOQoJCUMxOTkuNywyNTYuNiwxNjYuOCwyNjcuNywxMTkuNywyNjcuN3oiLz4KCTxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0xMTkuNyw0NTV2LTIzLjRjMzQuNCwwLDk0LjMtNDAuMiwxNjQuNC0xMTAuM2wxNi42LDE2LjZDMjQ3LjEsMzkxLjMsMTcyLjQsNDU1LDExOS43LDQ1NXoiLz4KCTxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik03LjUsMjk5LjVjMzIuNy0yNi43LDU2LjYtNDcuMiw1Ni42LTYzLjhjMC0xMS03LTE2LjItMTcuOC0xNi4yYy05LjEsMC0xNi4yLDUuOC0yMi44LDExLjZMNiwyMTMuMwoJCWMxMy4zLTEzLjUsMjUuNy0xOS43LDQ1LTE5LjdjMjYuMywwLDQ0LjcsMTUuOSw0NC43LDQwLjJjMCwxOS43LTIwLjUsNDEuNC00MC42LDU4LjRjNi44LTAuOCwxNi0xLjUsMjItMS41aDI0Ljd2MjcuOEg3LjVWMjk5LjV6IgoJCS8+Cgk8cGF0aCBjbGFzcz0ic3QzIiBkPSJNOC4yLDEwMy45SDM5VjM5LjNIMTMuNFYxOC41YzE1LTIuOCwyNC44LTYuMywzNC43LTEyLjJoMjQuOHY5Ny43aDI2Ljh2MjcuMkg4LjJWMTAzLjl6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNi41LDQ4OC43bDE0LjgtMjAuNWM4LDYuOCwxOC4yLDExLjQsMjcuMywxMS40YzExLjgsMCwyMC4xLTMuOCwyMC4xLTExLjRjMC05LjEtNi42LTE0LjQtMzMuNC0xNC40VjQzMQoJCWMyMS42LDAsMjkuNi01LjMsMjkuNi0xMy43YzAtNy4yLTUuNy0xMS0xNS4yLTExYy04LjcsMC0xNS42LDMuNC0yMy45LDkuOUw5LjUsMzk2LjRjMTIuMy05LjksMjYuMi0xNS42LDQxLjgtMTUuNgoJCWMyNy43LDAsNDYuMywxMi4xLDQ2LjMsMzRjMCwxMS42LTcuOCwyMC4zLTIyLDI2djAuOGMxNC44LDQuMiwyNS44LDEzLjcsMjUuOCwyOC44YzAsMjIuOC0yMy4zLDM1LjMtNDkuMywzNS4zCgkJQzMxLjUsNTA1LjgsMTYsNDk5LjMsNi41LDQ4OC43eiIvPgoJPHJlY3QgeD0iMzA1LjQiIHk9IjE5MS42IiBjbGFzcz0ic3Q0IiB3aWR0aD0iMTI0LjkiIGhlaWdodD0iMTI0LjkiLz4KCTxjaXJjbGUgY2xhc3M9InN0MiIgY3g9IjQzNy43IiBjeT0iNzQuNSIgcj0iNjguMyIvPgoJPHBvbHlnb24gY2xhc3M9InN0MyIgcG9pbnRzPSI0MjcuMSwzNjkuMiAzNDguMyw1MDUuOCA1MDYsNTA1LjggCSIvPgoJPHBhdGggY2xhc3M9InN0NSIgZD0iTTM1My45LDQ0OS4yYy0zNC42LDAtNjUtNC41LTkwLjMtMTMuM2MtMjMuOC04LjMtNDMuOS0yMC43LTU5LjgtMzYuOGMtNTMtNTMuNy01MS44LTE0MC01MC45LTIwOS4zCgkJYzAuNi00NC44LDEuMi04Ny4yLTE0LTEwMi41Yy00LjYtNC43LTEwLjctNi44LTE5LjItNi44VjU3YzE0LjgsMCwyNi45LDQuNiwzNS45LDEzLjhjMjIsMjIuMywyMS40LDY3LjMsMjAuNywxMTkuMwoJCWMtMC45LDY4LjMtMiwxNDUuNyw0NC4yLDE5Mi41YzI4LjcsMjkuMSw3Mi4zLDQzLjIsMTMzLjUsNDMuMlY0NDkuMnoiLz4KPC9nPgo8L3N2Zz4K"},{name:"encoding-manager",description:"A Mure app that is responsible for learning / applying data constraints to graphics",author:"Alex Bigelow",icon:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIxLjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSI1MTJweCIgaGVpZ2h0PSI1MTJweCIgdmlld0JveD0iMCAwIDUxMiA1MTIiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDUxMiA1MTI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojNzU3MEIzO30KCS5zdDF7ZmlsbDojRTZBQjAyO30KCS5zdDJ7b3BhY2l0eTowLjE7ZmlsbDojRTZBQjAyO2VuYWJsZS1iYWNrZ3JvdW5kOm5ldyAgICA7fQoJLnN0M3tvcGFjaXR5OjAuOTtmaWxsOiNFNkFCMDI7ZW5hYmxlLWJhY2tncm91bmQ6bmV3ICAgIDt9Cgkuc3Q0e29wYWNpdHk6MC4yO2ZpbGw6I0U2QUIwMjtlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgO30KCS5zdDV7b3BhY2l0eTowLjg7ZmlsbDojRTZBQjAyO2VuYWJsZS1iYWNrZ3JvdW5kOm5ldyAgICA7fQoJLnN0NntvcGFjaXR5OjAuMztmaWxsOiNFNkFCMDI7ZW5hYmxlLWJhY2tncm91bmQ6bmV3ICAgIDt9Cgkuc3Q3e29wYWNpdHk6MC43O2ZpbGw6I0U2QUIwMjtlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgO30KCS5zdDh7b3BhY2l0eTowLjQ7ZmlsbDojRTZBQjAyO2VuYWJsZS1iYWNrZ3JvdW5kOm5ldyAgICA7fQoJLnN0OXtvcGFjaXR5OjAuNjtmaWxsOiNFNkFCMDI7ZW5hYmxlLWJhY2tncm91bmQ6bmV3ICAgIDt9Cgkuc3QxMHtvcGFjaXR5OjAuNTtmaWxsOiNFNkFCMDI7ZW5hYmxlLWJhY2tncm91bmQ6bmV3ICAgIDt9Cjwvc3R5bGU+Cjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iMjczLjksMzgxIDI3My45LDM0OS44IDE2NC41LDM0OS44IDE2NC41LDI3MS42IDIyMC4zLDI3MS42IDIyMC4zLDI0MC40IDE2NC41LDI0MC40IDE2NC41LDE2Mi4yIAoJMjIwLjMsMTYyLjIgMjIwLjMsMTMxIDE2NC41LDEzMSAxNjQuNSw1Mi45IDIyMC4zLDUyLjkgMjIwLjMsMjEuNiAxNjQuNSwyMS42IDE2NC41LDYgMTMzLjIsNiAxMzMuMiwyMS42IDc3LjQsMjEuNiA3Ny40LDUyLjkgCgkxMzMuMiw1Mi45IDEzMy4yLDEzMSA3Ny40LDEzMSA3Ny40LDE2Mi4yIDEzMy4yLDE2Mi4yIDEzMy4yLDI0MC40IDc3LjQsMjQwLjQgNzcuNCwyNzEuNiAxMzMuMiwyNzEuNiAxMzMuMiwzNDkuOCAyMy45LDM0OS44IAoJMjMuOSwzODEgMTMzLjIsMzgxIDEzMy4yLDQ1OS4xIDc3LjQsNDU5LjEgNzcuNCw0OTAuNCAxMzMuMiw0OTAuNCAxMzMuMiw1MDYgMTY0LjUsNTA2IDE2NC41LDQ5MC40IDIyMC4zLDQ5MC40IDIyMC4zLDQ1OS4xIAoJMTY0LjUsNDU5LjEgMTY0LjUsMzgxICIvPgo8cmVjdCB4PSIzMDkuNiIgeT0iNiIgY2xhc3M9InN0MSIgd2lkdGg9IjcxLjQiIGhlaWdodD0iNzEuNCIvPgo8cmVjdCB4PSI0MTYuNyIgeT0iNiIgY2xhc3M9InN0MiIgd2lkdGg9IjcxLjQiIGhlaWdodD0iNzEuNCIvPgo8cmVjdCB4PSIzMDkuNiIgeT0iMTEzLjEiIGNsYXNzPSJzdDMiIHdpZHRoPSI3MS40IiBoZWlnaHQ9IjcxLjQiLz4KPHJlY3QgeD0iNDE2LjciIHk9IjExMy4xIiBjbGFzcz0ic3Q0IiB3aWR0aD0iNzEuNCIgaGVpZ2h0PSI3MS40Ii8+CjxyZWN0IHg9IjMwOS42IiB5PSIyMjAuMyIgY2xhc3M9InN0NSIgd2lkdGg9IjcxLjQiIGhlaWdodD0iNzEuNCIvPgo8cmVjdCB4PSI0MTYuNyIgeT0iMjIwLjMiIGNsYXNzPSJzdDYiIHdpZHRoPSI3MS40IiBoZWlnaHQ9IjcxLjQiLz4KPHJlY3QgeD0iMzA5LjYiIHk9IjMyNy40IiBjbGFzcz0ic3Q3IiB3aWR0aD0iNzEuNCIgaGVpZ2h0PSI3MS40Ii8+CjxyZWN0IHg9IjQxNi43IiB5PSIzMjcuNCIgY2xhc3M9InN0OCIgd2lkdGg9IjcxLjQiIGhlaWdodD0iNzEuNCIvPgo8cmVjdCB4PSIzMDkuNiIgeT0iNDM0LjYiIGNsYXNzPSJzdDkiIHdpZHRoPSI3MS40IiBoZWlnaHQ9IjcxLjQiLz4KPHJlY3QgeD0iNDE2LjciIHk9IjQzNC42IiBjbGFzcz0ic3QxMCIgd2lkdGg9IjcxLjQiIGhlaWdodD0iNzEuNCIvPgo8L3N2Zz4K"}],sax=createCommonjsModule(function(e,t){!function(e){e.parser=function(e,t){return new n(e,t)},e.SAXParser=n,e.SAXStream=o,e.createStream=function(e,t){return new o(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function n(t,i){if(!(this instanceof n))return new n(t,i);!function(e){for(var t=0,n=r.length;t<n;t++)e[r[t]]=""}(this),this.q=this.c="",this.bufferCheckPosition=e.MAX_BUFFER_LENGTH,this.opt=i||{},this.opt.lowercase=this.opt.lowercase||this.opt.lowercasetags,this.looseCase=this.opt.lowercase?"toLowerCase":"toUpperCase",this.tags=[],this.closed=this.closedRoot=this.sawRoot=!1,this.tag=this.error=null,this.strict=!!t,this.noscript=!(!t&&!this.opt.noscript),this.state=w.BEGIN,this.strictEntities=this.opt.strictEntities,this.ENTITIES=this.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),this.attribList=[],this.opt.xmlns&&(this.ns=Object.create(l)),this.trackPosition=!1!==this.opt.position,this.trackPosition&&(this.position=this.line=this.column=0),$(this,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}),n.prototype={end:function(){k(this)},write:function(t){if(this.error)throw this.error;if(this.closed)return C(this,"Cannot write after close. Assign an onready handler.");if(null===t)return k(this);"object"==typeof t&&(t=t.toString());var n=0,i="";for(;i=B(t,n++),this.c=i,i;)switch(this.trackPosition&&(this.position++,"\n"===i?(this.line++,this.column=0):this.column++),this.state){case w.BEGIN:if(this.state=w.BEGIN_WHITESPACE,"\ufeff"===i)continue;R(this,i);continue;case w.BEGIN_WHITESPACE:R(this,i);continue;case w.TEXT:if(this.sawRoot&&!this.closedRoot){for(var o=n-1;i&&"<"!==i&&"&"!==i;)(i=B(t,n++))&&this.trackPosition&&(this.position++,"\n"===i?(this.line++,this.column=0):this.column++);this.textNode+=t.substring(o,n-1)}"<"!==i||this.sawRoot&&this.closedRoot&&!this.strict?(m(i)||this.sawRoot&&!this.closedRoot||N(this,"Text data outside of root node."),"&"===i?this.state=w.TEXT_ENTITY:this.textNode+=i):(this.state=w.OPEN_WAKA,this.startTagPosition=this.position);continue;case w.SCRIPT:"<"===i?this.state=w.SCRIPT_ENDING:this.script+=i;continue;case w.SCRIPT_ENDING:"/"===i?this.state=w.CLOSE_TAG:(this.script+="<"+i,this.state=w.SCRIPT);continue;case w.OPEN_WAKA:if("!"===i)this.state=w.SGML_DECL,this.sgmlDecl="";else if(m(i));else if(y(f,i))this.state=w.OPEN_TAG,this.tagName=i;else if("/"===i)this.state=w.CLOSE_TAG,this.tagName="";else if("?"===i)this.state=w.PROC_INST,this.procInstName=this.procInstBody="";else{if(N(this,"Unencoded <"),this.startTagPosition+1<this.position){var u=this.position-this.startTagPosition;i=new Array(u).join(" ")+i}this.textNode+="<"+i,this.state=w.TEXT}continue;case w.SGML_DECL:(this.sgmlDecl+i).toUpperCase()===a?(S(this,"onopencdata"),this.state=w.CDATA,this.sgmlDecl="",this.cdata=""):this.sgmlDecl+i==="--"?(this.state=w.COMMENT,this.comment="",this.sgmlDecl=""):(this.sgmlDecl+i).toUpperCase()===s?(this.state=w.DOCTYPE,(this.doctype||this.sawRoot)&&N(this,"Inappropriately located doctype declaration"),this.doctype="",this.sgmlDecl=""):">"===i?(S(this,"onsgmldeclaration",this.sgmlDecl),this.sgmlDecl="",this.state=w.TEXT):g(i)?(this.state=w.SGML_DECL_QUOTED,this.sgmlDecl+=i):this.sgmlDecl+=i;continue;case w.SGML_DECL_QUOTED:i===this.q&&(this.state=w.SGML_DECL,this.q=""),this.sgmlDecl+=i;continue;case w.DOCTYPE:">"===i?(this.state=w.TEXT,S(this,"ondoctype",this.doctype),this.doctype=!0):(this.doctype+=i,"["===i?this.state=w.DOCTYPE_DTD:g(i)&&(this.state=w.DOCTYPE_QUOTED,this.q=i));continue;case w.DOCTYPE_QUOTED:this.doctype+=i,i===this.q&&(this.q="",this.state=w.DOCTYPE);continue;case w.DOCTYPE_DTD:this.doctype+=i,"]"===i?this.state=w.DOCTYPE:g(i)&&(this.state=w.DOCTYPE_DTD_QUOTED,this.q=i);continue;case w.DOCTYPE_DTD_QUOTED:this.doctype+=i,i===this.q&&(this.state=w.DOCTYPE_DTD,this.q="");continue;case w.COMMENT:"-"===i?this.state=w.COMMENT_ENDING:this.comment+=i;continue;case w.COMMENT_ENDING:"-"===i?(this.state=w.COMMENT_ENDED,this.comment=x(this.opt,this.comment),this.comment&&S(this,"oncomment",this.comment),this.comment=""):(this.comment+="-"+i,this.state=w.COMMENT);continue;case w.COMMENT_ENDED:">"!==i?(N(this,"Malformed comment"),this.comment+="--"+i,this.state=w.COMMENT):this.state=w.TEXT;continue;case w.CDATA:"]"===i?this.state=w.CDATA_ENDING:this.cdata+=i;continue;case w.CDATA_ENDING:"]"===i?this.state=w.CDATA_ENDING_2:(this.cdata+="]"+i,this.state=w.CDATA);continue;case w.CDATA_ENDING_2:">"===i?(this.cdata&&S(this,"oncdata",this.cdata),S(this,"onclosecdata"),this.cdata="",this.state=w.TEXT):"]"===i?this.cdata+="]":(this.cdata+="]]"+i,this.state=w.CDATA);continue;case w.PROC_INST:"?"===i?this.state=w.PROC_INST_ENDING:m(i)?this.state=w.PROC_INST_BODY:this.procInstName+=i;continue;case w.PROC_INST_BODY:if(!this.procInstBody&&m(i))continue;"?"===i?this.state=w.PROC_INST_ENDING:this.procInstBody+=i;continue;case w.PROC_INST_ENDING:">"===i?(S(this,"onprocessinginstruction",{name:this.procInstName,body:this.procInstBody}),this.procInstName=this.procInstBody="",this.state=w.TEXT):(this.procInstBody+="?"+i,this.state=w.PROC_INST_BODY);continue;case w.OPEN_TAG:y(d,i)?this.tagName+=i:(D(this),">"===i?O(this):"/"===i?this.state=w.OPEN_TAG_SLASH:(m(i)||N(this,"Invalid character in tag name"),this.state=w.ATTRIB));continue;case w.OPEN_TAG_SLASH:">"===i?(O(this,!0),M(this)):(N(this,"Forward-slash in opening tag not followed by >"),this.state=w.ATTRIB);continue;case w.ATTRIB:if(m(i))continue;">"===i?O(this):"/"===i?this.state=w.OPEN_TAG_SLASH:y(f,i)?(this.attribName=i,this.attribValue="",this.state=w.ATTRIB_NAME):N(this,"Invalid attribute name");continue;case w.ATTRIB_NAME:"="===i?this.state=w.ATTRIB_VALUE:">"===i?(N(this,"Attribute without value"),this.attribValue=this.attribName,A(this),O(this)):m(i)?this.state=w.ATTRIB_NAME_SAW_WHITE:y(d,i)?this.attribName+=i:N(this,"Invalid attribute name");continue;case w.ATTRIB_NAME_SAW_WHITE:if("="===i)this.state=w.ATTRIB_VALUE;else{if(m(i))continue;N(this,"Attribute without value"),this.tag.attributes[this.attribName]="",this.attribValue="",S(this,"onattribute",{name:this.attribName,value:""}),this.attribName="",">"===i?O(this):y(f,i)?(this.attribName=i,this.state=w.ATTRIB_NAME):(N(this,"Invalid attribute name"),this.state=w.ATTRIB)}continue;case w.ATTRIB_VALUE:if(m(i))continue;g(i)?(this.q=i,this.state=w.ATTRIB_VALUE_QUOTED):(N(this,"Unquoted attribute value"),this.state=w.ATTRIB_VALUE_UNQUOTED,this.attribValue=i);continue;case w.ATTRIB_VALUE_QUOTED:if(i!==this.q){"&"===i?this.state=w.ATTRIB_VALUE_ENTITY_Q:this.attribValue+=i;continue}A(this),this.q="",this.state=w.ATTRIB_VALUE_CLOSED;continue;case w.ATTRIB_VALUE_CLOSED:m(i)?this.state=w.ATTRIB:">"===i?O(this):"/"===i?this.state=w.OPEN_TAG_SLASH:y(f,i)?(N(this,"No whitespace between attributes"),this.attribName=i,this.attribValue="",this.state=w.ATTRIB_NAME):N(this,"Invalid attribute name");continue;case w.ATTRIB_VALUE_UNQUOTED:if(">"!==(b=i)&&!m(b)){"&"===i?this.state=w.ATTRIB_VALUE_ENTITY_U:this.attribValue+=i;continue}A(this),">"===i?O(this):this.state=w.ATTRIB;continue;case w.CLOSE_TAG:if(this.tagName)">"===i?M(this):y(d,i)?this.tagName+=i:this.script?(this.script+="</"+this.tagName,this.tagName="",this.state=w.SCRIPT):(m(i)||N(this,"Invalid tagname in closing tag"),this.state=w.CLOSE_TAG_SAW_WHITE);else{if(m(i))continue;y(f,i)?this.tagName=i:this.script?(this.script+="</"+i,this.state=w.SCRIPT):N(this,"Invalid tagname in closing tag.")}continue;case w.CLOSE_TAG_SAW_WHITE:if(m(i))continue;">"===i?M(this):N(this,"Invalid characters in closing tag");continue;case w.TEXT_ENTITY:case w.ATTRIB_VALUE_ENTITY_Q:case w.ATTRIB_VALUE_ENTITY_U:var c,l;switch(this.state){case w.TEXT_ENTITY:c=w.TEXT,l="textNode";break;case w.ATTRIB_VALUE_ENTITY_Q:c=w.ATTRIB_VALUE_QUOTED,l="attribValue";break;case w.ATTRIB_VALUE_ENTITY_U:c=w.ATTRIB_VALUE_UNQUOTED,l="attribValue"}";"===i?(this[l]+=L(this),this.entity="",this.state=c):y(this.entity.length?p:h,i)?this.entity+=i:(N(this,"Invalid character in entity name"),this[l]+="&"+this.entity+i,this.entity="",this.state=c);continue;default:throw new Error(this,"Unknown state: "+this.state)}var b;this.position>=this.bufferCheckPosition&&function(t){for(var n=Math.max(e.MAX_BUFFER_LENGTH,10),i=0,o=0,a=r.length;o<a;o++){var s=t[r[o]].length;if(s>n)switch(r[o]){case"textNode":T(t);break;case"cdata":S(t,"oncdata",t.cdata),t.cdata="";break;case"script":S(t,"onscript",t.script),t.script="";break;default:C(t,"Max buffer length exceeded: "+r[o])}i=Math.max(i,s)}var u=e.MAX_BUFFER_LENGTH-i;t.bufferCheckPosition=u+t.position}(this);return this},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;T(e=this),""!==e.cdata&&(S(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(S(e,"onscript",e.script),e.script="")}};try{t=require$$0$5.Stream}catch(e){t=function(){}}var i=e.EVENTS.filter(function(e){return"error"!==e&&"end"!==e});function o(e,r){if(!(this instanceof o))return new o(e,r);t.apply(this),this._parser=new n(e,r),this.writable=!0,this.readable=!0;var a=this;this._parser.onend=function(){a.emit("end")},this._parser.onerror=function(e){a.emit("error",e),a._parser.error=null},this._decoder=null,i.forEach(function(e){Object.defineProperty(a,"on"+e,{get:function(){return a._parser["on"+e]},set:function(t){if(!t)return a.removeAllListeners(e),a._parser["on"+e]=t,t;a.on(e,t)},enumerable:!0,configurable:!1})})}o.prototype=Object.create(t.prototype,{constructor:{value:o}}),o.prototype.write=function(e){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)){if(!this._decoder){var t=stringDecoder.StringDecoder;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},o.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},o.prototype.on=function(e,r){var n=this;return n._parser["on"+e]||-1===i.indexOf(e)||(n._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),t.prototype.on.call(n,e,r)};var a="[CDATA[",s="DOCTYPE",u="http://www.w3.org/XML/1998/namespace",c="http://www.w3.org/2000/xmlns/",l={xml:u,xmlns:c},f=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,h=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function m(e){return" "===e||"\n"===e||"\r"===e||"\t"===e}function g(e){return'"'===e||"'"===e}function y(e,t){return e.test(t)}var b,v,_,w=0;e.STATE={BEGIN:w++,BEGIN_WHITESPACE:w++,TEXT:w++,TEXT_ENTITY:w++,OPEN_WAKA:w++,SGML_DECL:w++,SGML_DECL_QUOTED:w++,DOCTYPE:w++,DOCTYPE_QUOTED:w++,DOCTYPE_DTD:w++,DOCTYPE_DTD_QUOTED:w++,COMMENT_STARTING:w++,COMMENT:w++,COMMENT_ENDING:w++,COMMENT_ENDED:w++,CDATA:w++,CDATA_ENDING:w++,CDATA_ENDING_2:w++,PROC_INST:w++,PROC_INST_BODY:w++,PROC_INST_ENDING:w++,OPEN_TAG:w++,OPEN_TAG_SLASH:w++,ATTRIB:w++,ATTRIB_NAME:w++,ATTRIB_NAME_SAW_WHITE:w++,ATTRIB_VALUE:w++,ATTRIB_VALUE_QUOTED:w++,ATTRIB_VALUE_CLOSED:w++,ATTRIB_VALUE_UNQUOTED:w++,ATTRIB_VALUE_ENTITY_Q:w++,ATTRIB_VALUE_ENTITY_U:w++,CLOSE_TAG:w++,CLOSE_TAG_SAW_WHITE:w++,SCRIPT:w++,SCRIPT_ENDING:w++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(t){var r=e.ENTITIES[t],n="number"==typeof r?String.fromCharCode(r):r;e.ENTITIES[t]=n});for(var E in e.STATE)e.STATE[e.STATE[E]]=E;function $(e,t,r){e[t]&&e[t](r)}function S(e,t,r){e.textNode&&T(e),$(e,t,r)}function T(e){e.textNode=x(e.opt,e.textNode),e.textNode&&$(e,"ontext",e.textNode),e.textNode=""}function x(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function C(e,t){return T(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,$(e,"onerror",t),e}function k(e){return e.sawRoot&&!e.closedRoot&&N(e,"Unclosed root tag"),e.state!==w.BEGIN&&e.state!==w.BEGIN_WHITESPACE&&e.state!==w.TEXT&&C(e,"Unexpected end"),T(e),e.c="",e.closed=!0,$(e,"onend"),n.call(e,e.strict,e.opt),e}function N(e,t){if("object"!=typeof e||!(e instanceof n))throw new Error("bad call to strictFail");e.strict&&C(e,t)}function D(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,r=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(r.ns=t.ns),e.attribList.length=0,S(e,"onopentagstart",r)}function I(e,t){var r=e.indexOf(":")<0?["",e]:e.split(":"),n=r[0],i=r[1];return t&&"xmlns"===e&&(n="xmlns",i=""),{prefix:n,local:i}}function A(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=I(e.attribName,!0),r=t.prefix,n=t.local;if("xmlns"===r)if("xml"===n&&e.attribValue!==u)N(e,"xml: prefix must be bound to "+u+"\nActual: "+e.attribValue);else if("xmlns"===n&&e.attribValue!==c)N(e,"xmlns: prefix must be bound to "+c+"\nActual: "+e.attribValue);else{var i=e.tag,o=e.tags[e.tags.length-1]||e;i.ns===o.ns&&(i.ns=Object.create(o.ns)),i.ns[n]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,S(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function O(e,t){if(e.opt.xmlns){var r=e.tag,n=I(e.tagName);r.prefix=n.prefix,r.local=n.local,r.uri=r.ns[n.prefix]||"",r.prefix&&!r.uri&&(N(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),r.uri=n.prefix);var i=e.tags[e.tags.length-1]||e;r.ns&&i.ns!==r.ns&&Object.keys(r.ns).forEach(function(t){S(e,"onopennamespace",{prefix:t,uri:r.ns[t]})});for(var o=0,a=e.attribList.length;o<a;o++){var s=e.attribList[o],u=s[0],c=s[1],l=I(u,!0),f=l.prefix,d=l.local,h=""===f?"":r.ns[f]||"",p={name:u,value:c,prefix:f,local:d,uri:h};f&&"xmlns"!==f&&!h&&(N(e,"Unbound namespace prefix: "+JSON.stringify(f)),p.uri=f),e.tag.attributes[u]=p,S(e,"onattribute",p)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),S(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=w.TEXT:e.state=w.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function M(e){if(!e.tagName)return N(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=w.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=w.SCRIPT);S(e,"onscript",e.script),e.script=""}var t=e.tags.length,r=e.tagName;e.strict||(r=r[e.looseCase]());for(var n=r;t--;){if(e.tags[t].name===n)break;N(e,"Unexpected close tag")}if(t<0)return N(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=w.TEXT);e.tagName=r;for(var i=e.tags.length;i-- >t;){var o=e.tag=e.tags.pop();e.tagName=e.tag.name,S(e,"onclosetag",e.tagName);var a={};for(var s in o.ns)a[s]=o.ns[s];var u=e.tags[e.tags.length-1]||e;e.opt.xmlns&&o.ns!==u.ns&&Object.keys(o.ns).forEach(function(t){var r=o.ns[t];S(e,"onclosenamespace",{prefix:t,uri:r})})}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=w.TEXT}function L(e){var t,r=(e=this).entity,n=r.toLowerCase(),i="";return e.ENTITIES[r]?e.ENTITIES[r]:e.ENTITIES[n]?e.ENTITIES[n]:("#"===(r=n).charAt(0)&&("x"===r.charAt(1)?(r=r.slice(2),i=(t=parseInt(r,16)).toString(16)):(r=r.slice(1),i=(t=parseInt(r,10)).toString(10))),r=r.replace(/^0+/,""),isNaN(t)||i.toLowerCase()!==r?(N(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function R(e,t){"<"===t?(e.state=w.OPEN_WAKA,e.startTagPosition=e.position):m(t)||(N(e,"Non-whitespace before first tag."),e.textNode=t,e.state=w.TEXT)}function B(e,t){var r="";return t<e.length&&(r=e.charAt(t)),r}w=e.STATE,String.fromCodePoint||(b=String.fromCharCode,v=Math.floor,_=function(){var e,t,r=[],n=-1,i=arguments.length;if(!i)return"";for(var o="";++n<i;){var a=Number(arguments[n]);if(!isFinite(a)||a<0||a>1114111||v(a)!==a)throw RangeError("Invalid code point: "+a);a<=65535?r.push(a):(e=55296+((a-=65536)>>10),t=a%1024+56320,r.push(e,t)),(n+1===i||r.length>16384)&&(o+=b.apply(null,r),r.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:_,configurable:!0,writable:!0}):String.fromCodePoint=_)}(t)}),optionsHelper={copyOptions:function(e){var t,r={};for(t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r},ensureFlagExists:function(e,t){e in t&&"boolean"==typeof t[e]||(t[e]=!1)},ensureSpacesExists:function(e){"spaces"in e&&("number"==typeof e.spaces||"string"==typeof e.spaces)||(e.spaces=0)},ensureKeyExists:function(e,t){e+"Key"in t&&"string"==typeof t[e+"Key"]||(t[e+"Key"]=t.compact?"_"+e:e)},checkFnExists:function(e,t){return e+"Fn"in t}},arrayHelper={isArray:function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}},expat={on:function(){},parse:function(){}},isArray$6=arrayHelper.isArray,options,pureJsParser=!0,currentElement;function validateOptions(e){return options=optionsHelper.copyOptions(e),optionsHelper.ensureFlagExists("ignoreDeclaration",options),optionsHelper.ensureFlagExists("ignoreInstruction",options),optionsHelper.ensureFlagExists("ignoreAttributes",options),optionsHelper.ensureFlagExists("ignoreText",options),optionsHelper.ensureFlagExists("ignoreComment",options),optionsHelper.ensureFlagExists("ignoreCdata",options),optionsHelper.ensureFlagExists("ignoreDoctype",options),optionsHelper.ensureFlagExists("compact",options),optionsHelper.ensureFlagExists("alwaysArray",options),optionsHelper.ensureFlagExists("alwaysChildren",options),optionsHelper.ensureFlagExists("addParent",options),optionsHelper.ensureFlagExists("trim",options),optionsHelper.ensureFlagExists("nativeType",options),optionsHelper.ensureFlagExists("sanitize",options),optionsHelper.ensureFlagExists("instructionHasAttributes",options),optionsHelper.ensureFlagExists("captureSpacesBetweenElements",options),optionsHelper.ensureKeyExists("declaration",options),optionsHelper.ensureKeyExists("instruction",options),optionsHelper.ensureKeyExists("attributes",options),optionsHelper.ensureKeyExists("text",options),optionsHelper.ensureKeyExists("comment",options),optionsHelper.ensureKeyExists("cdata",options),optionsHelper.ensureKeyExists("doctype",options),optionsHelper.ensureKeyExists("type",options),optionsHelper.ensureKeyExists("name",options),optionsHelper.ensureKeyExists("elements",options),optionsHelper.ensureKeyExists("parent",options),optionsHelper.checkFnExists("doctype",options),optionsHelper.checkFnExists("instruction",options),optionsHelper.checkFnExists("cdata",options),optionsHelper.checkFnExists("comment",options),optionsHelper.checkFnExists("text",options),optionsHelper.checkFnExists("instructionName",options),optionsHelper.checkFnExists("elementName",options),optionsHelper.checkFnExists("attributeName",options),optionsHelper.checkFnExists("attributeValue",options),optionsHelper.checkFnExists("attributes",options),options}function nativeType(e){var t=Number(e);if(!isNaN(t))return t;var r=e.toLowerCase();return"true"===r||"false"!==r&&e}function addField(e,t){var r;if(options.compact){if(!currentElement[options[e+"Key"]]&&options.alwaysArray&&(currentElement[options[e+"Key"]]=[]),currentElement[options[e+"Key"]]&&!isArray$6(currentElement[options[e+"Key"]])&&(currentElement[options[e+"Key"]]=[currentElement[options[e+"Key"]]]),e+"Fn"in options&&"string"==typeof t&&(t=options[e+"Fn"](t,currentElement)),"instruction"===e&&("instructionFn"in options||"instructionNameFn"in options))for(r in t)if(t.hasOwnProperty(r))if("instructionFn"in options)t[r]=options.instructionFn(t[r],r,currentElement);else{var n=t[r];delete t[r],t[options.instructionNameFn(r,n,currentElement)]=n}isArray$6(currentElement[options[e+"Key"]])?currentElement[options[e+"Key"]].push(t):currentElement[options[e+"Key"]]=t}else{currentElement[options.elementsKey]||(currentElement[options.elementsKey]=[]);var i={};if(i[options.typeKey]=e,"instruction"===e){for(r in t)if(t.hasOwnProperty(r))break;i[options.nameKey]="instructionNameFn"in options?options.instructionNameFn(r,t,currentElement):r,options.instructionHasAttributes?(i[options.attributesKey]=t[r][options.attributesKey],"instructionFn"in options&&(i[options.attributesKey]=options.instructionFn(i[options.attributesKey],r,currentElement))):("instructionFn"in options&&(t[r]=options.instructionFn(t[r],r,currentElement)),i[options.instructionKey]=t[r])}else e+"Fn"in options&&(t=options[e+"Fn"](t,currentElement)),i[options[e+"Key"]]=t;options.addParent&&(i[options.parentKey]=currentElement),currentElement[options.elementsKey].push(i)}}function manipulateAttributes(e){var t;if("attributesFn"in options&&e&&(e=options.attributesFn(e,currentElement)),(options.trim||"attributeValueFn"in options||"attributeNameFn"in options)&&e)for(t in e)if(e.hasOwnProperty(t)&&(options.trim&&(e[t]=e[t].trim()),"attributeValueFn"in options&&(e[t]=options.attributeValueFn(e[t],t,currentElement)),"attributeNameFn"in options)){var r=e[t];delete e[t],e[options.attributeNameFn(t,e[t],currentElement)]=r}return e}function onInstruction(e){var t={};if(e.body&&("xml"===e.name.toLowerCase()||options.instructionHasAttributes)){for(var r,n=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g;null!==(r=n.exec(e.body));)t[r[1]]=r[2]||r[3]||r[4];t=manipulateAttributes(t)}if("xml"===e.name.toLowerCase()){if(options.ignoreDeclaration)return;currentElement[options.declarationKey]={},Object.keys(t).length&&(currentElement[options.declarationKey][options.attributesKey]=t),options.addParent&&(currentElement[options.declarationKey][options.parentKey]=currentElement)}else{if(options.ignoreInstruction)return;options.trim&&(e.body=e.body.trim());var i={};options.instructionHasAttributes&&Object.keys(t).length?(i[e.name]={},i[e.name][options.attributesKey]=t):i[e.name]=e.body,addField("instruction",i)}}function onStartElement(e,t){var r;if("object"==typeof e&&(t=e.attributes,e=e.name),t=manipulateAttributes(t),"elementNameFn"in options&&(e=options.elementNameFn(e,currentElement)),options.compact){if(r={},!options.ignoreAttributes&&t&&Object.keys(t).length){var n;r[options.attributesKey]={};for(n in t)t.hasOwnProperty(n)&&(r[options.attributesKey][n]=t[n])}e in currentElement||!options.alwaysArray||(currentElement[e]=[]),currentElement[e]&&!isArray$6(currentElement[e])&&(currentElement[e]=[currentElement[e]]),isArray$6(currentElement[e])?currentElement[e].push(r):currentElement[e]=r}else currentElement[options.elementsKey]||(currentElement[options.elementsKey]=[]),(r={})[options.typeKey]="element",r[options.nameKey]=e,!options.ignoreAttributes&&t&&Object.keys(t).length&&(r[options.attributesKey]=t),options.alwaysChildren&&(r[options.elementsKey]=[]),currentElement[options.elementsKey].push(r);r[options.parentKey]=currentElement,currentElement=r}function onText(e){options.ignoreText||(e.trim()||options.captureSpacesBetweenElements)&&(options.trim&&(e=e.trim()),options.nativeType&&(e=nativeType(e)),options.sanitize&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),addField("text",e))}function onComment(e){options.ignoreComment||(options.trim&&(e=e.trim()),addField("comment",e))}function onEndElement(e){var t=currentElement[options.parentKey];options.addParent||delete currentElement[options.parentKey],currentElement=t}function onCdata(e){options.ignoreCdata||(options.trim&&(e=e.trim()),addField("cdata",e))}function onDoctype(e){options.ignoreDoctype||(e=e.replace(/^ /,""),options.trim&&(e=e.trim()),addField("doctype",e))}function onError(e){e.note=e}var xml2js=function(e,t){var r=pureJsParser?sax.parser(!0,{}):r=new expat.Parser("UTF-8"),n={};if(currentElement=n,options=validateOptions(t),pureJsParser?(r.onopentag=onStartElement,r.ontext=onText,r.oncomment=onComment,r.onclosetag=onEndElement,r.onerror=onError,r.oncdata=onCdata,r.ondoctype=onDoctype,r.onprocessinginstruction=onInstruction):(r.on("startElement",onStartElement),r.on("text",onText),r.on("comment",onComment),r.on("endElement",onEndElement),r.on("error",onError)),pureJsParser)r.write(e).close();else if(!r.parse(e))throw new Error("XML parsing error: "+r.getError());if(n[options.elementsKey]){var i=n[options.elementsKey];delete n[options.elementsKey],n[options.elementsKey]=i,delete n.text}return n};function validateOptions$1(e){var t=optionsHelper.copyOptions(e);return optionsHelper.ensureSpacesExists(t),t}var xml2json=function(e,t){var r,n,i;return r=validateOptions$1(t),n=xml2js(e,r),i="compact"in r&&r.compact?"_parent":"parent",("addParent"in r&&r.addParent?JSON.stringify(n,function(e,t){return e===i?"_":t},r.spaces):JSON.stringify(n,null,r.spaces)).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},isArray$7=arrayHelper.isArray,currentElement$1,currentElementName;function validateOptions$2(e){var t=optionsHelper.copyOptions(e);return optionsHelper.ensureFlagExists("ignoreDeclaration",t),optionsHelper.ensureFlagExists("ignoreInstruction",t),optionsHelper.ensureFlagExists("ignoreAttributes",t),optionsHelper.ensureFlagExists("ignoreText",t),optionsHelper.ensureFlagExists("ignoreComment",t),optionsHelper.ensureFlagExists("ignoreCdata",t),optionsHelper.ensureFlagExists("ignoreDoctype",t),optionsHelper.ensureFlagExists("compact",t),optionsHelper.ensureFlagExists("indentText",t),optionsHelper.ensureFlagExists("indentCdata",t),optionsHelper.ensureFlagExists("indentAttributes",t),optionsHelper.ensureFlagExists("indentInstruction",t),optionsHelper.ensureFlagExists("fullTagEmptyElement",t),optionsHelper.ensureFlagExists("noQuotesForNativeAttributes",t),optionsHelper.ensureSpacesExists(t),"number"==typeof t.spaces&&(t.spaces=Array(t.spaces+1).join(" ")),optionsHelper.ensureKeyExists("declaration",t),optionsHelper.ensureKeyExists("instruction",t),optionsHelper.ensureKeyExists("attributes",t),optionsHelper.ensureKeyExists("text",t),optionsHelper.ensureKeyExists("comment",t),optionsHelper.ensureKeyExists("cdata",t),optionsHelper.ensureKeyExists("doctype",t),optionsHelper.ensureKeyExists("type",t),optionsHelper.ensureKeyExists("name",t),optionsHelper.ensureKeyExists("elements",t),optionsHelper.checkFnExists("doctype",t),optionsHelper.checkFnExists("instruction",t),optionsHelper.checkFnExists("cdata",t),optionsHelper.checkFnExists("comment",t),optionsHelper.checkFnExists("text",t),optionsHelper.checkFnExists("instructionName",t),optionsHelper.checkFnExists("elementName",t),optionsHelper.checkFnExists("attributeName",t),optionsHelper.checkFnExists("attributeValue",t),optionsHelper.checkFnExists("attributes",t),optionsHelper.checkFnExists("fullTagEmptyElement",t),t}function writeIndentation(e,t,r){return(!r&&e.spaces?"\n":"")+Array(t+1).join(e.spaces)}function writeAttributes(e,t,r){if(t.ignoreAttributes)return"";"attributesFn"in t&&(e=t.attributesFn(e,currentElementName,currentElement$1));var n,i,o,a,s="";for(n in e)e.hasOwnProperty(n)&&(a=t.noQuotesForNativeAttributes&&"string"!=typeof e[n]?"":'"',i=(i=""+e[n]).replace(/"/g,"&quot;"),o="attributeNameFn"in t?t.attributeNameFn(n,i,currentElementName,currentElement$1):n,s+=t.spaces&&t.indentAttributes?writeIndentation(t,r+1,!1):" ",s+=o+"="+a+("attributeValueFn"in t?t.attributeValueFn(i,n,currentElementName,currentElement$1):i)+a);return e&&Object.keys(e).length&&t.spaces&&t.indentAttributes&&(s+=writeIndentation(t,r,!1)),s}function writeDeclaration(e,t,r){return currentElement$1=e,currentElementName="xml",t.ignoreDeclaration?"":"<?xml"+writeAttributes(e[t.attributesKey],t,r)+"?>"}function writeInstruction(e,t,r){if(t.ignoreInstruction)return"";var n;for(n in e)if(e.hasOwnProperty(n))break;var i="instructionNameFn"in t?t.instructionNameFn(n,e[n],currentElementName,currentElement$1):n;if("object"==typeof e[n])return currentElement$1=e,currentElementName=i,"<?"+i+writeAttributes(e[n][t.attributesKey],t,r)+"?>";var o=e[n]?e[n]:"";return"instructionFn"in t&&(o=t.instructionFn(o,n,currentElementName,currentElement$1)),"<?"+i+(o?" "+o:"")+"?>"}function writeComment(e,t){return t.ignoreComment?"":"\x3c!--"+("commentFn"in t?t.commentFn(e,currentElementName,currentElement$1):e)+"--\x3e"}function writeCdata(e,t){return t.ignoreCdata?"":"<![CDATA["+("cdataFn"in t?t.cdataFn(e,currentElementName,currentElement$1):e)+"]]>"}function writeDoctype(e,t){return t.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in t?t.doctypeFn(e,currentElementName,currentElement$1):e)+">"}function writeText(e,t){return t.ignoreText?"":(e=(e=(e=""+e).replace(/&amp;/g,"&")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in t?t.textFn(e,currentElementName,currentElement$1):e)}function hasContent(e,t){var r;if(e.elements&&e.elements.length)for(r=0;r<e.elements.length;++r)switch(e.elements[r][t.typeKey]){case"text":if(t.indentText)return!0;break;case"cdata":if(t.indentCdata)return!0;break;case"instruction":if(t.indentInstruction)return!0;break;case"doctype":case"comment":case"element":default:return!0}return!1}function writeElement(e,t,r){currentElement$1=e,currentElementName=e.name;var n="",i="elementNameFn"in t?t.elementNameFn(e.name,e):e.name;n+="<"+i,e[t.attributesKey]&&(n+=writeAttributes(e[t.attributesKey],t,r));var o=e[t.elementsKey]&&e[t.elementsKey].length||e[t.attributesKey]&&"preserve"===e[t.attributesKey]["xml:space"];return o||(o="fullTagEmptyElementFn"in t?t.fullTagEmptyElementFn(e.name,e):t.fullTagEmptyElement),o?(n+=">",e[t.elementsKey]&&e[t.elementsKey].length&&(n+=writeElements(e[t.elementsKey],t,r+1),currentElement$1=e,currentElementName=e.name),n+=t.spaces&&hasContent(e,t)?"\n"+Array(r+1).join(t.spaces):"",n+="</"+i+">"):n+="/>",n}function writeElements(e,t,r,n){return e.reduce(function(e,i){var o=writeIndentation(t,r,n&&!e);switch(i.type){case"element":return e+o+writeElement(i,t,r);case"comment":return e+o+writeComment(i[t.commentKey],t);case"doctype":return e+o+writeDoctype(i[t.doctypeKey],t);case"cdata":return e+(t.indentCdata?o:"")+writeCdata(i[t.cdataKey],t);case"text":return e+(t.indentText?o:"")+writeText(i[t.textKey],t);case"instruction":var a={};return a[i[t.nameKey]]=i[t.attributesKey]?i:i[t.instructionKey],e+(t.indentInstruction?o:"")+writeInstruction(a,t,r)}},"")}function hasContentCompact(e,t,r){var n;for(n in e)if(e.hasOwnProperty(n))switch(n){case t.parentKey:case t.attributesKey:break;case t.textKey:if(t.indentText||r)return!0;break;case t.cdataKey:if(t.indentCdata||r)return!0;break;case t.instructionKey:if(t.indentInstruction||r)return!0;break;case t.doctypeKey:case t.commentKey:default:return!0}return!1}function writeElementCompact(e,t,r,n,i){currentElement$1=e,currentElementName=t;var o="elementNameFn"in r?r.elementNameFn(t,e):t;if(void 0===e||null===e)return"fullTagEmptyElementFn"in r&&r.fullTagEmptyElementFn(t,e)||r.fullTagEmptyElement?"<"+o+"></"+o+">":"<"+o+"/>";var a="";if(t){if(a+="<"+o,"object"!=typeof e)return a+=">"+writeText(e,r)+"</"+o+">";e[r.attributesKey]&&(a+=writeAttributes(e[r.attributesKey],r,n));var s=hasContentCompact(e,r,!0)||e[r.attributesKey]&&"preserve"===e[r.attributesKey]["xml:space"];if(s||(s="fullTagEmptyElementFn"in r?r.fullTagEmptyElementFn(t,e):r.fullTagEmptyElement),!s)return a+="/>";a+=">"}return a+=writeElementsCompact(e,r,n+1,!1),currentElement$1=e,currentElementName=t,t&&(a+=(i?writeIndentation(r,n,!1):"")+"</"+o+">"),a}function writeElementsCompact(e,t,r,n){var i,o,a,s="";for(o in e)if(e.hasOwnProperty(o))for(a=isArray$7(e[o])?e[o]:[e[o]],i=0;i<a.length;++i){switch(o){case t.declarationKey:s+=writeDeclaration(a[i],t,r);break;case t.instructionKey:s+=(t.indentInstruction?writeIndentation(t,r,n):"")+writeInstruction(a[i],t,r);break;case t.attributesKey:case t.parentKey:break;case t.textKey:s+=(t.indentText?writeIndentation(t,r,n):"")+writeText(a[i],t);break;case t.cdataKey:s+=(t.indentCdata?writeIndentation(t,r,n):"")+writeCdata(a[i],t);break;case t.doctypeKey:s+=writeIndentation(t,r,n)+writeDoctype(a[i],t);break;case t.commentKey:s+=writeIndentation(t,r,n)+writeComment(a[i],t);break;default:s+=writeIndentation(t,r,n)+writeElementCompact(a[i],o,t,r,hasContentCompact(a[i],t))}n=n&&!s}return s}var js2xml=function(e,t){t=validateOptions$2(t);var r="";return currentElement$1=e,currentElementName="_root_",t.compact?r=writeElementsCompact(e,t,0,!0):(e[t.declarationKey]&&(r+=writeDeclaration(e[t.declarationKey],t,0)),e[t.elementsKey]&&e[t.elementsKey].length&&(r+=writeElements(e[t.elementsKey],t,0,!r))),r},json2xml=function(e,t){e instanceof Buffer&&(e=e.toString());var r=null;if("string"==typeof e)try{r=JSON.parse(e)}catch(e){throw new Error("The JSON structure is invalid")}else r=e;return js2xml(r,t)},lib$5={xml2js:xml2js,xml2json:xml2json,js2xml:js2xml,json2xml:json2xml},createGenerator=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return JSON.stringify(e)},n=function(e){var t=e.body,n=[],i=!0,o=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=void 0;if("universalSelector"===c.type)l="*";else if("typeSelector"===c.type)l=c.name;else if("idSelector"===c.type)l="#"+c.name;else if("classSelector"===c.type)l="."+c.name;else if("attributePresenceSelector"===c.type)l="["+c.name+"]";else if("attributeValueSelector"===c.type)l="["+c.name+c.operator+r(c.value)+"]";else if("pseudoClassSelector"===c.type)l=":"+c.name,c.parameters.length&&(l+="("+c.parameters.map(r).join(", ")+")");else{if("pseudoElementSelector"!==c.type)throw new Error("Unknown token.");l="::"+c.name}n.push(l)}}catch(e){o=!0,a=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}return n.join("")};t.default=function(){return{generate:function(e){var t=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if("selector"===u.type)t.push(n(u));else if("descendantCombinator"===u.type)t.push(" ");else if("childCombinator"===u.type)t.push(" > ");else if("adjacentSiblingCombinator"===u.type)t.push(" + ");else{if("generalSiblingCombinator"!==u.type)throw new Error("Unknown token.");t.push(" ~ ")}}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return t.join("")}}}});unwrapExports(createGenerator);var nearley=createCommonjsModule(function(e){var t,r;t=commonjsGlobal,r=function(){function e(t,r,n){return this.id=++e.highestId,this.name=t,this.symbols=r,this.postprocess=n,this}function t(e,t,r,n){this.rule=e,this.dot=t,this.reference=r,this.data=[],this.wantedBy=n,this.isComplete=this.dot===e.symbols.length}function r(e,t){this.grammar=e,this.index=t,this.states=[],this.wants={},this.scannable=[],this.completed={}}function n(e,t){this.rules=e,this.start=t||this.rules[0].name;var r=this.byName={};this.rules.forEach(function(e){r.hasOwnProperty(e.name)||(r[e.name]=[]),r[e.name].push(e)})}function i(){this.reset("")}function o(e,t,o){if(e instanceof n){var a=e;o=t}else a=n.fromCompiled(e,t);this.grammar=a,this.options={keepHistory:!1,lexer:a.lexer||new i};for(var s in o||{})this.options[s]=o[s];this.lexer=this.options.lexer,this.lexerState=void 0;var u=new r(a,0);this.table=[u];u.wants[a.start]=[],u.predict(a.start),u.process(),this.current=0}return e.highestId=0,e.prototype.toString=function(e){function t(e){return e.literal?JSON.stringify(e.literal):e.type?"%"+e.type:e.toString()}var r=void 0===e?this.symbols.map(t).join(" "):this.symbols.slice(0,e).map(t).join(" ")+"  "+this.symbols.slice(e).map(t).join(" ");return this.name+"  "+r},t.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},t.prototype.nextState=function(e){var r=new t(this.rule,this.dot+1,this.reference,this.wantedBy);return r.left=this,r.right=e,r.isComplete&&(r.data=r.build()),r},t.prototype.build=function(){var e=[],t=this;do{e.push(t.right.data),t=t.left}while(t.left);return e.reverse(),e},t.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,o.fail))},r.prototype.process=function(e){for(var t=this.states,r=this.wants,n=this.completed,i=0;i<t.length;i++){var a=t[i];if(a.isComplete){if(a.finish(),a.data!==o.fail){for(var s=a.wantedBy,u=s.length;u--;){var c=s[u];this.complete(c,a)}if(a.reference===this.index){var l=a.rule.name;(this.completed[l]=this.completed[l]||[]).push(a)}}}else{if("string"!=typeof(l=a.rule.symbols[a.dot])){this.scannable.push(a);continue}if(r[l]){if(r[l].push(a),n.hasOwnProperty(l)){var f=n[l];for(u=0;u<f.length;u++){var d=f[u];this.complete(a,d)}}}else r[l]=[a],this.predict(l)}}},r.prototype.predict=function(e){for(var r=this.grammar.byName[e]||[],n=0;n<r.length;n++){var i=r[n],o=this.wants[e],a=new t(i,0,this.index,o);this.states.push(a)}},r.prototype.complete=function(e,t){var r=t.rule.name;if(e.rule.symbols[e.dot]===r){var n=e.nextState(t);this.states.push(n)}},n.fromCompiled=function(t,r){var i=t.Lexer;t.ParserStart&&(r=t.ParserStart,t=t.ParserRules);var o=new n(t=t.map(function(t){return new e(t.name,t.symbols,t.postprocess)}),r);return o.lexer=i,o},i.prototype.reset=function(e,t){this.buffer=e,this.index=0,this.line=t?t.line:1,this.lastLineBreak=t?-t.col:0},i.prototype.next=function(){if(this.index<this.buffer.length){var e=this.buffer[this.index++];return"\n"===e&&(this.line+=1,this.lastLineBreak=this.index),{value:e}}},i.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},i.prototype.formatError=function(e,t){var r=this.buffer;if("string"==typeof r){var n=r.indexOf("\n",this.index);-1===n&&(n=r.length);var i=r.substring(this.lastLineBreak,n),o=this.index-this.lastLineBreak;return t+=" at line "+this.line+" col "+o+":\n\n",t+="  "+i+"\n",t+="  "+Array(o).join(" ")+"^"}return t+" at index "+(this.index-1)},o.fail={},o.prototype.feed=function(e){var t,n=this.lexer;for(n.reset(e,this.lexerState);t=n.next();){var o=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var a=this.current+1,s=new r(this.grammar,a);this.table.push(s);for(var u=t.value,c=n.constructor===i?t.value:t,l=o.scannable,f=l.length;f--;){var d=l[f],h=d.rule.symbols[d.dot];if(h.test?h.test(c):h.type?h.type===t.type:h.literal===u){var p=d.nextState({data:c,token:t,isToken:!0,reference:a-1});s.states.push(p)}}if(s.process(),0===s.states.length){var m=this.lexer.formatError(t,"invalid syntax")+"\n";m+="Unexpected "+(t.type?t.type+" token: ":""),m+=JSON.stringify(void 0!==t.value?t.value:t)+"\n";var g=new Error(m);throw g.offset=this.current,g.token=t,g}this.options.keepHistory&&(o.lexerState=n.save()),this.current++}return o&&(this.lexerState=n.save()),this.results=this.finish(),this},o.prototype.save=function(){var e=this.table[this.current];return e.lexerState=this.lexerState,e},o.prototype.restore=function(e){var t=e.index;this.current=t,this.table[t]=e,this.table.splice(t+1),this.lexerState=e.lexerState,this.results=this.finish()},o.prototype.rewind=function(e){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[e])},o.prototype.finish=function(){var e=[],t=this.grammar.start;return this.table[this.table.length-1].states.forEach(function(r){r.rule.name===t&&r.dot===r.rule.symbols.length&&0===r.reference&&r.data!==o.fail&&e.push(r)}),e.map(function(e){return e.data})},{Parser:o,Grammar:n,Rule:e}},e.exports?e.exports=r():t.nearley=r()}),grammar=createCommonjsModule(function(e){!function(){function t(e){return e[0]}var r,n,i=function(e){return(e=e.filter(function(e){return null!==e})).reduce(function(e,t){return e.concat(t)},[])},o={" ":"descendantCombinator","+":"adjacentSiblingCombinator",">":"childCombinator","~":"generalSiblingCombinator"},a={ParserRules:[{name:"combinator",symbols:["selector"]},{name:"combinator",symbols:["combinator","_",/[>+~ ]/,"_","selector"],postprocess:function(e){return(Array.isArray(e[0])?e[0]:[e[0]]).concat({type:o[e[2]]}).concat(e[4])}},{name:"selector",symbols:["selectorBody"],postprocess:function(e){return{type:"selector",body:e[0]}}},{name:"selectorBody$ebnf$1",symbols:["typeSelector"],postprocess:t},{name:"selectorBody$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"selectorBody$ebnf$2",symbols:["idSelector"],postprocess:t},{name:"selectorBody$ebnf$2",symbols:[],postprocess:function(e){return null}},{name:"selectorBody$ebnf$3",symbols:[]},{name:"selectorBody$ebnf$3",symbols:["classSelector","selectorBody$ebnf$3"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"selectorBody$ebnf$4",symbols:[]},{name:"selectorBody$ebnf$4",symbols:["attributeValueSelector","selectorBody$ebnf$4"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"selectorBody$ebnf$5",symbols:[]},{name:"selectorBody$ebnf$5",symbols:["attributePresenceSelector","selectorBody$ebnf$5"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"selectorBody$ebnf$6",symbols:[]},{name:"selectorBody$ebnf$6",symbols:["pseudoClassSelector","selectorBody$ebnf$6"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"selectorBody$ebnf$7",symbols:["pseudoElementSelector"],postprocess:t},{name:"selectorBody$ebnf$7",symbols:[],postprocess:function(e){return null}},{name:"selectorBody",symbols:["selectorBody$ebnf$1","selectorBody$ebnf$2","selectorBody$ebnf$3","selectorBody$ebnf$4","selectorBody$ebnf$5","selectorBody$ebnf$6","selectorBody$ebnf$7"],postprocess:function(e,t,r){var n=i(e);return n.length?n:r}},{name:"selectorBody$ebnf$8",symbols:["idSelector"],postprocess:t},{name:"selectorBody$ebnf$8",symbols:[],postprocess:function(e){return null}},{name:"selectorBody$ebnf$9",symbols:[]},{name:"selectorBody$ebnf$9",symbols:["classSelector","selectorBody$ebnf$9"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"selectorBody$ebnf$10",symbols:[]},{name:"selectorBody$ebnf$10",symbols:["attributeValueSelector","selectorBody$ebnf$10"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"selectorBody$ebnf$11",symbols:[]},{name:"selectorBody$ebnf$11",symbols:["attributePresenceSelector","selectorBody$ebnf$11"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"selectorBody$ebnf$12",symbols:[]},{name:"selectorBody$ebnf$12",symbols:["pseudoClassSelector","selectorBody$ebnf$12"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"selectorBody$ebnf$13",symbols:["pseudoElementSelector"],postprocess:t},{name:"selectorBody$ebnf$13",symbols:[],postprocess:function(e){return null}},{name:"selectorBody",symbols:["universalSelector","selectorBody$ebnf$8","selectorBody$ebnf$9","selectorBody$ebnf$10","selectorBody$ebnf$11","selectorBody$ebnf$12","selectorBody$ebnf$13"],postprocess:i},{name:"typeSelector",symbols:["attributeName"],postprocess:function(e){return{type:"typeSelector",name:e[0]}}},{name:"className$ebnf$1",symbols:[{literal:"-"}],postprocess:t},{name:"className$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"className$ebnf$2",symbols:[]},{name:"className$ebnf$2",symbols:[/[_a-zA-Z0-9-]/,"className$ebnf$2"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"className",symbols:["className$ebnf$1",/[_a-zA-Z]/,"className$ebnf$2"],postprocess:function(e){return(e[0]||"")+e[1]+e[2].join("")}},{name:"attributeName$ebnf$1",symbols:[]},{name:"attributeName$ebnf$1",symbols:[/[_a-zA-Z0-9-]/,"attributeName$ebnf$1"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"attributeName",symbols:[/[_a-zA-Z]/,"attributeName$ebnf$1"],postprocess:function(e){return e[0]+e[1].join("")}},{name:"classSelector",symbols:[{literal:"."},"className"],postprocess:function(e){return{type:"classSelector",name:e[1]}}},{name:"idSelector",symbols:[{literal:"#"},"attributeName"],postprocess:function(e){return{type:"idSelector",name:e[1]}}},{name:"universalSelector",symbols:[{literal:"*"}],postprocess:function(e){return{type:"universalSelector"}}},{name:"attributePresenceSelector",symbols:[{literal:"["},"attributeName",{literal:"]"}],postprocess:function(e){return{type:"attributePresenceSelector",name:e[1]}}},{name:"attributeOperator",symbols:[{literal:"="}]},{name:"attributeOperator$string$1",symbols:[{literal:"~"},{literal:"="}],postprocess:function(e){return e.join("")}},{name:"attributeOperator",symbols:["attributeOperator$string$1"]},{name:"attributeOperator$string$2",symbols:[{literal:"|"},{literal:"="}],postprocess:function(e){return e.join("")}},{name:"attributeOperator",symbols:["attributeOperator$string$2"]},{name:"attributeOperator$string$3",symbols:[{literal:"^"},{literal:"="}],postprocess:function(e){return e.join("")}},{name:"attributeOperator",symbols:["attributeOperator$string$3"]},{name:"attributeOperator$string$4",symbols:[{literal:"$"},{literal:"="}],postprocess:function(e){return e.join("")}},{name:"attributeOperator",symbols:["attributeOperator$string$4"]},{name:"attributeOperator$string$5",symbols:[{literal:"*"},{literal:"="}],postprocess:function(e){return e.join("")}},{name:"attributeOperator",symbols:["attributeOperator$string$5"]},{name:"attributeValueSelector",symbols:[{literal:"["},"attributeName","attributeOperator","attributeValue",{literal:"]"}],postprocess:function(e){return{type:"attributeValueSelector",name:e[1],value:e[3],operator:e[2][0]}}},{name:"attributeValue",symbols:["unquotedAttributeValue"],postprocess:t},{name:"attributeValue",symbols:["sqstring"],postprocess:t},{name:"attributeValue",symbols:["dqstring"],postprocess:t},{name:"unquotedAttributeValue$ebnf$1",symbols:[/[^\[\]"',= ]/]},{name:"unquotedAttributeValue$ebnf$1",symbols:[/[^\[\]"',= ]/,"unquotedAttributeValue$ebnf$1"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"unquotedAttributeValue",symbols:["unquotedAttributeValue$ebnf$1"],postprocess:function(e){return e[0].join("")}},{name:"classParameters",symbols:[]},{name:"classParameters",symbols:["classParameter"]},{name:"classParameters",symbols:["classParameters",{literal:","},"_","classParameter"],postprocess:(r=0,n=3,function(e){return e[r].concat([e[n]])})},{name:"classParameter$ebnf$1",symbols:[/[^()"', ]/]},{name:"classParameter$ebnf$1",symbols:[/[^()"', ]/,"classParameter$ebnf$1"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"classParameter",symbols:["classParameter$ebnf$1"],postprocess:function(e){return e[0].join("")}},{name:"classParameter",symbols:["sqstring"],postprocess:t},{name:"classParameter",symbols:["dqstring"],postprocess:t},{name:"pseudoElementSelector$string$1",symbols:[{literal:":"},{literal:":"}],postprocess:function(e){return e.join("")}},{name:"pseudoElementSelector",symbols:["pseudoElementSelector$string$1","pseudoClassSelectorName"],postprocess:function(e){return{type:"pseudoElementSelector",name:e[1]}}},{name:"pseudoClassSelector",symbols:[{literal:":"},"pseudoClassSelectorName"],postprocess:function(e){return{type:"pseudoClassSelector",name:e[1]}}},{name:"pseudoClassSelector",symbols:[{literal:":"},"pseudoClassSelectorName",{literal:"("},"classParameters",{literal:")"}],postprocess:function(e){return{type:"pseudoClassSelector",name:e[1],parameters:e[3]}}},{name:"pseudoClassSelectorName$ebnf$1",symbols:[/[a-zA-Z0-9-_]/]},{name:"pseudoClassSelectorName$ebnf$1",symbols:[/[a-zA-Z0-9-_]/,"pseudoClassSelectorName$ebnf$1"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"pseudoClassSelectorName",symbols:[/[a-zA-Z]/,"pseudoClassSelectorName$ebnf$1"],postprocess:function(e){return e[0]+e[1].join("")}},{name:"dqstring$ebnf$1",symbols:[]},{name:"dqstring$ebnf$1",symbols:["dstrchar","dqstring$ebnf$1"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"dqstring",symbols:[{literal:'"'},"dqstring$ebnf$1",{literal:'"'}],postprocess:function(e){return e[1].join("")}},{name:"dstrchar",symbols:[/[^"]/],postprocess:t},{name:"dstrchar$string$1",symbols:[{literal:"\\"},{literal:'"'}],postprocess:function(e){return e.join("")}},{name:"dstrchar",symbols:["dstrchar$string$1"],postprocess:function(e){return'"'}},{name:"sqstring$ebnf$1",symbols:[]},{name:"sqstring$ebnf$1",symbols:["sstrchar","sqstring$ebnf$1"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"sqstring",symbols:[{literal:"'"},"sqstring$ebnf$1",{literal:"'"}],postprocess:function(e){return e[1].join("")}},{name:"sstrchar",symbols:[/[^']/],postprocess:t},{name:"sstrchar$string$1",symbols:[{literal:"\\"},{literal:"'"}],postprocess:function(e){return e.join("")}},{name:"sstrchar",symbols:["sstrchar$string$1"],postprocess:function(e){return"'"}},{name:"_$ebnf$1",symbols:[]},{name:"_$ebnf$1",symbols:[/[ ]/,"_$ebnf$1"],postprocess:function(e){return[e[0]].concat(e[1])}},{name:"_",symbols:["_$ebnf$1"],postprocess:function(e){return null}}],ParserStart:"combinator"};e.exports=a}()}),createParser=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=grammar)&&r.__esModule?r:{default:r};t.default=function(){return{parse:function(e){var t=new nearley.Parser(n.default.ParserRules,n.default.ParserStart).feed(e).results;if(0===t.length)throw new Error("Found no parsings.");if(t.length>1)throw new Error("Ambiguous results.");return t[0]}}}});unwrapExports(createParser);var dist=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=t.createGenerator=void 0;var r=i(createGenerator),n=i(createParser);function i(e){return e&&e.__esModule?e:{default:e}}t.createGenerator=r.default,t.createParser=n.default});unwrapExports(dist);var dist_1=dist.createParser,dist_2=dist.createGenerator,defaultSvgDocTemplate='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="500" height="500">\n  <metadata id="mure">\n    <mure xmlns="http://mure-apps.github.io">\n    </mure>\n  </metadata>\n  <script id="mureInteractivityRunner" type="text/javascript">\n    <![CDATA[\n      ${mureInteractivityRunnerText}\n    ]]>\n  <\/script>\n</svg>\n',minimumSvgDoc='<svg>\n  <metadata id="mure">\n    <mure xmlns="http://mure-apps.github.io">\n    </mure>\n  </metadata>\n</svg>\n';const defaultSvgDoc=eval("`"+defaultSvgDocTemplate+"`");class DocHandler{constructor(){this.selectorParser=dist_1(),this.keyNames={},this.json2xmlSettings=Object.assign({compact:!1,indentCdata:!0},this.keyNames),this.xml2jsonSettings=Object.assign({compact:!1,nativeType:!0,alwaysArray:!0,addParent:!0},this.keyNames),this.defaultJsonDoc=this.xml2json(defaultSvgDoc),this.minimumJsDoc=this.xml2js(minimumSvgDoc)}xml2js(e){return lib$5.xml2js(e,this.xml2jsonSettings)}xml2json(e){return lib$5.xml2json(e,this.xml2jsonSettings)}json2xml(e){return lib$5.json2xml(e,this.json2xmlSettings)}js2xml(e){return lib$5.js2xml(e,this.json2xmlSettings)}standardize(e,t){if(!t){if(!e._id)throw new Error("You must at least supply an id to standardize the document");e.currentSelection=e.currentSelection||null,e.contents=this.standardize(e.contents||{},this.minimumJsDoc)}return e}iterate(e,t){const r=[];r.push(e);do{t(e=r.shift()),e.elements&&r.unshift(...e.elements)}while(r.length>0)}matchObject(e,t){}selectAll(e,t){const r=this.selectorParser.parse(t),n=[];return this.iterate(e,e=>{this.matchObject(e,r)&&n.push(e)}),n}}var docH=new DocHandler;class Mure extends Model{constructor(){if(super(),this.appList=appList,"undefined"==typeof document||"undefined"==typeof window)return;this.CONTENT_FORMATS={exclude:0,blob:1,dom:2,base64:3},this.NSString="http://mure-apps.github.io",namespaces.mure=this.NSString;let e=document.getElementsByTagName("title")[0];e=e?e.textContent:"",this.debugMode="localhost"===window.location.hostname&&e.startsWith("Mure"),this.currentApp=window.location.pathname.replace(/\//g,""),this.appList[this.currentApp]||(this.currentApp=null),this.db=new PouchDB$5("mure"),this.on("error",e=>{console.warn(e)}),this.catchDbError=(e=>{this.trigger("error","Unexpected error reading PouchDB: "+e.message+"\n"+e.stack)}),this.alert=(e=>new Promise((t,r)=>{window.alert(e),t(!0)})),this.confirm=(e=>new Promise((t,r)=>{t(window.confirm(e))})),this.prompt=((e,t)=>new Promise((r,n)=>{r(window.prompt(e,t))}))}customizeAlertDialog(e){this.alert=e}customizeConfirmDialog(e){this.confirm=e}customizePromptDialog(e){this.prompt=e}openApp(e,t){t?window.open("/"+e,"_blank"):window.location.pathname="/"+e}getOrInitDb(){let e=new PouchDB$5("mure"),t=window.localStorage.getItem("couchDbUrl");return t&&(async()=>{let r=new PouchDB$5(t,{skip_setup:!0});return e.sync(r,{live:!0,retry:!0})})().catch(e=>{this.alert("Error syncing with "+t+": "+e.message)}),e}getStandardizedDoc(e){return this.db.get(e).catch(t=>{if("not_found"===t.name)return{_id:e,currentSelection:null,contents:JSON.parse(docH.defaultJsonDoc)};throw t}).then(e=>docH.standardize(e))}async downloadDoc(e){return this.db.get(e).then(e=>{let t=docH.js2xml(e.contents),r=document.createElement("a");r.style="display:none";let n=window.URL.createObjectURL(new window.Blob([t],{type:"image/svg+xml"}));r.href=n,r.download=e._id,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(n),r.parentNode.removeChild(r)})}}var mure=new Mure;export default mure;